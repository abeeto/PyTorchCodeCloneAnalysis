import base64
from zipfile import ZipFile
from tkinter import filedialog
import os

root = "./"
path_to_zip_file = filedialog.askopenfilename(title="Select Yolov4 Master .zip file", filetypes=[('Zip', '*.zip')])
filename = os.path.split(path_to_zip_file)[1]

with ZipFile(path_to_zip_file, 'r') as zip_ref:
    zip_ref.extractall(root)
os.rename(root + filename[:-4], root + "YOLOv4")

if os.path.exists(root + "YOLOv4" + "/requirements.txt"):
  os.remove(root + "YOLOv4" + "/requirements.txt")
else:
  print("The file does not exist")

if os.path.exists(root + "YOLOv4" + "/tool/darknet2pytorch.py"):
  os.remove(root + "YOLOv4" + "/tool/darknet2pytorch.py")
else:
  print("The file does not exist")

if os.path.exists(root + "YOLOv4" + "/tool/torch_utils.py"):
  os.remove(root + "YOLOv4" + "/tool/torch_utils.py")
else:
  print("The file does not exist")

if os.path.exists(root + "YOLOv4" + "/dataset.py"):
  os.remove(root + "YOLOv4" + "/dataset.py")
else:
  print("The file does not exist")

if os.path.exists(root + "YOLOv4" + "/models.py"):
  os.remove(root + "YOLOv4" + "/models.py")
else:
  print("The file does not exist")

if os.path.exists(root + "YOLOv4" + "/train.py"):
  os.remove(root + "YOLOv4" + "/train.py")
else:
  print("The file does not exist")

try:
    os.mkdir(root + "YOLOv4")
except OSError as error:
    print('Folder creation error or already exists ')

try:
    os.mkdir(root + "YOLOv4" + "/checkpoints")
except OSError as error:
    print('Folder creation error or already exists ')

with open(root + "YOLOv4" + "/train.py", "wb") as file:
    train_string = base64.b64decode(b'IyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KJycnCkBUaW1lICAgICAgICAgIDogMjAyMC8wNS8wNiAxNTowNwpAQXV0aG9yICAgICAgICA6IFRpYW54aWFvbW8KQEZpbGUgICAgICAgICAgOiB0cmFpbi5weQpATm9pY2UgICAgICAgICA6CkBNb2RpZmljYXR0aW9uIDoKICAgIEBBdXRob3IgICAgOgogICAgQFRpbWUgICAgICA6CiAgICBARGV0YWlsICAgIDoKCicnJwppbXBvcnQgdGltZQppbXBvcnQgbG9nZ2luZwppbXBvcnQgb3MsIHN5cywgbWF0aAppbXBvcnQgYXJncGFyc2UKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgZGVxdWUKaW1wb3J0IGRhdGV0aW1lCgppbXBvcnQgY3YyCmZyb20gdHFkbSBpbXBvcnQgdHFkbQppbXBvcnQgbnVtcHkgYXMgbnAKaW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgpmcm9tIHRvcmNoLnV0aWxzLmRhdGEgaW1wb3J0IERhdGFMb2FkZXIKZnJvbSB0b3JjaCBpbXBvcnQgb3B0aW0KZnJvbSB0b3JjaC5ubiBpbXBvcnQgZnVuY3Rpb25hbCBhcyBGCmZyb20gdGVuc29yYm9hcmRYIGltcG9ydCBTdW1tYXJ5V3JpdGVyCmZyb20gZWFzeWRpY3QgaW1wb3J0IEVhc3lEaWN0IGFzIGVkaWN0Cgpmcm9tIGRhdGFzZXQgaW1wb3J0IFlvbG9fZGF0YXNldApmcm9tIGNmZyBpbXBvcnQgQ2ZnCmZyb20gbW9kZWxzIGltcG9ydCBZb2xvdjQKZnJvbSB0b29sLmRhcmtuZXQycHl0b3JjaCBpbXBvcnQgRGFya25ldAoKZnJvbSB0b29sLnR2X3JlZmVyZW5jZS51dGlscyBpbXBvcnQgY29sbGF0ZV9mbiBhcyB2YWxfY29sbGF0ZQpmcm9tIHRvb2wudHZfcmVmZXJlbmNlLmNvY29fdXRpbHMgaW1wb3J0IGNvbnZlcnRfdG9fY29jb19hcGkKZnJvbSB0b29sLnR2X3JlZmVyZW5jZS5jb2NvX2V2YWwgaW1wb3J0IENvY29FdmFsdWF0b3IKCgpkZWYgYmJveGVzX2lvdShiYm94ZXNfYSwgYmJveGVzX2IsIHh5eHk9VHJ1ZSwgR0lvVT1GYWxzZSwgRElvVT1GYWxzZSwgQ0lvVT1GYWxzZSk6CiAgICAiIiJDYWxjdWxhdGUgdGhlIEludGVyc2VjdGlvbiBvZiBVbmlvbnMgKElvVXMpIGJldHdlZW4gYm91bmRpbmcgYm94ZXMuCiAgICBJb1UgaXMgY2FsY3VsYXRlZCBhcyBhIHJhdGlvIG9mIGFyZWEgb2YgdGhlIGludGVyc2VjdGlvbgogICAgYW5kIGFyZWEgb2YgdGhlIHVuaW9uLgoKICAgIEFyZ3M6CiAgICAgICAgYmJveF9hIChhcnJheSk6IEFuIGFycmF5IHdob3NlIHNoYXBlIGlzIDptYXRoOmAoTiwgNClgLgogICAgICAgICAgICA6bWF0aDpgTmAgaXMgdGhlIG51bWJlciBvZiBib3VuZGluZyBib3hlcy4KICAgICAgICAgICAgVGhlIGR0eXBlIHNob3VsZCBiZSA6b2JqOmBudW1weS5mbG9hdDMyYC4KICAgICAgICBiYm94X2IgKGFycmF5KTogQW4gYXJyYXkgc2ltaWxhciB0byA6b2JqOmBiYm94X2FgLAogICAgICAgICAgICB3aG9zZSBzaGFwZSBpcyA6bWF0aDpgKEssIDQpYC4KICAgICAgICAgICAgVGhlIGR0eXBlIHNob3VsZCBiZSA6b2JqOmBudW1weS5mbG9hdDMyYC4KICAgIFJldHVybnM6CiAgICAgICAgYXJyYXk6CiAgICAgICAgQW4gYXJyYXkgd2hvc2Ugc2hhcGUgaXMgOm1hdGg6YChOLCBLKWAuIFwKICAgICAgICBBbiBlbGVtZW50IGF0IGluZGV4IDptYXRoOmAobiwgaylgIGNvbnRhaW5zIElvVXMgYmV0d2VlbiBcCiAgICAgICAgOm1hdGg6YG5gIHRoIGJvdW5kaW5nIGJveCBpbiA6b2JqOmBiYm94X2FgIGFuZCA6bWF0aDpga2AgdGggYm91bmRpbmcgXAogICAgICAgIGJveCBpbiA6b2JqOmBiYm94X2JgLgoKICAgIGZyb206IGh0dHBzOi8vZ2l0aHViLmNvbS9jaGFpbmVyL2NoYWluZXJjdgogICAgaHR0cHM6Ly9naXRodWIuY29tL3VsdHJhbHl0aWNzL3lvbG92My9ibG9iL2VjYTViOWMxZDM2ZTRmNzNiZjJmOTRlMTQxZDg2NGYxYzI3MzllMjMvdXRpbHMvdXRpbHMucHkjTDI2Mi1MMjgyCiAgICAiIiIKICAgIGlmIGJib3hlc19hLnNoYXBlWzFdICE9IDQgb3IgYmJveGVzX2Iuc2hhcGVbMV0gIT0gNDoKICAgICAgICByYWlzZSBJbmRleEVycm9yCgogICAgaWYgeHl4eToKICAgICAgICAjIGludGVyc2VjdGlvbiB0b3AgbGVmdAogICAgICAgIHRsID0gdG9yY2gubWF4KGJib3hlc19hWzosIE5vbmUsIDoyXSwgYmJveGVzX2JbOiwgOjJdKQogICAgICAgICMgaW50ZXJzZWN0aW9uIGJvdHRvbSByaWdodAogICAgICAgIGJyID0gdG9yY2gubWluKGJib3hlc19hWzosIE5vbmUsIDI6XSwgYmJveGVzX2JbOiwgMjpdKQogICAgICAgICMgY29udmV4IChzbWFsbGVzdCBlbmNsb3NpbmcgYm94KSB0b3AgbGVmdCBhbmQgYm90dG9tIHJpZ2h0CiAgICAgICAgY29uX3RsID0gdG9yY2gubWluKGJib3hlc19hWzosIE5vbmUsIDoyXSwgYmJveGVzX2JbOiwgOjJdKQogICAgICAgIGNvbl9iciA9IHRvcmNoLm1heChiYm94ZXNfYVs6LCBOb25lLCAyOl0sIGJib3hlc19iWzosIDI6XSkKICAgICAgICAjIGNlbnRlcnBvaW50IGRpc3RhbmNlIHNxdWFyZWQKICAgICAgICByaG8yID0gKChiYm94ZXNfYVs6LCBOb25lLCAwXSArIGJib3hlc19hWzosIE5vbmUsIDJdKSAtIChiYm94ZXNfYls6LCAwXSArIGJib3hlc19iWzosIDJdKSkgKiogMiAvIDQgKyAoCiAgICAgICAgICAgICAgICAoYmJveGVzX2FbOiwgTm9uZSwgMV0gKyBiYm94ZXNfYVs6LCBOb25lLCAzXSkgLSAoYmJveGVzX2JbOiwgMV0gKyBiYm94ZXNfYls6LCAzXSkpICoqIDIgLyA0CgogICAgICAgIHcxID0gYmJveGVzX2FbOiwgMl0gLSBiYm94ZXNfYVs6LCAwXQogICAgICAgIGgxID0gYmJveGVzX2FbOiwgM10gLSBiYm94ZXNfYVs6LCAxXQogICAgICAgIHcyID0gYmJveGVzX2JbOiwgMl0gLSBiYm94ZXNfYls6LCAwXQogICAgICAgIGgyID0gYmJveGVzX2JbOiwgM10gLSBiYm94ZXNfYls6LCAxXQoKICAgICAgICBhcmVhX2EgPSB0b3JjaC5wcm9kKGJib3hlc19hWzosIDI6XSAtIGJib3hlc19hWzosIDoyXSwgMSkKICAgICAgICBhcmVhX2IgPSB0b3JjaC5wcm9kKGJib3hlc19iWzosIDI6XSAtIGJib3hlc19iWzosIDoyXSwgMSkKICAgIGVsc2U6CiAgICAgICAgIyBpbnRlcnNlY3Rpb24gdG9wIGxlZnQKICAgICAgICB0bCA9IHRvcmNoLm1heCgoYmJveGVzX2FbOiwgTm9uZSwgOjJdIC0gYmJveGVzX2FbOiwgTm9uZSwgMjpdIC8gMiksCiAgICAgICAgICAgICAgICAgICAgICAgKGJib3hlc19iWzosIDoyXSAtIGJib3hlc19iWzosIDI6XSAvIDIpKQogICAgICAgICMgaW50ZXJzZWN0aW9uIGJvdHRvbSByaWdodAogICAgICAgIGJyID0gdG9yY2gubWluKChiYm94ZXNfYVs6LCBOb25lLCA6Ml0gKyBiYm94ZXNfYVs6LCBOb25lLCAyOl0gLyAyKSwKICAgICAgICAgICAgICAgICAgICAgICAoYmJveGVzX2JbOiwgOjJdICsgYmJveGVzX2JbOiwgMjpdIC8gMikpCgogICAgICAgICMgY29udmV4IChzbWFsbGVzdCBlbmNsb3NpbmcgYm94KSB0b3AgbGVmdCBhbmQgYm90dG9tIHJpZ2h0CiAgICAgICAgY29uX3RsID0gdG9yY2gubWluKChiYm94ZXNfYVs6LCBOb25lLCA6Ml0gLSBiYm94ZXNfYVs6LCBOb25lLCAyOl0gLyAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgKGJib3hlc19iWzosIDoyXSAtIGJib3hlc19iWzosIDI6XSAvIDIpKQogICAgICAgIGNvbl9iciA9IHRvcmNoLm1heCgoYmJveGVzX2FbOiwgTm9uZSwgOjJdICsgYmJveGVzX2FbOiwgTm9uZSwgMjpdIC8gMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgIChiYm94ZXNfYls6LCA6Ml0gKyBiYm94ZXNfYls6LCAyOl0gLyAyKSkKICAgICAgICAjIGNlbnRlcnBvaW50IGRpc3RhbmNlIHNxdWFyZWQKICAgICAgICByaG8yID0gKChiYm94ZXNfYVs6LCBOb25lLCA6Ml0gLSBiYm94ZXNfYls6LCA6Ml0pICoqIDIgLyA0KS5zdW0oZGltPS0xKQoKICAgICAgICB3MSA9IGJib3hlc19hWzosIDJdCiAgICAgICAgaDEgPSBiYm94ZXNfYVs6LCAzXQogICAgICAgIHcyID0gYmJveGVzX2JbOiwgMl0KICAgICAgICBoMiA9IGJib3hlc19iWzosIDNdCgogICAgICAgIGFyZWFfYSA9IHRvcmNoLnByb2QoYmJveGVzX2FbOiwgMjpdLCAxKQogICAgICAgIGFyZWFfYiA9IHRvcmNoLnByb2QoYmJveGVzX2JbOiwgMjpdLCAxKQogICAgZW4gPSAodGwgPCBicikudHlwZSh0bC50eXBlKCkpLnByb2QoZGltPTIpCiAgICBhcmVhX2kgPSB0b3JjaC5wcm9kKGJyIC0gdGwsIDIpICogZW4gICMgKiAoKHRsIDwgYnIpLmFsbCgpKQogICAgYXJlYV91ID0gYXJlYV9hWzosIE5vbmVdICsgYXJlYV9iIC0gYXJlYV9pCiAgICBpb3UgPSBhcmVhX2kgLyBhcmVhX3UKCiAgICBpZiBHSW9VIG9yIERJb1Ugb3IgQ0lvVToKICAgICAgICBpZiBHSW9VOiAgIyBHZW5lcmFsaXplZCBJb1UgaHR0cHM6Ly9hcnhpdi5vcmcvcGRmLzE5MDIuMDk2MzAucGRmCiAgICAgICAgICAgIGFyZWFfYyA9IHRvcmNoLnByb2QoY29uX2JyIC0gY29uX3RsLCAyKSAgIyBjb252ZXggYXJlYQogICAgICAgICAgICByZXR1cm4gaW91IC0gKGFyZWFfYyAtIGFyZWFfdSkgLyBhcmVhX2MgICMgR0lvVQogICAgICAgIGlmIERJb1Ugb3IgQ0lvVTogICMgRGlzdGFuY2Ugb3IgQ29tcGxldGUgSW9VIGh0dHBzOi8vYXJ4aXYub3JnL2Ficy8xOTExLjA4Mjg3djEKICAgICAgICAgICAgIyBjb252ZXggZGlhZ29uYWwgc3F1YXJlZAogICAgICAgICAgICBjMiA9IHRvcmNoLnBvdyhjb25fYnIgLSBjb25fdGwsIDIpLnN1bShkaW09MikgKyAxZS0xNgogICAgICAgICAgICBpZiBESW9VOgogICAgICAgICAgICAgICAgcmV0dXJuIGlvdSAtIHJobzIgLyBjMiAgIyBESW9VCiAgICAgICAgICAgIGVsaWYgQ0lvVTogICMgaHR0cHM6Ly9naXRodWIuY29tL1p6aC10anUvRElvVS1TU0QtcHl0b3JjaC9ibG9iL21hc3Rlci91dGlscy9ib3gvYm94X3V0aWxzLnB5I0w0NwogICAgICAgICAgICAgICAgdiA9ICg0IC8gbWF0aC5waSAqKiAyKSAqIHRvcmNoLnBvdyh0b3JjaC5hdGFuKHcxIC8gaDEpLnVuc3F1ZWV6ZSgxKSAtIHRvcmNoLmF0YW4odzIgLyBoMiksIDIpCiAgICAgICAgICAgICAgICB3aXRoIHRvcmNoLm5vX2dyYWQoKToKICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IHYgLyAoMSAtIGlvdSArIHYpCiAgICAgICAgICAgICAgICByZXR1cm4gaW91IC0gKHJobzIgLyBjMiArIHYgKiBhbHBoYSkgICMgQ0lvVQogICAgcmV0dXJuIGlvdQoKCmNsYXNzIFlvbG9fbG9zcyhubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5fY2xhc3Nlcz04MCwgbl9hbmNob3JzPTMsIGRldmljZT1Ob25lLCBiYXRjaD0yKToKICAgICAgICBzdXBlcihZb2xvX2xvc3MsIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmRldmljZSA9IGRldmljZQogICAgICAgIHNlbGYuc3RyaWRlcyA9IFs4LCAxNiwgMzJdCiAgICAgICAgaW1hZ2Vfc2l6ZSA9IDYwOAogICAgICAgIHNlbGYubl9jbGFzc2VzID0gbl9jbGFzc2VzCiAgICAgICAgc2VsZi5uX2FuY2hvcnMgPSBuX2FuY2hvcnMKCiAgICAgICAgc2VsZi5hbmNob3JzID0gW1sxMiwgMTZdLCBbMTksIDM2XSwgWzQwLCAyOF0sIFszNiwgNzVdLCBbNzYsIDU1XSwgWzcyLCAxNDZdLCBbMTQyLCAxMTBdLCBbMTkyLCAyNDNdLCBbNDU5LCA0MDFdXQogICAgICAgIHNlbGYuYW5jaF9tYXNrcyA9IFtbMCwgMSwgMl0sIFszLCA0LCA1XSwgWzYsIDcsIDhdXQogICAgICAgIHNlbGYuaWdub3JlX3RocmUgPSAwLjUKCiAgICAgICAgc2VsZi5tYXNrZWRfYW5jaG9ycywgc2VsZi5yZWZfYW5jaG9ycywgc2VsZi5ncmlkX3gsIHNlbGYuZ3JpZF95LCBzZWxmLmFuY2hvcl93LCBzZWxmLmFuY2hvcl9oID0gW10sIFtdLCBbXSwgW10sIFtdLCBbXQoKICAgICAgICBmb3IgaSBpbiByYW5nZSgzKToKICAgICAgICAgICAgYWxsX2FuY2hvcnNfZ3JpZCA9IFsodyAvIHNlbGYuc3RyaWRlc1tpXSwgaCAvIHNlbGYuc3RyaWRlc1tpXSkgZm9yIHcsIGggaW4gc2VsZi5hbmNob3JzXQogICAgICAgICAgICBtYXNrZWRfYW5jaG9ycyA9IG5wLmFycmF5KFthbGxfYW5jaG9yc19ncmlkW2pdIGZvciBqIGluIHNlbGYuYW5jaF9tYXNrc1tpXV0sIGR0eXBlPW5wLmZsb2F0MzIpCiAgICAgICAgICAgIHJlZl9hbmNob3JzID0gbnAuemVyb3MoKGxlbihhbGxfYW5jaG9yc19ncmlkKSwgNCksIGR0eXBlPW5wLmZsb2F0MzIpCiAgICAgICAgICAgIHJlZl9hbmNob3JzWzosIDI6XSA9IG5wLmFycmF5KGFsbF9hbmNob3JzX2dyaWQsIGR0eXBlPW5wLmZsb2F0MzIpCiAgICAgICAgICAgIHJlZl9hbmNob3JzID0gdG9yY2guZnJvbV9udW1weShyZWZfYW5jaG9ycykKICAgICAgICAgICAgIyBjYWxjdWxhdGUgcHJlZCAtIHh5d2ggb2JqIGNscwogICAgICAgICAgICBmc2l6ZSA9IGltYWdlX3NpemUgLy8gc2VsZi5zdHJpZGVzW2ldCiAgICAgICAgICAgIGdyaWRfeCA9IHRvcmNoLmFyYW5nZShmc2l6ZSwgZHR5cGU9dG9yY2guZmxvYXQpLnJlcGVhdChiYXRjaCwgMywgZnNpemUsIDEpLnRvKGRldmljZSkKICAgICAgICAgICAgZ3JpZF95ID0gdG9yY2guYXJhbmdlKGZzaXplLCBkdHlwZT10b3JjaC5mbG9hdCkucmVwZWF0KGJhdGNoLCAzLCBmc2l6ZSwgMSkucGVybXV0ZSgwLCAxLCAzLCAyKS50byhkZXZpY2UpCiAgICAgICAgICAgIGFuY2hvcl93ID0gdG9yY2guZnJvbV9udW1weShtYXNrZWRfYW5jaG9yc1s6LCAwXSkucmVwZWF0KGJhdGNoLCBmc2l6ZSwgZnNpemUsIDEpLnBlcm11dGUoMCwgMywgMSwgMikudG8oCiAgICAgICAgICAgICAgICBkZXZpY2UpCiAgICAgICAgICAgIGFuY2hvcl9oID0gdG9yY2guZnJvbV9udW1weShtYXNrZWRfYW5jaG9yc1s6LCAxXSkucmVwZWF0KGJhdGNoLCBmc2l6ZSwgZnNpemUsIDEpLnBlcm11dGUoMCwgMywgMSwgMikudG8oCiAgICAgICAgICAgICAgICBkZXZpY2UpCgogICAgICAgICAgICBzZWxmLm1hc2tlZF9hbmNob3JzLmFwcGVuZChtYXNrZWRfYW5jaG9ycykKICAgICAgICAgICAgc2VsZi5yZWZfYW5jaG9ycy5hcHBlbmQocmVmX2FuY2hvcnMpCiAgICAgICAgICAgIHNlbGYuZ3JpZF94LmFwcGVuZChncmlkX3gpCiAgICAgICAgICAgIHNlbGYuZ3JpZF95LmFwcGVuZChncmlkX3kpCiAgICAgICAgICAgIHNlbGYuYW5jaG9yX3cuYXBwZW5kKGFuY2hvcl93KQogICAgICAgICAgICBzZWxmLmFuY2hvcl9oLmFwcGVuZChhbmNob3JfaCkKCiAgICBkZWYgYnVpbGRfdGFyZ2V0KHNlbGYsIHByZWQsIGxhYmVscywgYmF0Y2hzaXplLCBmc2l6ZSwgbl9jaCwgb3V0cHV0X2lkKToKICAgICAgICAjIHRhcmdldCBhc3NpZ25tZW50CiAgICAgICAgdGd0X21hc2sgPSB0b3JjaC56ZXJvcyhiYXRjaHNpemUsIHNlbGYubl9hbmNob3JzLCBmc2l6ZSwgZnNpemUsIDQgKyBzZWxmLm5fY2xhc3NlcykudG8oZGV2aWNlPXNlbGYuZGV2aWNlKQogICAgICAgIG9ial9tYXNrID0gdG9yY2gub25lcyhiYXRjaHNpemUsIHNlbGYubl9hbmNob3JzLCBmc2l6ZSwgZnNpemUpLnRvKGRldmljZT1zZWxmLmRldmljZSkKICAgICAgICB0Z3Rfc2NhbGUgPSB0b3JjaC56ZXJvcyhiYXRjaHNpemUsIHNlbGYubl9hbmNob3JzLCBmc2l6ZSwgZnNpemUsIDIpLnRvKHNlbGYuZGV2aWNlKQogICAgICAgIHRhcmdldCA9IHRvcmNoLnplcm9zKGJhdGNoc2l6ZSwgc2VsZi5uX2FuY2hvcnMsIGZzaXplLCBmc2l6ZSwgbl9jaCkudG8oc2VsZi5kZXZpY2UpCgogICAgICAgICMgbGFiZWxzID0gbGFiZWxzLmNwdSgpLmRhdGEKICAgICAgICBubGFiZWwgPSAobGFiZWxzLnN1bShkaW09MikgPiAwKS5zdW0oZGltPTEpICAjIG51bWJlciBvZiBvYmplY3RzCgogICAgICAgIHRydXRoX3hfYWxsID0gKGxhYmVsc1s6LCA6LCAyXSArIGxhYmVsc1s6LCA6LCAwXSkgLyAoc2VsZi5zdHJpZGVzW291dHB1dF9pZF0gKiAyKQogICAgICAgIHRydXRoX3lfYWxsID0gKGxhYmVsc1s6LCA6LCAzXSArIGxhYmVsc1s6LCA6LCAxXSkgLyAoc2VsZi5zdHJpZGVzW291dHB1dF9pZF0gKiAyKQogICAgICAgIHRydXRoX3dfYWxsID0gKGxhYmVsc1s6LCA6LCAyXSAtIGxhYmVsc1s6LCA6LCAwXSkgLyBzZWxmLnN0cmlkZXNbb3V0cHV0X2lkXQogICAgICAgIHRydXRoX2hfYWxsID0gKGxhYmVsc1s6LCA6LCAzXSAtIGxhYmVsc1s6LCA6LCAxXSkgLyBzZWxmLnN0cmlkZXNbb3V0cHV0X2lkXQogICAgICAgIHRydXRoX2lfYWxsID0gdHJ1dGhfeF9hbGwudG8odG9yY2guaW50MTYpLmNwdSgpLm51bXB5KCkKICAgICAgICB0cnV0aF9qX2FsbCA9IHRydXRoX3lfYWxsLnRvKHRvcmNoLmludDE2KS5jcHUoKS5udW1weSgpCgogICAgICAgIGZvciBiIGluIHJhbmdlKGJhdGNoc2l6ZSk6CiAgICAgICAgICAgIG4gPSBpbnQobmxhYmVsW2JdKQogICAgICAgICAgICBpZiBuID09IDA6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICB0cnV0aF9ib3ggPSB0b3JjaC56ZXJvcyhuLCA0KS50byhzZWxmLmRldmljZSkKICAgICAgICAgICAgdHJ1dGhfYm94WzpuLCAyXSA9IHRydXRoX3dfYWxsW2IsIDpuXQogICAgICAgICAgICB0cnV0aF9ib3hbOm4sIDNdID0gdHJ1dGhfaF9hbGxbYiwgOm5dCiAgICAgICAgICAgIHRydXRoX2kgPSB0cnV0aF9pX2FsbFtiLCA6bl0KICAgICAgICAgICAgdHJ1dGhfaiA9IHRydXRoX2pfYWxsW2IsIDpuXQoKICAgICAgICAgICAgIyBjYWxjdWxhdGUgaW91IGJldHdlZW4gdHJ1dGggYW5kIHJlZmVyZW5jZSBhbmNob3JzCiAgICAgICAgICAgIGFuY2hvcl9pb3VzX2FsbCA9IGJib3hlc19pb3UodHJ1dGhfYm94LmNwdSgpLCBzZWxmLnJlZl9hbmNob3JzW291dHB1dF9pZF0sIENJb1U9VHJ1ZSkKCiAgICAgICAgICAgICMgdGVtcCA9IGJib3hfaW91KHRydXRoX2JveC5jcHUoKSwgc2VsZi5yZWZfYW5jaG9yc1tvdXRwdXRfaWRdKQoKICAgICAgICAgICAgYmVzdF9uX2FsbCA9IGFuY2hvcl9pb3VzX2FsbC5hcmdtYXgoZGltPTEpCiAgICAgICAgICAgIGJlc3RfbiA9IGJlc3Rfbl9hbGwgJSAzCiAgICAgICAgICAgIGJlc3Rfbl9tYXNrID0gKChiZXN0X25fYWxsID09IHNlbGYuYW5jaF9tYXNrc1tvdXRwdXRfaWRdWzBdKSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgIChiZXN0X25fYWxsID09IHNlbGYuYW5jaF9tYXNrc1tvdXRwdXRfaWRdWzFdKSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgIChiZXN0X25fYWxsID09IHNlbGYuYW5jaF9tYXNrc1tvdXRwdXRfaWRdWzJdKSkKCiAgICAgICAgICAgIGlmIHN1bShiZXN0X25fbWFzaykgPT0gMDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICB0cnV0aF9ib3hbOm4sIDBdID0gdHJ1dGhfeF9hbGxbYiwgOm5dCiAgICAgICAgICAgIHRydXRoX2JveFs6biwgMV0gPSB0cnV0aF95X2FsbFtiLCA6bl0KICAgICAgICAgICAgI3ByZWRfaW91cyA9IGJib3hlc19pb3UocHJlZFtiXS52aWV3KC0xLCA0KSwgdHJ1dGhfYm94LCB4eXh5PUZhbHNlKSBvcmlnaW5hbAogICAgICAgICAgICAjcHJlZF9pb3VzID0gYmJveGVzX2lvdShwcmVkW2JdLmNvbnRpZ3VvdXMoKS52aWV3KC0xLCA0KSwgdHJ1dGhfYm94LCB4eXh5PUZhbHNlKSBhbHRlcm5hdGl2ZQogICAgICAgICAgICBwcmVkX2lvdXMgPSBiYm94ZXNfaW91KHByZWRbYl0ucmVzaGFwZSgtMSwgNCksIHRydXRoX2JveCwgeHl4eT1GYWxzZSkKICAgICAgICAgICAgcHJlZF9iZXN0X2lvdSwgXyA9IHByZWRfaW91cy5tYXgoZGltPTEpCiAgICAgICAgICAgIHByZWRfYmVzdF9pb3UgPSAocHJlZF9iZXN0X2lvdSA+IHNlbGYuaWdub3JlX3RocmUpCiAgICAgICAgICAgIHByZWRfYmVzdF9pb3UgPSBwcmVkX2Jlc3RfaW91LnZpZXcocHJlZFtiXS5zaGFwZVs6M10pCiAgICAgICAgICAgICMgc2V0IG1hc2sgdG8gemVybyAoaWdub3JlKSBpZiBwcmVkIG1hdGNoZXMgdHJ1dGgKICAgICAgICAgICAgb2JqX21hc2tbYl0gPSB+IHByZWRfYmVzdF9pb3UKCiAgICAgICAgICAgIGZvciB0aSBpbiByYW5nZShiZXN0X24uc2hhcGVbMF0pOgogICAgICAgICAgICAgICAgaWYgYmVzdF9uX21hc2tbdGldID09IDE6CiAgICAgICAgICAgICAgICAgICAgaSwgaiA9IHRydXRoX2lbdGldLCB0cnV0aF9qW3RpXQogICAgICAgICAgICAgICAgICAgIGEgPSBiZXN0X25bdGldCiAgICAgICAgICAgICAgICAgICAgb2JqX21hc2tbYiwgYSwgaiwgaV0gPSAxCiAgICAgICAgICAgICAgICAgICAgdGd0X21hc2tbYiwgYSwgaiwgaSwgOl0gPSAxCiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0W2IsIGEsIGosIGksIDBdID0gdHJ1dGhfeF9hbGxbYiwgdGldIC0gdHJ1dGhfeF9hbGxbYiwgdGldLnRvKHRvcmNoLmludDE2KS50byh0b3JjaC5mbG9hdCkKICAgICAgICAgICAgICAgICAgICB0YXJnZXRbYiwgYSwgaiwgaSwgMV0gPSB0cnV0aF95X2FsbFtiLCB0aV0gLSB0cnV0aF95X2FsbFtiLCB0aV0udG8odG9yY2guaW50MTYpLnRvKHRvcmNoLmZsb2F0KQogICAgICAgICAgICAgICAgICAgIHRhcmdldFtiLCBhLCBqLCBpLCAyXSA9IHRvcmNoLmxvZygKICAgICAgICAgICAgICAgICAgICAgICAgdHJ1dGhfd19hbGxbYiwgdGldIC8gdG9yY2guVGVuc29yKHNlbGYubWFza2VkX2FuY2hvcnNbb3V0cHV0X2lkXSlbYmVzdF9uW3RpXSwgMF0gKyAxZS0xNikKICAgICAgICAgICAgICAgICAgICB0YXJnZXRbYiwgYSwgaiwgaSwgM10gPSB0b3JjaC5sb2coCiAgICAgICAgICAgICAgICAgICAgICAgIHRydXRoX2hfYWxsW2IsIHRpXSAvIHRvcmNoLlRlbnNvcihzZWxmLm1hc2tlZF9hbmNob3JzW291dHB1dF9pZF0pW2Jlc3Rfblt0aV0sIDFdICsgMWUtMTYpCiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0W2IsIGEsIGosIGksIDRdID0gMQogICAgICAgICAgICAgICAgICAgIHRhcmdldFtiLCBhLCBqLCBpLCA1ICsgbGFiZWxzW2IsIHRpLCA0XS50byh0b3JjaC5pbnQxNikuY3B1KCkubnVtcHkoKV0gPSAxCiAgICAgICAgICAgICAgICAgICAgdGd0X3NjYWxlW2IsIGEsIGosIGksIDpdID0gdG9yY2guc3FydCgyIC0gdHJ1dGhfd19hbGxbYiwgdGldICogdHJ1dGhfaF9hbGxbYiwgdGldIC8gZnNpemUgLyBmc2l6ZSkKICAgICAgICByZXR1cm4gb2JqX21hc2ssIHRndF9tYXNrLCB0Z3Rfc2NhbGUsIHRhcmdldAoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHhpbiwgbGFiZWxzPU5vbmUpOgogICAgICAgIGxvc3MsIGxvc3NfeHksIGxvc3Nfd2gsIGxvc3Nfb2JqLCBsb3NzX2NscywgbG9zc19sMiA9IDAsIDAsIDAsIDAsIDAsIDAKICAgICAgICBmb3Igb3V0cHV0X2lkLCBvdXRwdXQgaW4gZW51bWVyYXRlKHhpbik6CiAgICAgICAgICAgIGJhdGNoc2l6ZSA9IG91dHB1dC5zaGFwZVswXQogICAgICAgICAgICBmc2l6ZSA9IG91dHB1dC5zaGFwZVsyXQogICAgICAgICAgICBuX2NoID0gNSArIHNlbGYubl9jbGFzc2VzCgogICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQudmlldyhiYXRjaHNpemUsIHNlbGYubl9hbmNob3JzLCBuX2NoLCBmc2l6ZSwgZnNpemUpCiAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5wZXJtdXRlKDAsIDEsIDMsIDQsIDIpICAjIC5jb250aWd1b3VzKCkKCiAgICAgICAgICAgICMgbG9naXN0aWMgYWN0aXZhdGlvbiBmb3IgeHksIG9iaiwgY2xzCiAgICAgICAgICAgIG91dHB1dFsuLi4sIG5wLnJfWzoyLCA0Om5fY2hdXSA9IHRvcmNoLnNpZ21vaWQob3V0cHV0Wy4uLiwgbnAucl9bOjIsIDQ6bl9jaF1dKQoKICAgICAgICAgICAgcHJlZCA9IG91dHB1dFsuLi4sIDo0XS5jbG9uZSgpCiAgICAgICAgICAgIHByZWRbLi4uLCAwXSArPSBzZWxmLmdyaWRfeFtvdXRwdXRfaWRdCiAgICAgICAgICAgIHByZWRbLi4uLCAxXSArPSBzZWxmLmdyaWRfeVtvdXRwdXRfaWRdCiAgICAgICAgICAgIHByZWRbLi4uLCAyXSA9IHRvcmNoLmV4cChwcmVkWy4uLiwgMl0pICogc2VsZi5hbmNob3Jfd1tvdXRwdXRfaWRdCiAgICAgICAgICAgIHByZWRbLi4uLCAzXSA9IHRvcmNoLmV4cChwcmVkWy4uLiwgM10pICogc2VsZi5hbmNob3JfaFtvdXRwdXRfaWRdCgogICAgICAgICAgICBvYmpfbWFzaywgdGd0X21hc2ssIHRndF9zY2FsZSwgdGFyZ2V0ID0gc2VsZi5idWlsZF90YXJnZXQocHJlZCwgbGFiZWxzLCBiYXRjaHNpemUsIGZzaXplLCBuX2NoLCBvdXRwdXRfaWQpCgogICAgICAgICAgICAjIGxvc3MgY2FsY3VsYXRpb24KICAgICAgICAgICAgb3V0cHV0Wy4uLiwgNF0gKj0gb2JqX21hc2sKICAgICAgICAgICAgb3V0cHV0Wy4uLiwgbnAucl9bMDo0LCA1Om5fY2hdXSAqPSB0Z3RfbWFzawogICAgICAgICAgICBvdXRwdXRbLi4uLCAyOjRdICo9IHRndF9zY2FsZQoKICAgICAgICAgICAgdGFyZ2V0Wy4uLiwgNF0gKj0gb2JqX21hc2sKICAgICAgICAgICAgdGFyZ2V0Wy4uLiwgbnAucl9bMDo0LCA1Om5fY2hdXSAqPSB0Z3RfbWFzawogICAgICAgICAgICB0YXJnZXRbLi4uLCAyOjRdICo9IHRndF9zY2FsZQoKICAgICAgICAgICAgbG9zc194eSArPSBGLmJpbmFyeV9jcm9zc19lbnRyb3B5KGlucHV0PW91dHB1dFsuLi4sIDoyXSwgdGFyZ2V0PXRhcmdldFsuLi4sIDoyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdlaWdodD10Z3Rfc2NhbGUgKiB0Z3Rfc2NhbGUsIHJlZHVjdGlvbj0nc3VtJykKICAgICAgICAgICAgbG9zc193aCArPSBGLm1zZV9sb3NzKGlucHV0PW91dHB1dFsuLi4sIDI6NF0sIHRhcmdldD10YXJnZXRbLi4uLCAyOjRdLCByZWR1Y3Rpb249J3N1bScpIC8gMgogICAgICAgICAgICBsb3NzX29iaiArPSBGLmJpbmFyeV9jcm9zc19lbnRyb3B5KGlucHV0PW91dHB1dFsuLi4sIDRdLCB0YXJnZXQ9dGFyZ2V0Wy4uLiwgNF0sIHJlZHVjdGlvbj0nc3VtJykKICAgICAgICAgICAgbG9zc19jbHMgKz0gRi5iaW5hcnlfY3Jvc3NfZW50cm9weShpbnB1dD1vdXRwdXRbLi4uLCA1Ol0sIHRhcmdldD10YXJnZXRbLi4uLCA1Ol0sIHJlZHVjdGlvbj0nc3VtJykKICAgICAgICAgICAgbG9zc19sMiArPSBGLm1zZV9sb3NzKGlucHV0PW91dHB1dCwgdGFyZ2V0PXRhcmdldCwgcmVkdWN0aW9uPSdzdW0nKQoKICAgICAgICBsb3NzID0gbG9zc194eSArIGxvc3Nfd2ggKyBsb3NzX29iaiArIGxvc3NfY2xzCgogICAgICAgIHJldHVybiBsb3NzLCBsb3NzX3h5LCBsb3NzX3doLCBsb3NzX29iaiwgbG9zc19jbHMsIGxvc3NfbDIKCgpkZWYgY29sbGF0ZShiYXRjaCk6CiAgICBpbWFnZXMgPSBbXQogICAgYmJveGVzID0gW10KICAgIGZvciBpbWcsIGJveCBpbiBiYXRjaDoKICAgICAgICBpbWFnZXMuYXBwZW5kKFtpbWddKQogICAgICAgIGJib3hlcy5hcHBlbmQoW2JveF0pCiAgICBpbWFnZXMgPSBucC5jb25jYXRlbmF0ZShpbWFnZXMsIGF4aXM9MCkKICAgIGltYWdlcyA9IGltYWdlcy50cmFuc3Bvc2UoMCwgMywgMSwgMikKICAgIGltYWdlcyA9IHRvcmNoLmZyb21fbnVtcHkoaW1hZ2VzKS5kaXYoMjU1LjApCiAgICBiYm94ZXMgPSBucC5jb25jYXRlbmF0ZShiYm94ZXMsIGF4aXM9MCkKICAgIGJib3hlcyA9IHRvcmNoLmZyb21fbnVtcHkoYmJveGVzKQogICAgcmV0dXJuIGltYWdlcywgYmJveGVzCgoKZGVmIHRyYWluKG1vZGVsLCBkZXZpY2UsIGNvbmZpZywgZXBvY2hzPTUsIGJhdGNoX3NpemU9MSwgc2F2ZV9jcD1UcnVlLCBsb2dfc3RlcD0yMCwgaW1nX3NjYWxlPTAuNSk6CiAgICB0cmFpbl9kYXRhc2V0ID0gWW9sb19kYXRhc2V0KGNvbmZpZy50cmFpbl9sYWJlbCwgY29uZmlnLCB0cmFpbj1UcnVlKQogICAgdmFsX2RhdGFzZXQgPSBZb2xvX2RhdGFzZXQoY29uZmlnLnZhbF9sYWJlbCwgY29uZmlnLCB0cmFpbj1GYWxzZSkKCiAgICBuX3RyYWluID0gbGVuKHRyYWluX2RhdGFzZXQpCiAgICBuX3ZhbCA9IGxlbih2YWxfZGF0YXNldCkKCiAgICB0cmFpbl9sb2FkZXIgPSBEYXRhTG9hZGVyKHRyYWluX2RhdGFzZXQsIGJhdGNoX3NpemU9Y29uZmlnLmJhdGNoIC8vIGNvbmZpZy5zdWJkaXZpc2lvbnMsIHNodWZmbGU9VHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtX3dvcmtlcnM9OCwgcGluX21lbW9yeT1UcnVlLCBkcm9wX2xhc3Q9VHJ1ZSwgY29sbGF0ZV9mbj1jb2xsYXRlKQoKICAgIHZhbF9sb2FkZXIgPSBEYXRhTG9hZGVyKHZhbF9kYXRhc2V0LCBiYXRjaF9zaXplPWNvbmZpZy5iYXRjaCAvLyBjb25maWcuc3ViZGl2aXNpb25zLCBzaHVmZmxlPVRydWUsIG51bV93b3JrZXJzPTgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaW5fbWVtb3J5PVRydWUsIGRyb3BfbGFzdD1UcnVlLCBjb2xsYXRlX2ZuPXZhbF9jb2xsYXRlKQoKICAgIHdyaXRlciA9IFN1bW1hcnlXcml0ZXIobG9nX2Rpcj1jb25maWcuVFJBSU5fVEVOU09SQk9BUkRfRElSLAogICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZV9zdWZmaXg9ZidPUFRfe2NvbmZpZy5UUkFJTl9PUFRJTUlaRVJ9X0xSX3tjb25maWcubGVhcm5pbmdfcmF0ZX1fQlNfe2NvbmZpZy5iYXRjaH1fU3ViX3tjb25maWcuc3ViZGl2aXNpb25zfV9TaXplX3tjb25maWcud2lkdGh9JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudD1mJ09QVF97Y29uZmlnLlRSQUlOX09QVElNSVpFUn1fTFJfe2NvbmZpZy5sZWFybmluZ19yYXRlfV9CU197Y29uZmlnLmJhdGNofV9TdWJfe2NvbmZpZy5zdWJkaXZpc2lvbnN9X1NpemVfe2NvbmZpZy53aWR0aH0nKQogICAgIyB3cml0ZXIuYWRkX2ltYWdlcygnbGVnZW5kJywKICAgICMgICAgICAgICAgICAgICAgICAgdG9yY2guZnJvbV9udW1weSh0cmFpbl9kYXRhc2V0LmxhYmVsMmNvbG9ybGVnZW5kMihjZmcuREFUQV9DTEFTU0VTKS50cmFuc3Bvc2UoWzIsIDAsIDFdKSkudG8oCiAgICAjICAgICAgICAgICAgICAgICAgICAgICBkZXZpY2UpLnVuc3F1ZWV6ZSgwKSkKICAgIG1heF9pdHIgPSBjb25maWcuVFJBSU5fRVBPQ0hTICogbl90cmFpbgogICAgIyBnbG9iYWxfc3RlcCA9IGNmZy5UUkFJTl9NSU5FUE9DSCAqIG5fdHJhaW4KICAgIGdsb2JhbF9zdGVwID0gMAogICAgbG9nZ2luZy5pbmZvKGYnJydTdGFydGluZyB0cmFpbmluZzoKICAgICAgICBFcG9jaHM6ICAgICAgICAgIHtlcG9jaHN9CiAgICAgICAgQmF0Y2ggc2l6ZTogICAgICB7Y29uZmlnLmJhdGNofQogICAgICAgIFN1YmRpdmlzaW9uczogICAge2NvbmZpZy5zdWJkaXZpc2lvbnN9CiAgICAgICAgTGVhcm5pbmcgcmF0ZTogICB7Y29uZmlnLmxlYXJuaW5nX3JhdGV9CiAgICAgICAgVHJhaW5pbmcgc2l6ZTogICB7bl90cmFpbn0KICAgICAgICBWYWxpZGF0aW9uIHNpemU6IHtuX3ZhbH0KICAgICAgICBDaGVja3BvaW50czogICAgIHtzYXZlX2NwfQogICAgICAgIERldmljZTogICAgICAgICAge2RldmljZS50eXBlfQogICAgICAgIEltYWdlcyBzaXplOiAgICAge2NvbmZpZy53aWR0aH0KICAgICAgICBPcHRpbWl6ZXI6ICAgICAgIHtjb25maWcuVFJBSU5fT1BUSU1JWkVSfQogICAgICAgIERhdGFzZXQgY2xhc3Nlczoge2NvbmZpZy5jbGFzc2VzfQogICAgICAgIFRyYWluIGxhYmVsIHBhdGg6e2NvbmZpZy50cmFpbl9sYWJlbH0KICAgICAgICBQcmV0cmFpbmVkOgogICAgJycnKQoKICAgICMgbGVhcm5pbmcgcmF0ZSBzZXR1cAogICAgZGVmIGJ1cm5pbl9zY2hlZHVsZShpKToKICAgICAgICBpZiBpIDwgY29uZmlnLmJ1cm5faW46CiAgICAgICAgICAgIGZhY3RvciA9IHBvdyhpIC8gY29uZmlnLmJ1cm5faW4sIDQpCiAgICAgICAgZWxpZiBpIDwgY29uZmlnLnN0ZXBzWzBdOgogICAgICAgICAgICBmYWN0b3IgPSAxLjAKICAgICAgICBlbGlmIGkgPCBjb25maWcuc3RlcHNbMV06CiAgICAgICAgICAgIGZhY3RvciA9IDAuMQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGZhY3RvciA9IDAuMDEKICAgICAgICByZXR1cm4gZmFjdG9yCgogICAgaWYgY29uZmlnLlRSQUlOX09QVElNSVpFUi5sb3dlcigpID09ICdhZGFtJzoKICAgICAgICBvcHRpbWl6ZXIgPSBvcHRpbS5BZGFtKAogICAgICAgICAgICBtb2RlbC5wYXJhbWV0ZXJzKCksCiAgICAgICAgICAgIGxyPWNvbmZpZy5sZWFybmluZ19yYXRlIC8gY29uZmlnLmJhdGNoLAogICAgICAgICAgICBiZXRhcz0oMC45LCAwLjk5OSksCiAgICAgICAgICAgIGVwcz0xZS0wOCwKICAgICAgICApCiAgICBlbGlmIGNvbmZpZy5UUkFJTl9PUFRJTUlaRVIubG93ZXIoKSA9PSAnc2dkJzoKICAgICAgICBvcHRpbWl6ZXIgPSBvcHRpbS5TR0QoCiAgICAgICAgICAgIHBhcmFtcz1tb2RlbC5wYXJhbWV0ZXJzKCksCiAgICAgICAgICAgIGxyPWNvbmZpZy5sZWFybmluZ19yYXRlIC8gY29uZmlnLmJhdGNoLAogICAgICAgICAgICBtb21lbnR1bT1jb25maWcubW9tZW50dW0sCiAgICAgICAgICAgIHdlaWdodF9kZWNheT1jb25maWcuZGVjYXksCiAgICAgICAgKQogICAgI3RvZG8gZml4CiAgICBlbGlmIGNvbmZpZy5UUkFJTl9PUFRJTUlaRVIubG93ZXIoKSA9PSAnYWRhbXcnOgogICAgICAgIG9wdGltaXplciA9IG9wdGltLkFkYW1XKAogICAgICAgICAgICBtb2RlbC5wYXJhbWV0ZXJzKCksCiAgICAgICAgICAgIGxyPWNvbmZpZy5sZWFybmluZ19yYXRlIC8gY29uZmlnLmJhdGNoLAogICAgICAgICAgICBiZXRhcz0oMC45LCAwLjk5OSksCiAgICAgICAgICAgIGVwcz0xZS0wOCwKICAgICAgICApCiAgICBzY2hlZHVsZXIgPSBvcHRpbS5scl9zY2hlZHVsZXIuTGFtYmRhTFIob3B0aW1pemVyLCBidXJuaW5fc2NoZWR1bGUpCgogICAgY3JpdGVyaW9uID0gWW9sb19sb3NzKGRldmljZT1kZXZpY2UsIGJhdGNoPWNvbmZpZy5iYXRjaCAvLyBjb25maWcuc3ViZGl2aXNpb25zLCBuX2NsYXNzZXM9Y29uZmlnLmNsYXNzZXMpCiAgICAjIHNjaGVkdWxlciA9IFJlZHVjZUxST25QbGF0ZWF1KG9wdGltaXplciwgbW9kZT0nbWF4JywgdmVyYm9zZT1UcnVlLCBwYXRpZW5jZT02LCBtaW5fbHI9MWUtNykKICAgICMgc2NoZWR1bGVyID0gQ29zaW5lQW5uZWFsaW5nV2FybVJlc3RhcnRzKG9wdGltaXplciwgMC4wMDEsIDFlLTYsIDIwKQoKICAgIHNhdmVfcHJlZml4ID0gJ1lvbG92NF9lcG9jaCcKICAgIHNhdmVkX21vZGVscyA9IGRlcXVlKCkKICAgIG1vZGVsLnRyYWluKCkKICAgIGZvciBlcG9jaCBpbiByYW5nZShlcG9jaHMpOgogICAgICAgICMgbW9kZWwudHJhaW4oKQogICAgICAgIGVwb2NoX2xvc3MgPSAwCiAgICAgICAgZXBvY2hfc3RlcCA9IDAKCiAgICAgICAgd2l0aCB0cWRtKHRvdGFsPW5fdHJhaW4sIGRlc2M9ZidFcG9jaCB7ZXBvY2ggKyAxfS97ZXBvY2hzfScsIHVuaXQ9J2ltZycsIG5jb2xzPTUwKSBhcyBwYmFyOgogICAgICAgICAgICBmb3IgaSwgYmF0Y2ggaW4gZW51bWVyYXRlKHRyYWluX2xvYWRlcik6CiAgICAgICAgICAgICAgICBnbG9iYWxfc3RlcCArPSAxCiAgICAgICAgICAgICAgICBlcG9jaF9zdGVwICs9IDEKICAgICAgICAgICAgICAgIGltYWdlcyA9IGJhdGNoWzBdCiAgICAgICAgICAgICAgICBiYm94ZXMgPSBiYXRjaFsxXQoKICAgICAgICAgICAgICAgIGltYWdlcyA9IGltYWdlcy50byhkZXZpY2U9ZGV2aWNlLCBkdHlwZT10b3JjaC5mbG9hdDMyKQogICAgICAgICAgICAgICAgYmJveGVzID0gYmJveGVzLnRvKGRldmljZT1kZXZpY2UpCgogICAgICAgICAgICAgICAgYmJveGVzX3ByZWQgPSBtb2RlbChpbWFnZXMpCiAgICAgICAgICAgICAgICBsb3NzLCBsb3NzX3h5LCBsb3NzX3doLCBsb3NzX29iaiwgbG9zc19jbHMsIGxvc3NfbDIgPSBjcml0ZXJpb24oYmJveGVzX3ByZWQsIGJib3hlcykKICAgICAgICAgICAgICAgICMgbG9zcyA9IGxvc3MgLyBjb25maWcuc3ViZGl2aXNpb25zCiAgICAgICAgICAgICAgICBsb3NzLmJhY2t3YXJkKCkKCiAgICAgICAgICAgICAgICBlcG9jaF9sb3NzICs9IGxvc3MuaXRlbSgpCgogICAgICAgICAgICAgICAgaWYgZ2xvYmFsX3N0ZXAgJSBjb25maWcuc3ViZGl2aXNpb25zID09IDA6CiAgICAgICAgICAgICAgICAgICAgb3B0aW1pemVyLnN0ZXAoKQogICAgICAgICAgICAgICAgICAgIHNjaGVkdWxlci5zdGVwKCkKICAgICAgICAgICAgICAgICAgICBtb2RlbC56ZXJvX2dyYWQoKQoKICAgICAgICAgICAgICAgIGlmIGdsb2JhbF9zdGVwICUgKGxvZ19zdGVwICogY29uZmlnLnN1YmRpdmlzaW9ucykgPT0gMDoKICAgICAgICAgICAgICAgICAgICB3cml0ZXIuYWRkX3NjYWxhcigndHJhaW4vTG9zcycsIGxvc3MuaXRlbSgpLCBnbG9iYWxfc3RlcCkKICAgICAgICAgICAgICAgICAgICB3cml0ZXIuYWRkX3NjYWxhcigndHJhaW4vbG9zc194eScsIGxvc3NfeHkuaXRlbSgpLCBnbG9iYWxfc3RlcCkKICAgICAgICAgICAgICAgICAgICB3cml0ZXIuYWRkX3NjYWxhcigndHJhaW4vbG9zc193aCcsIGxvc3Nfd2guaXRlbSgpLCBnbG9iYWxfc3RlcCkKICAgICAgICAgICAgICAgICAgICB3cml0ZXIuYWRkX3NjYWxhcigndHJhaW4vbG9zc19vYmonLCBsb3NzX29iai5pdGVtKCksIGdsb2JhbF9zdGVwKQogICAgICAgICAgICAgICAgICAgIHdyaXRlci5hZGRfc2NhbGFyKCd0cmFpbi9sb3NzX2NscycsIGxvc3NfY2xzLml0ZW0oKSwgZ2xvYmFsX3N0ZXApCiAgICAgICAgICAgICAgICAgICAgd3JpdGVyLmFkZF9zY2FsYXIoJ3RyYWluL2xvc3NfbDInLCBsb3NzX2wyLml0ZW0oKSwgZ2xvYmFsX3N0ZXApCiAgICAgICAgICAgICAgICAgICAgd3JpdGVyLmFkZF9zY2FsYXIoJ2xyJywgc2NoZWR1bGVyLmdldF9scigpWzBdICogY29uZmlnLmJhdGNoLCBnbG9iYWxfc3RlcCkKICAgICAgICAgICAgICAgICAgICBwYmFyLnNldF9wb3N0Zml4KCoqeydsb3NzIChiYXRjaCknOiBsb3NzLml0ZW0oKSwgJ2xvc3NfeHknOiBsb3NzX3h5Lml0ZW0oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsb3NzX3doJzogbG9zc193aC5pdGVtKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbG9zc19vYmonOiBsb3NzX29iai5pdGVtKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbG9zc19jbHMnOiBsb3NzX2Nscy5pdGVtKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbG9zc19sMic6IGxvc3NfbDIuaXRlbSgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xyJzogc2NoZWR1bGVyLmdldF9scigpWzBdICogY29uZmlnLmJhdGNoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIGxvZ2dpbmcuZGVidWcoJ1RyYWluIHN0ZXBfe306IGxvc3MgOiB7fSxsb3NzIHh5IDoge30sbG9zcyB3aCA6IHt9LCcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsb3NzIG9iaiA6IHt977yMbG9zcyBjbHMgOiB7fSxsb3NzIGwyIDoge30sbHIgOiB7fScKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mb3JtYXQoZ2xvYmFsX3N0ZXAsIGxvc3MuaXRlbSgpLCBsb3NzX3h5Lml0ZW0oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9zc193aC5pdGVtKCksIGxvc3Nfb2JqLml0ZW0oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9zc19jbHMuaXRlbSgpLCBsb3NzX2wyLml0ZW0oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGVyLmdldF9scigpWzBdICogY29uZmlnLmJhdGNoKSkKCiAgICAgICAgICAgICAgICBwYmFyLnVwZGF0ZShpbWFnZXMuc2hhcGVbMF0pCgogICAgICAgICAgICBpZiBjZmcudXNlX2RhcmtuZXRfY2ZnOgogICAgICAgICAgICAgICAgZXZhbF9tb2RlbCA9IERhcmtuZXQoY2ZnLmNmZ2ZpbGUsIGluZmVyZW5jZT1UcnVlKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZXZhbF9tb2RlbCA9IFlvbG92NChjZmcucHJldHJhaW5lZCwgbl9jbGFzc2VzPWNmZy5jbGFzc2VzLCBpbmZlcmVuY2U9VHJ1ZSkKICAgICAgICAgICAgIyBldmFsX21vZGVsID0gWW9sb3Y0KHlvbG92NGNvbnYxMzd3ZWlnaHQ9Tm9uZSwgbl9jbGFzc2VzPWNvbmZpZy5jbGFzc2VzLCBpbmZlcmVuY2U9VHJ1ZSkKICAgICAgICAgICAgaWYgdG9yY2guY3VkYS5kZXZpY2VfY291bnQoKSA+IDE6CiAgICAgICAgICAgICAgICBldmFsX21vZGVsLmxvYWRfc3RhdGVfZGljdChtb2RlbC5tb2R1bGUuc3RhdGVfZGljdCgpKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZXZhbF9tb2RlbC5sb2FkX3N0YXRlX2RpY3QobW9kZWwuc3RhdGVfZGljdCgpKQogICAgICAgICAgICBldmFsX21vZGVsLnRvKGRldmljZSkKICAgICAgICAgICAgZXZhbHVhdG9yID0gZXZhbHVhdGUoZXZhbF9tb2RlbCwgdmFsX2xvYWRlciwgY29uZmlnLCBkZXZpY2UpCiAgICAgICAgICAgIGRlbCBldmFsX21vZGVsCgogICAgICAgICAgICBzdGF0cyA9IGV2YWx1YXRvci5jb2NvX2V2YWxbJ2Jib3gnXS5zdGF0cwogICAgICAgICAgICB3cml0ZXIuYWRkX3NjYWxhcigndHJhaW4vQVAnLCBzdGF0c1swXSwgZ2xvYmFsX3N0ZXApCiAgICAgICAgICAgIHdyaXRlci5hZGRfc2NhbGFyKCd0cmFpbi9BUDUwJywgc3RhdHNbMV0sIGdsb2JhbF9zdGVwKQogICAgICAgICAgICB3cml0ZXIuYWRkX3NjYWxhcigndHJhaW4vQVA3NScsIHN0YXRzWzJdLCBnbG9iYWxfc3RlcCkKICAgICAgICAgICAgd3JpdGVyLmFkZF9zY2FsYXIoJ3RyYWluL0FQX3NtYWxsJywgc3RhdHNbM10sIGdsb2JhbF9zdGVwKQogICAgICAgICAgICB3cml0ZXIuYWRkX3NjYWxhcigndHJhaW4vQVBfbWVkaXVtJywgc3RhdHNbNF0sIGdsb2JhbF9zdGVwKQogICAgICAgICAgICB3cml0ZXIuYWRkX3NjYWxhcigndHJhaW4vQVBfbGFyZ2UnLCBzdGF0c1s1XSwgZ2xvYmFsX3N0ZXApCiAgICAgICAgICAgIHdyaXRlci5hZGRfc2NhbGFyKCd0cmFpbi9BUjEnLCBzdGF0c1s2XSwgZ2xvYmFsX3N0ZXApCiAgICAgICAgICAgIHdyaXRlci5hZGRfc2NhbGFyKCd0cmFpbi9BUjEwJywgc3RhdHNbN10sIGdsb2JhbF9zdGVwKQogICAgICAgICAgICB3cml0ZXIuYWRkX3NjYWxhcigndHJhaW4vQVIxMDAnLCBzdGF0c1s4XSwgZ2xvYmFsX3N0ZXApCiAgICAgICAgICAgIHdyaXRlci5hZGRfc2NhbGFyKCd0cmFpbi9BUl9zbWFsbCcsIHN0YXRzWzldLCBnbG9iYWxfc3RlcCkKICAgICAgICAgICAgd3JpdGVyLmFkZF9zY2FsYXIoJ3RyYWluL0FSX21lZGl1bScsIHN0YXRzWzEwXSwgZ2xvYmFsX3N0ZXApCiAgICAgICAgICAgIHdyaXRlci5hZGRfc2NhbGFyKCd0cmFpbi9BUl9sYXJnZScsIHN0YXRzWzExXSwgZ2xvYmFsX3N0ZXApCgogICAgICAgICAgICBpZiBzYXZlX2NwOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICMgb3MubWtkaXIoY29uZmlnLmNoZWNrcG9pbnRzKQogICAgICAgICAgICAgICAgICAgIG9zLm1ha2VkaXJzKGNvbmZpZy5jaGVja3BvaW50cywgZXhpc3Rfb2s9VHJ1ZSkKICAgICAgICAgICAgICAgICAgICBsb2dnaW5nLmluZm8oJ0NyZWF0ZWQgY2hlY2twb2ludCBkaXJlY3RvcnknKQogICAgICAgICAgICAgICAgZXhjZXB0IE9TRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgc2F2ZV9wYXRoID0gb3MucGF0aC5qb2luKGNvbmZpZy5jaGVja3BvaW50cywgZid7c2F2ZV9wcmVmaXh9e2Vwb2NoICsgMX0ucHRoJykKICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UobW9kZWwsIHRvcmNoLm5uLkRhdGFQYXJhbGxlbCk6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZV9kaWN0ID0gbW9kZWwubW9kdWxlLnN0YXRlX2RpY3QoKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBBdHRyaWJ1dGVFcnJvcjoKICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVfZGljdCA9IG1vZGVsLnN0YXRlX2RpY3QoKQogICAgICAgICAgICAgICAgICAgIHRvcmNoLnNhdmUoc3RhdGVfZGljdCwgc2F2ZV9wYXRoKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB0b3JjaC5zYXZlKG1vZGVsLnN0YXRlX2RpY3QoKSwgc2F2ZV9wYXRoKQogICAgICAgICAgICAgICAgbG9nZ2luZy5pbmZvKGYnQ2hlY2twb2ludCB7ZXBvY2ggKyAxfSBzYXZlZCAhJykKICAgICAgICAgICAgICAgIHNhdmVkX21vZGVscy5hcHBlbmQoc2F2ZV9wYXRoKQogICAgICAgICAgICAgICAgaWYgbGVuKHNhdmVkX21vZGVscykgPiBjb25maWcua2VlcF9jaGVja3BvaW50X21heCA+IDA6CiAgICAgICAgICAgICAgICAgICAgbW9kZWxfdG9fcmVtb3ZlID0gc2F2ZWRfbW9kZWxzLnBvcGxlZnQoKQogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgb3MucmVtb3ZlKG1vZGVsX3RvX3JlbW92ZSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIGxvZ2dpbmcuaW5mbyhmJ2ZhaWxlZCB0byByZW1vdmUge21vZGVsX3RvX3JlbW92ZX0nKQoKICAgIHdyaXRlci5jbG9zZSgpCgoKQHRvcmNoLm5vX2dyYWQoKQpkZWYgZXZhbHVhdGUobW9kZWwsIGRhdGFfbG9hZGVyLCBjZmcsIGRldmljZSwgbG9nZ2VyPU5vbmUsICoqa3dhcmdzKToKICAgICIiIiBmaW5pc2hlZCwgdGVzdGVkCiAgICAiIiIKICAgICMgY3B1X2RldmljZSA9IHRvcmNoLmRldmljZSgiY3B1IikKICAgIG1vZGVsLmV2YWwoKQogICAgIyBoZWFkZXIgPSAnVGVzdDonCgogICAgY29jbyA9IGNvbnZlcnRfdG9fY29jb19hcGkoZGF0YV9sb2FkZXIuZGF0YXNldCwgYmJveF9mbXQ9J2NvY28nKQogICAgY29jb19ldmFsdWF0b3IgPSBDb2NvRXZhbHVhdG9yKGNvY28sIGlvdV90eXBlcyA9IFsiYmJveCJdLCBiYm94X2ZtdD0nY29jbycpCgogICAgZm9yIGltYWdlcywgdGFyZ2V0cyBpbiBkYXRhX2xvYWRlcjoKICAgICAgICBtb2RlbF9pbnB1dCA9IFtbY3YyLnJlc2l6ZShpbWcsIChjZmcudywgY2ZnLmgpKV0gZm9yIGltZyBpbiBpbWFnZXNdCiAgICAgICAgbW9kZWxfaW5wdXQgPSBucC5jb25jYXRlbmF0ZShtb2RlbF9pbnB1dCwgYXhpcz0wKQogICAgICAgIG1vZGVsX2lucHV0ID0gbW9kZWxfaW5wdXQudHJhbnNwb3NlKDAsIDMsIDEsIDIpCiAgICAgICAgbW9kZWxfaW5wdXQgPSB0b3JjaC5mcm9tX251bXB5KG1vZGVsX2lucHV0KS5kaXYoMjU1LjApCiAgICAgICAgbW9kZWxfaW5wdXQgPSBtb2RlbF9pbnB1dC50byhkZXZpY2UpCiAgICAgICAgdGFyZ2V0cyA9IFt7azogdi50byhkZXZpY2UpIGZvciBrLCB2IGluIHQuaXRlbXMoKX0gZm9yIHQgaW4gdGFyZ2V0c10KCiAgICAgICAgaWYgdG9yY2guY3VkYS5pc19hdmFpbGFibGUoKToKICAgICAgICAgICAgdG9yY2guY3VkYS5zeW5jaHJvbml6ZSgpCiAgICAgICAgbW9kZWxfdGltZSA9IHRpbWUudGltZSgpCiAgICAgICAgb3V0cHV0cyA9IG1vZGVsKG1vZGVsX2lucHV0KQoKICAgICAgICAjIG91dHB1dHMgPSBbe2s6IHYudG8oY3B1X2RldmljZSkgZm9yIGssIHYgaW4gdC5pdGVtcygpfSBmb3IgdCBpbiBvdXRwdXRzXQogICAgICAgIG1vZGVsX3RpbWUgPSB0aW1lLnRpbWUoKSAtIG1vZGVsX3RpbWUKCiAgICAgICAgIyBvdXRwdXRzID0gb3V0cHV0cy5jcHUoKS5kZXRhY2goKS5udW1weSgpCiAgICAgICAgcmVzID0ge30KICAgICAgICAjIGZvciBpbWcsIHRhcmdldCwgb3V0cHV0IGluIHppcChpbWFnZXMsIHRhcmdldHMsIG91dHB1dHMpOgogICAgICAgIGZvciBpbWcsIHRhcmdldCwgYm94ZXMsIGNvbmZzIGluIHppcChpbWFnZXMsIHRhcmdldHMsIG91dHB1dHNbMF0sIG91dHB1dHNbMV0pOgogICAgICAgICAgICBpbWdfaGVpZ2h0LCBpbWdfd2lkdGggPSBpbWcuc2hhcGVbOjJdCiAgICAgICAgICAgICMgYm94ZXMgPSBvdXRwdXRbLi4uLDo0XS5jb3B5KCkgICMgb3V0cHV0IGJveGVzIGluIHlvbG8gZm9ybWF0CiAgICAgICAgICAgIGJveGVzID0gYm94ZXMuc3F1ZWV6ZSgyKS5jcHUoKS5kZXRhY2goKS5udW1weSgpCiAgICAgICAgICAgIGJveGVzWy4uLiwyOl0gPSBib3hlc1suLi4sMjpdIC0gYm94ZXNbLi4uLDoyXSAjIFRyYW5zZm9ybSBbeDEsIHkxLCB4MiwgeTJdIHRvIFt4MSwgeTEsIHcsIGhdCiAgICAgICAgICAgIGJveGVzWy4uLiwwXSA9IGJveGVzWy4uLiwwXSppbWdfd2lkdGgKICAgICAgICAgICAgYm94ZXNbLi4uLDFdID0gYm94ZXNbLi4uLDFdKmltZ19oZWlnaHQKICAgICAgICAgICAgYm94ZXNbLi4uLDJdID0gYm94ZXNbLi4uLDJdKmltZ193aWR0aAogICAgICAgICAgICBib3hlc1suLi4sM10gPSBib3hlc1suLi4sM10qaW1nX2hlaWdodAogICAgICAgICAgICBib3hlcyA9IHRvcmNoLmFzX3RlbnNvcihib3hlcywgZHR5cGU9dG9yY2guZmxvYXQzMikKICAgICAgICAgICAgIyBjb25mcyA9IG91dHB1dFsuLi4sNDpdLmNvcHkoKQogICAgICAgICAgICBjb25mcyA9IGNvbmZzLmNwdSgpLmRldGFjaCgpLm51bXB5KCkKICAgICAgICAgICAgbGFiZWxzID0gbnAuYXJnbWF4KGNvbmZzLCBheGlzPTEpLmZsYXR0ZW4oKQogICAgICAgICAgICBsYWJlbHMgPSB0b3JjaC5hc190ZW5zb3IobGFiZWxzLCBkdHlwZT10b3JjaC5pbnQ2NCkKICAgICAgICAgICAgc2NvcmVzID0gbnAubWF4KGNvbmZzLCBheGlzPTEpLmZsYXR0ZW4oKQogICAgICAgICAgICBzY29yZXMgPSB0b3JjaC5hc190ZW5zb3Ioc2NvcmVzLCBkdHlwZT10b3JjaC5mbG9hdDMyKQogICAgICAgICAgICByZXNbdGFyZ2V0WyJpbWFnZV9pZCJdLml0ZW0oKV0gPSB7CiAgICAgICAgICAgICAgICAiYm94ZXMiOiBib3hlcywKICAgICAgICAgICAgICAgICJzY29yZXMiOiBzY29yZXMsCiAgICAgICAgICAgICAgICAibGFiZWxzIjogbGFiZWxzLAogICAgICAgICAgICB9CiAgICAgICAgZXZhbHVhdG9yX3RpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgIGNvY29fZXZhbHVhdG9yLnVwZGF0ZShyZXMpCiAgICAgICAgZXZhbHVhdG9yX3RpbWUgPSB0aW1lLnRpbWUoKSAtIGV2YWx1YXRvcl90aW1lCgogICAgIyBnYXRoZXIgdGhlIHN0YXRzIGZyb20gYWxsIHByb2Nlc3NlcwogICAgY29jb19ldmFsdWF0b3Iuc3luY2hyb25pemVfYmV0d2Vlbl9wcm9jZXNzZXMoKQoKICAgICMgYWNjdW11bGF0ZSBwcmVkaWN0aW9ucyBmcm9tIGFsbCBpbWFnZXMKICAgIGNvY29fZXZhbHVhdG9yLmFjY3VtdWxhdGUoKQogICAgY29jb19ldmFsdWF0b3Iuc3VtbWFyaXplKCkKCiAgICByZXR1cm4gY29jb19ldmFsdWF0b3IKCgpkZWYgZ2V0X2FyZ3MoKiprd2FyZ3MpOgogICAgY2ZnID0ga3dhcmdzCiAgICBwYXJzZXIgPSBhcmdwYXJzZS5Bcmd1bWVudFBhcnNlcihkZXNjcmlwdGlvbj0nVHJhaW4gdGhlIE1vZGVsIG9uIGltYWdlcyBhbmQgdGFyZ2V0IG1hc2tzJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlcl9jbGFzcz1hcmdwYXJzZS5Bcmd1bWVudERlZmF1bHRzSGVscEZvcm1hdHRlcikKICAgICMgcGFyc2VyLmFkZF9hcmd1bWVudCgnLWInLCAnLS1iYXRjaC1zaXplJywgbWV0YXZhcj0nQicsIHR5cGU9aW50LCBuYXJncz0nPycsIGRlZmF1bHQ9MiwKICAgICMgICAgICAgICAgICAgICAgICAgICBoZWxwPSdCYXRjaCBzaXplJywgZGVzdD0nYmF0Y2hzaXplJykKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoJy1sJywgJy0tbGVhcm5pbmctcmF0ZScsIG1ldGF2YXI9J0xSJywgdHlwZT1mbG9hdCwgbmFyZ3M9Jz8nLCBkZWZhdWx0PTAuMDAxLAogICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdMZWFybmluZyByYXRlJywgZGVzdD0nbGVhcm5pbmdfcmF0ZScpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCctZicsICctLWxvYWQnLCBkZXN0PSdsb2FkJywgdHlwZT1zdHIsIGRlZmF1bHQ9Tm9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgaGVscD0nTG9hZCBtb2RlbCBmcm9tIGEgLnB0aCBmaWxlJykKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoJy1nJywgJy0tZ3B1JywgbWV0YXZhcj0nRycsIHR5cGU9c3RyLCBkZWZhdWx0PSctMScsCiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHA9J0dQVScsIGRlc3Q9J2dwdScpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KCctZGlyJywgJy0tZGF0YS1kaXInLCB0eXBlPXN0ciwgZGVmYXVsdD1Ob25lLAogICAgICAgICAgICAgICAgICAgICAgICBoZWxwPSdkYXRhc2V0IGRpcicsIGRlc3Q9J2RhdGFzZXRfZGlyJykKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoJy1wcmV0cmFpbmVkJywgdHlwZT1zdHIsIGRlZmF1bHQ9Tm9uZSwgaGVscD0ncHJldHJhaW5lZCB5b2xvdjQuY29udi4xMzcnKQogICAgcGFyc2VyLmFkZF9hcmd1bWVudCgnLWNsYXNzZXMnLCB0eXBlPWludCwgZGVmYXVsdD04MCwgaGVscD0nZGF0YXNldCBjbGFzc2VzJykKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoJy10cmFpbl9sYWJlbF9wYXRoJywgZGVzdD0ndHJhaW5fbGFiZWwnLCB0eXBlPXN0ciwgZGVmYXVsdD0ndHJhaW4udHh0JywgaGVscD0idHJhaW4gbGFiZWwgcGF0aCIpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KAogICAgICAgICctb3B0aW1pemVyJywgdHlwZT1zdHIsIGRlZmF1bHQ9J2FkYW0nLAogICAgICAgIGhlbHA9J3RyYWluaW5nIG9wdGltaXplcicsCiAgICAgICAgZGVzdD0nVFJBSU5fT1BUSU1JWkVSJykKICAgIHBhcnNlci5hZGRfYXJndW1lbnQoCiAgICAgICAgJy1pb3UtdHlwZScsIHR5cGU9c3RyLCBkZWZhdWx0PSdpb3UnLAogICAgICAgIGhlbHA9J2lvdSB0eXBlIChpb3UsIGdpb3UsIGRpb3UsIGNpb3UpJywKICAgICAgICBkZXN0PSdpb3VfdHlwZScpCiAgICBwYXJzZXIuYWRkX2FyZ3VtZW50KAogICAgICAgICcta2VlcC1jaGVja3BvaW50LW1heCcsIHR5cGU9aW50LCBkZWZhdWx0PTEwLAogICAgICAgIGhlbHA9J21heGltdW0gbnVtYmVyIG9mIGNoZWNrcG9pbnRzIHRvIGtlZXAuIElmIHNldCAwLCBhbGwgY2hlY2twb2ludHMgd2lsbCBiZSBrZXB0JywKICAgICAgICBkZXN0PSdrZWVwX2NoZWNrcG9pbnRfbWF4JykKICAgIGFyZ3MgPSB2YXJzKHBhcnNlci5wYXJzZV9hcmdzKCkpCgogICAgIyBmb3IgayBpbiBhcmdzLmtleXMoKToKICAgICMgICAgIGNmZ1trXSA9IGFyZ3MuZ2V0KGspCiAgICBjZmcudXBkYXRlKGFyZ3MpCgogICAgcmV0dXJuIGVkaWN0KGNmZykKCgpkZWYgaW5pdF9sb2dnZXIobG9nX2ZpbGU9Tm9uZSwgbG9nX2Rpcj1Ob25lLCBsb2dfbGV2ZWw9bG9nZ2luZy5JTkZPLCBtb2RlPSd3Jywgc3Rkb3V0PVRydWUpOgogICAgIiIiCiAgICBsb2dfZGlyOiDml6Xlv5fmlofku7bnmoTmlofku7blpLnot6/lvoQKICAgIG1vZGU6ICdhJywgYXBwZW5kOyAndycsIOimhuebluWOn+aWh+S7tuWGmeWFpS4KICAgICIiIgogICAgZGVmIGdldF9kYXRlX3N0cigpOgogICAgICAgIG5vdyA9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpCiAgICAgICAgcmV0dXJuIG5vdy5zdHJmdGltZSgnJVktJW0tJWRfJUgtJU0tJVMnKQoKICAgIGZtdCA9ICclKGFzY3RpbWUpcyAlKGZpbGVuYW1lKXNbbGluZTolKGxpbmVubylkXSAlKGxldmVsbmFtZSlzOiAlKG1lc3NhZ2UpcycKICAgIGlmIGxvZ19kaXIgaXMgTm9uZToKICAgICAgICBsb2dfZGlyID0gJ34vdGVtcC9sb2cvJwogICAgaWYgbG9nX2ZpbGUgaXMgTm9uZToKICAgICAgICBsb2dfZmlsZSA9ICdsb2dfJyArIGdldF9kYXRlX3N0cigpICsgJy50eHQnCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMobG9nX2Rpcik6CiAgICAgICAgb3MubWFrZWRpcnMobG9nX2RpcikKICAgIGxvZ19maWxlID0gb3MucGF0aC5qb2luKGxvZ19kaXIsIGxvZ19maWxlKQogICAgIyDmraTlpITkuI3og73kvb/nlKhsb2dnaW5n6L6T5Ye6CiAgICBwcmludCgnbG9nIGZpbGUgcGF0aDonICsgbG9nX2ZpbGUpCgogICAgbG9nZ2luZy5iYXNpY0NvbmZpZyhsZXZlbD1sb2dnaW5nLkRFQlVHLAogICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ9Zm10LAogICAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZT1sb2dfZmlsZSwKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW1vZGU9bW9kZSkKCiAgICBpZiBzdGRvdXQ6CiAgICAgICAgY29uc29sZSA9IGxvZ2dpbmcuU3RyZWFtSGFuZGxlcihzdHJlYW09c3lzLnN0ZG91dCkKICAgICAgICBjb25zb2xlLnNldExldmVsKGxvZ19sZXZlbCkKICAgICAgICBmb3JtYXR0ZXIgPSBsb2dnaW5nLkZvcm1hdHRlcihmbXQpCiAgICAgICAgY29uc29sZS5zZXRGb3JtYXR0ZXIoZm9ybWF0dGVyKQogICAgICAgIGxvZ2dpbmcuZ2V0TG9nZ2VyKCcnKS5hZGRIYW5kbGVyKGNvbnNvbGUpCgogICAgcmV0dXJuIGxvZ2dpbmcKCgpkZWYgX2dldF9kYXRlX3N0cigpOgogICAgbm93ID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkKICAgIHJldHVybiBub3cuc3RyZnRpbWUoJyVZLSVtLSVkXyVILSVNJykKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbG9nZ2luZyA9IGluaXRfbG9nZ2VyKGxvZ19kaXI9J2xvZycpCiAgICBjZmcgPSBnZXRfYXJncygqKkNmZykKICAgIG9zLmVudmlyb25bIkNVREFfVklTSUJMRV9ERVZJQ0VTIl0gPSBjZmcuZ3B1CiAgICBkZXZpY2UgPSB0b3JjaC5kZXZpY2UoJ2N1ZGEnIGlmIHRvcmNoLmN1ZGEuaXNfYXZhaWxhYmxlKCkgZWxzZSAnY3B1JykKICAgIGxvZ2dpbmcuaW5mbyhmJ1VzaW5nIGRldmljZSB7ZGV2aWNlfScpCgogICAgI3RvZG8gZml4CiAgICBjZmcudXNlX2RhcmtuZXRfY2ZnID0gRmFsc2UKICAgIGNmZy5jbGFzc2VzID0gMQogICAgY2ZnLndpZHRoID0gNjA4CiAgICBjZmcuaGVpZ2h0ID0gNjA4CiAgICBjZmcuY2hhbm5lbHMgPSAzCiAgICBjZmcubGVhcm5pbmdfcmF0ZSA9IDAuMDEKICAgICMgY2ZnLlRSQUlOX09QVElNSVpFUiA9ICJzZ2QiCiAgICBjZmcuVFJBSU5fT1BUSU1JWkVSID0gImFkYW0iCiAgICAjIGNmZy5UUkFJTl9PUFRJTUlaRVIgPSAiYWRhbXciCgogICAgaWYgY2ZnLnVzZV9kYXJrbmV0X2NmZzoKICAgICAgICBtb2RlbCA9IERhcmtuZXQoY2ZnLmNmZ2ZpbGUpCiAgICBlbHNlOgogICAgICAgIG1vZGVsID0gWW9sb3Y0KHlvbG92NGNvbnYxMzd3ZWlnaHQ9Y2ZnLnByZXRyYWluZWQsIG5fY2xhc3Nlcz1jZmcuY2xhc3NlcykKCiAgICBpZiB0b3JjaC5jdWRhLmRldmljZV9jb3VudCgpID4gMToKICAgICAgICBtb2RlbCA9IHRvcmNoLm5uLkRhdGFQYXJhbGxlbChtb2RlbCkKICAgIG1vZGVsLnRvKGRldmljZT1kZXZpY2UpCgogICAgdHJ5OgogICAgICAgIHRyYWluKG1vZGVsPW1vZGVsLAogICAgICAgICAgICAgIGNvbmZpZz1jZmcsCiAgICAgICAgICAgICAgZXBvY2hzPWNmZy5UUkFJTl9FUE9DSFMsCiAgICAgICAgICAgICAgZGV2aWNlPWRldmljZSwgKQogICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgIGlmIGlzaW5zdGFuY2UobW9kZWwsIHRvcmNoLm5uLkRhdGFQYXJhbGxlbCk6CiAgICAgICAgICAgIHRvcmNoLnNhdmUobW9kZWwubW9kdWxlLnN0YXRlX2RpY3QoKSwgJ0lOVEVSUlVQVEVELnB0aCcpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdG9yY2guc2F2ZShtb2RlbC5zdGF0ZV9kaWN0KCksICdJTlRFUlJVUFRFRC5wdGgnKQogICAgICAgIGxvZ2dpbmcuaW5mbygnU2F2ZWQgaW50ZXJydXB0JykKICAgICAgICB0cnk6CiAgICAgICAgICAgIHN5cy5leGl0KDApCiAgICAgICAgZXhjZXB0IFN5c3RlbUV4aXQ6CiAgICAgICAgICAgIG9zLl9leGl0KDApCg==')
    file.write(train_string)

with open(root + "YOLOv4" + "/dataset.py", "wb") as file:
    dataset_string = base64.b64decode(b'IyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KJycnCkBUaW1lICAgICAgICAgIDogMjAyMC8wNS8wNiAyMTowOQpAQXV0aG9yICAgICAgICA6IFRpYW54aWFvbW8KQEZpbGUgICAgICAgICAgOiBkYXRhc2V0LnB5CkBOb2ljZSAgICAgICAgIDoKQE1vZGlmaWNhdHRpb24gOgogICAgQEF1dGhvciAgICA6CiAgICBAVGltZSAgICAgIDoKICAgIEBEZXRhaWwgICAgOgoKJycnCmltcG9ydCBvcwppbXBvcnQgcmFuZG9tCmltcG9ydCByZQppbXBvcnQgc3lzCmZyb20gdGtpbnRlciBpbXBvcnQgZmlsZWRpYWxvZwoKaW1wb3J0IGN2MgppbXBvcnQgbnVtcHkgYXMgbnAKCmltcG9ydCB0b3JjaApmcm9tIHRvcmNoLnV0aWxzLmRhdGEuZGF0YXNldCBpbXBvcnQgRGF0YXNldAoKCmRlZiByYW5kX3VuaWZvcm1fc3Ryb25nKG1pbiwgbWF4KToKICAgIGlmIG1pbiA+IG1heDoKICAgICAgICBzd2FwID0gbWluCiAgICAgICAgbWluID0gbWF4CiAgICAgICAgbWF4ID0gc3dhcAogICAgcmV0dXJuIHJhbmRvbS5yYW5kb20oKSAqIChtYXggLSBtaW4pICsgbWluCgoKZGVmIHJhbmRfc2NhbGUocyk6CiAgICBzY2FsZSA9IHJhbmRfdW5pZm9ybV9zdHJvbmcoMSwgcykKICAgIGlmIHJhbmRvbS5yYW5kaW50KDAsIDEpICUgMjoKICAgICAgICByZXR1cm4gc2NhbGUKICAgIHJldHVybiAxLiAvIHNjYWxlCgoKZGVmIHJhbmRfcHJlY2FsY19yYW5kb20obWluLCBtYXgsIHJhbmRvbV9wYXJ0KToKICAgIGlmIG1heCA8IG1pbjoKICAgICAgICBzd2FwID0gbWluCiAgICAgICAgbWluID0gbWF4CiAgICAgICAgbWF4ID0gc3dhcAogICAgcmV0dXJuIChyYW5kb21fcGFydCAqIChtYXggLSBtaW4pKSArIG1pbgoKCmRlZiBmaWxsX3RydXRoX2RldGVjdGlvbihiYm94ZXMsIG51bV9ib3hlcywgY2xhc3NlcywgZmxpcCwgZHgsIGR5LCBzeCwgc3ksIG5ldF93LCBuZXRfaCk6CiAgICBpZiBiYm94ZXMuc2hhcGVbMF0gPT0gMDoKICAgICAgICByZXR1cm4gYmJveGVzLCAxMDAwMAogICAgbnAucmFuZG9tLnNodWZmbGUoYmJveGVzKQogICAgYmJveGVzWzosIDBdIC09IGR4CiAgICBiYm94ZXNbOiwgMl0gLT0gZHgKICAgIGJib3hlc1s6LCAxXSAtPSBkeQogICAgYmJveGVzWzosIDNdIC09IGR5CgogICAgYmJveGVzWzosIDBdID0gbnAuY2xpcChiYm94ZXNbOiwgMF0sIDAsIHN4KQogICAgYmJveGVzWzosIDJdID0gbnAuY2xpcChiYm94ZXNbOiwgMl0sIDAsIHN4KQoKICAgIGJib3hlc1s6LCAxXSA9IG5wLmNsaXAoYmJveGVzWzosIDFdLCAwLCBzeSkKICAgIGJib3hlc1s6LCAzXSA9IG5wLmNsaXAoYmJveGVzWzosIDNdLCAwLCBzeSkKCiAgICBvdXRfYm94ID0gbGlzdChucC53aGVyZSgoKGJib3hlc1s6LCAxXSA9PSBzeSkgJiAoYmJveGVzWzosIDNdID09IHN5KSkgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKChiYm94ZXNbOiwgMF0gPT0gc3gpICYgKGJib3hlc1s6LCAyXSA9PSBzeCkpIHwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoYmJveGVzWzosIDFdID09IDApICYgKGJib3hlc1s6LCAzXSA9PSAwKSkgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKChiYm94ZXNbOiwgMF0gPT0gMCkgJiAoYmJveGVzWzosIDJdID09IDApKSlbMF0pCiAgICBsaXN0X2JveCA9IGxpc3QocmFuZ2UoYmJveGVzLnNoYXBlWzBdKSkKICAgIGZvciBpIGluIG91dF9ib3g6CiAgICAgICAgbGlzdF9ib3gucmVtb3ZlKGkpCiAgICBiYm94ZXMgPSBiYm94ZXNbbGlzdF9ib3hdCgogICAgaWYgYmJveGVzLnNoYXBlWzBdID09IDA6CiAgICAgICAgcmV0dXJuIGJib3hlcywgMTAwMDAKCiAgICBiYm94ZXMgPSBiYm94ZXNbbnAud2hlcmUoKGJib3hlc1s6LCA0XSA8IGNsYXNzZXMpICYgKGJib3hlc1s6LCA0XSA+PSAwKSlbMF1dCgogICAgaWYgYmJveGVzLnNoYXBlWzBdID4gbnVtX2JveGVzOgogICAgICAgIGJib3hlcyA9IGJib3hlc1s6bnVtX2JveGVzXQoKICAgIG1pbl93X2ggPSBucC5hcnJheShbYmJveGVzWzosIDJdIC0gYmJveGVzWzosIDBdLCBiYm94ZXNbOiwgM10gLSBiYm94ZXNbOiwgMV1dKS5taW4oKQoKICAgIGJib3hlc1s6LCAwXSAqPSAobmV0X3cgLyBzeCkKICAgIGJib3hlc1s6LCAyXSAqPSAobmV0X3cgLyBzeCkKICAgIGJib3hlc1s6LCAxXSAqPSAobmV0X2ggLyBzeSkKICAgIGJib3hlc1s6LCAzXSAqPSAobmV0X2ggLyBzeSkKCiAgICBpZiBmbGlwOgogICAgICAgIHRlbXAgPSBuZXRfdyAtIGJib3hlc1s6LCAwXQogICAgICAgIGJib3hlc1s6LCAwXSA9IG5ldF93IC0gYmJveGVzWzosIDJdCiAgICAgICAgYmJveGVzWzosIDJdID0gdGVtcAoKICAgIHJldHVybiBiYm94ZXMsIG1pbl93X2gKCgpkZWYgcmVjdF9pbnRlcnNlY3Rpb24oYSwgYik6CiAgICBtaW54ID0gbWF4KGFbMF0sIGJbMF0pCiAgICBtaW55ID0gbWF4KGFbMV0sIGJbMV0pCgogICAgbWF4eCA9IG1pbihhWzJdLCBiWzJdKQogICAgbWF4eSA9IG1pbihhWzNdLCBiWzNdKQogICAgcmV0dXJuIFttaW54LCBtaW55LCBtYXh4LCBtYXh5XQoKCmRlZiBpbWFnZV9kYXRhX2F1Z21lbnRhdGlvbihtYXQsIHcsIGgsIHBsZWZ0LCBwdG9wLCBzd2lkdGgsIHNoZWlnaHQsIGZsaXAsIGRodWUsIGRzYXQsIGRleHAsIGdhdXNzaWFuX25vaXNlLCBibHVyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1dGgpOgogICAgdHJ5OgogICAgICAgIGltZyA9IG1hdAogICAgICAgIG9oLCBvdywgXyA9IGltZy5zaGFwZQogICAgICAgIHBsZWZ0LCBwdG9wLCBzd2lkdGgsIHNoZWlnaHQgPSBpbnQocGxlZnQpLCBpbnQocHRvcCksIGludChzd2lkdGgpLCBpbnQoc2hlaWdodCkKICAgICAgICAjIGNyb3AKICAgICAgICBzcmNfcmVjdCA9IFtwbGVmdCwgcHRvcCwgc3dpZHRoICsgcGxlZnQsIHNoZWlnaHQgKyBwdG9wXSAgIyB4MSx5MSx4Mix5MgogICAgICAgIGltZ19yZWN0ID0gWzAsIDAsIG93LCBvaF0KICAgICAgICBuZXdfc3JjX3JlY3QgPSByZWN0X2ludGVyc2VjdGlvbihzcmNfcmVjdCwgaW1nX3JlY3QpICAjIOS6pOmbhgoKICAgICAgICBkc3RfcmVjdCA9IFttYXgoMCwgLXBsZWZ0KSwgbWF4KDAsIC1wdG9wKSwgbWF4KDAsIC1wbGVmdCkgKyBuZXdfc3JjX3JlY3RbMl0gLSBuZXdfc3JjX3JlY3RbMF0sCiAgICAgICAgICAgICAgICAgICAgbWF4KDAsIC1wdG9wKSArIG5ld19zcmNfcmVjdFszXSAtIG5ld19zcmNfcmVjdFsxXV0KICAgICAgICAjIGN2Mi5NYXQgc2l6ZWQKCiAgICAgICAgaWYgKHNyY19yZWN0WzBdID09IDAgYW5kIHNyY19yZWN0WzFdID09IDAgYW5kIHNyY19yZWN0WzJdID09IGltZy5zaGFwZVswXSBhbmQgc3JjX3JlY3RbM10gPT0gaW1nLnNoYXBlWzFdKToKICAgICAgICAgICAgc2l6ZWQgPSBjdjIucmVzaXplKGltZywgKHcsIGgpLCBjdjIuSU5URVJfTElORUFSKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNyb3BwZWQgPSBucC56ZXJvcyhbc2hlaWdodCwgc3dpZHRoLCAzXSkKICAgICAgICAgICAgY3JvcHBlZFs6LCA6LCBdID0gbnAubWVhbihpbWcsIGF4aXM9KDAsIDEpKQoKICAgICAgICAgICAgY3JvcHBlZFtkc3RfcmVjdFsxXTpkc3RfcmVjdFszXSwgZHN0X3JlY3RbMF06ZHN0X3JlY3RbMl1dID0gXAogICAgICAgICAgICAgICAgaW1nW25ld19zcmNfcmVjdFsxXTpuZXdfc3JjX3JlY3RbM10sIG5ld19zcmNfcmVjdFswXTpuZXdfc3JjX3JlY3RbMl1dCgogICAgICAgICAgICAjIHJlc2l6ZQogICAgICAgICAgICBzaXplZCA9IGN2Mi5yZXNpemUoY3JvcHBlZCwgKHcsIGgpLCBjdjIuSU5URVJfTElORUFSKQoKICAgICAgICAjIGZsaXAKICAgICAgICBpZiBmbGlwOgogICAgICAgICAgICAjIGN2Mi5NYXQgY3JvcHBlZAogICAgICAgICAgICBzaXplZCA9IGN2Mi5mbGlwKHNpemVkLCAxKSAgIyAwIC0geC1heGlzLCAxIC0geS1heGlzLCAtMSAtIGJvdGggYXhlcyAoeCAmIHkpCgogICAgICAgICMgSFNWIGF1Z21lbnRhdGlvbgogICAgICAgICMgY3YyLkNPTE9SX0JHUjJIU1YsIGN2Mi5DT0xPUl9SR0IySFNWLCBjdjIuQ09MT1JfSFNWMkJHUiwgY3YyLkNPTE9SX0hTVjJSR0IKICAgICAgICBpZiBkc2F0ICE9IDEgb3IgZGV4cCAhPSAxIG9yIGRodWUgIT0gMDoKICAgICAgICAgICAgaWYgaW1nLnNoYXBlWzJdID49IDM6CiAgICAgICAgICAgICAgICBoc3Zfc3JjID0gY3YyLmN2dENvbG9yKHNpemVkLmFzdHlwZShucC5mbG9hdDMyKSwgY3YyLkNPTE9SX1JHQjJIU1YpICAjIFJHQiB0byBIU1YKICAgICAgICAgICAgICAgIGhzdiA9IGN2Mi5zcGxpdChoc3Zfc3JjKQogICAgICAgICAgICAgICAgaHN2WzFdICo9IGRzYXQKICAgICAgICAgICAgICAgIGhzdlsyXSAqPSBkZXhwCiAgICAgICAgICAgICAgICBoc3ZbMF0gKz0gMTc5ICogZGh1ZQogICAgICAgICAgICAgICAgaHN2X3NyYyA9IGN2Mi5tZXJnZShoc3YpCiAgICAgICAgICAgICAgICBzaXplZCA9IG5wLmNsaXAoY3YyLmN2dENvbG9yKGhzdl9zcmMsIGN2Mi5DT0xPUl9IU1YyUkdCKSwgMCwgMjU1KSAgIyBIU1YgdG8gUkdCICh0aGUgc2FtZSBhcyBwcmV2aW91cykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNpemVkICo9IGRleHAKCiAgICAgICAgaWYgYmx1cjoKICAgICAgICAgICAgaWYgYmx1ciA9PSAxOgogICAgICAgICAgICAgICAgZHN0ID0gY3YyLkdhdXNzaWFuQmx1cihzaXplZCwgKDE3LCAxNyksIDApCiAgICAgICAgICAgICAgICAjIGN2Mi5iaWxhdGVyYWxGaWx0ZXIoc2l6ZWQsIGRzdCwgMTcsIDc1LCA3NSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGtzaXplID0gKGJsdXIgLyAyKSAqIDIgKyAxCiAgICAgICAgICAgICAgICBkc3QgPSBjdjIuR2F1c3NpYW5CbHVyKHNpemVkLCAoa3NpemUsIGtzaXplKSwgMCkKCiAgICAgICAgICAgIGlmIGJsdXIgPT0gMToKICAgICAgICAgICAgICAgIGltZ19yZWN0ID0gWzAsIDAsIHNpemVkLmNvbHMsIHNpemVkLnJvd3NdCiAgICAgICAgICAgICAgICBmb3IgYiBpbiB0cnV0aDoKICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gKGIueCAtIGIudyAvIDIuKSAqIHNpemVkLnNoYXBlWzFdCiAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBiLncgKiBzaXplZC5zaGFwZVsxXQogICAgICAgICAgICAgICAgICAgIHRvcCA9IChiLnkgLSBiLmggLyAyLikgKiBzaXplZC5zaGFwZVswXQogICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IGIuaCAqIHNpemVkLnNoYXBlWzBdCiAgICAgICAgICAgICAgICAgICAgcm9pKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkKICAgICAgICAgICAgICAgICAgICByb2kgPSByb2kgJiBpbWdfcmVjdAogICAgICAgICAgICAgICAgICAgIGRzdFtyb2lbMF06cm9pWzBdICsgcm9pWzJdLCByb2lbMV06cm9pWzFdICsgcm9pWzNdXSA9IHNpemVkW3JvaVswXTpyb2lbMF0gKyByb2lbMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9pWzFdOnJvaVsxXSArIHJvaVszXV0KCiAgICAgICAgICAgIHNpemVkID0gZHN0CgogICAgICAgIGlmIGdhdXNzaWFuX25vaXNlOgogICAgICAgICAgICBub2lzZSA9IG5wLmFycmF5KHNpemVkLnNoYXBlKQogICAgICAgICAgICBnYXVzc2lhbl9ub2lzZSA9IG1pbihnYXVzc2lhbl9ub2lzZSwgMTI3KQogICAgICAgICAgICBnYXVzc2lhbl9ub2lzZSA9IG1heChnYXVzc2lhbl9ub2lzZSwgMCkKICAgICAgICAgICAgY3YyLnJhbmRuKG5vaXNlLCAwLCBnYXVzc2lhbl9ub2lzZSkgICMgbWVhbiBhbmQgdmFyaWFuY2UKICAgICAgICAgICAgc2l6ZWQgPSBzaXplZCArIG5vaXNlCiAgICBleGNlcHQ6CiAgICAgICAgcHJpbnQoIk9wZW5DViBjYW4ndCBhdWdtZW50IGltYWdlOiAiICsgc3RyKHcpICsgIiB4ICIgKyBzdHIoaCkpCiAgICAgICAgc2l6ZWQgPSBtYXQKCiAgICByZXR1cm4gc2l6ZWQKCgpkZWYgZmlsdGVyX3RydXRoKGJib3hlcywgZHgsIGR5LCBzeCwgc3ksIHhkLCB5ZCk6CiAgICBiYm94ZXNbOiwgMF0gLT0gZHgKICAgIGJib3hlc1s6LCAyXSAtPSBkeAogICAgYmJveGVzWzosIDFdIC09IGR5CiAgICBiYm94ZXNbOiwgM10gLT0gZHkKCiAgICBiYm94ZXNbOiwgMF0gPSBucC5jbGlwKGJib3hlc1s6LCAwXSwgMCwgc3gpCiAgICBiYm94ZXNbOiwgMl0gPSBucC5jbGlwKGJib3hlc1s6LCAyXSwgMCwgc3gpCgogICAgYmJveGVzWzosIDFdID0gbnAuY2xpcChiYm94ZXNbOiwgMV0sIDAsIHN5KQogICAgYmJveGVzWzosIDNdID0gbnAuY2xpcChiYm94ZXNbOiwgM10sIDAsIHN5KQoKICAgIG91dF9ib3ggPSBsaXN0KG5wLndoZXJlKCgoYmJveGVzWzosIDFdID09IHN5KSAmIChiYm94ZXNbOiwgM10gPT0gc3kpKSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKGJib3hlc1s6LCAwXSA9PSBzeCkgJiAoYmJveGVzWzosIDJdID09IHN4KSkgfAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKChiYm94ZXNbOiwgMV0gPT0gMCkgJiAoYmJveGVzWzosIDNdID09IDApKSB8CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKGJib3hlc1s6LCAwXSA9PSAwKSAmIChiYm94ZXNbOiwgMl0gPT0gMCkpKVswXSkKICAgIGxpc3RfYm94ID0gbGlzdChyYW5nZShiYm94ZXMuc2hhcGVbMF0pKQogICAgZm9yIGkgaW4gb3V0X2JveDoKICAgICAgICBsaXN0X2JveC5yZW1vdmUoaSkKICAgIGJib3hlcyA9IGJib3hlc1tsaXN0X2JveF0KCiAgICBiYm94ZXNbOiwgMF0gKz0geGQKICAgIGJib3hlc1s6LCAyXSArPSB4ZAogICAgYmJveGVzWzosIDFdICs9IHlkCiAgICBiYm94ZXNbOiwgM10gKz0geWQKCiAgICByZXR1cm4gYmJveGVzCgoKZGVmIGJsZW5kX3RydXRoX21vc2FpYyhvdXRfaW1nLCBpbWcsIGJib3hlcywgdywgaCwgY3V0X3gsIGN1dF95LCBpX21peHVwLAogICAgICAgICAgICAgICAgICAgICAgIGxlZnRfc2hpZnQsIHJpZ2h0X3NoaWZ0LCB0b3Bfc2hpZnQsIGJvdF9zaGlmdCk6CiAgICBsZWZ0X3NoaWZ0ID0gbWluKGxlZnRfc2hpZnQsIHcgLSBjdXRfeCkKICAgIHRvcF9zaGlmdCA9IG1pbih0b3Bfc2hpZnQsIGggLSBjdXRfeSkKICAgIHJpZ2h0X3NoaWZ0ID0gbWluKHJpZ2h0X3NoaWZ0LCBjdXRfeCkKICAgIGJvdF9zaGlmdCA9IG1pbihib3Rfc2hpZnQsIGN1dF95KQoKICAgIGlmIGlfbWl4dXAgPT0gMDoKICAgICAgICBiYm94ZXMgPSBmaWx0ZXJfdHJ1dGgoYmJveGVzLCBsZWZ0X3NoaWZ0LCB0b3Bfc2hpZnQsIGN1dF94LCBjdXRfeSwgMCwgMCkKICAgICAgICBvdXRfaW1nWzpjdXRfeSwgOmN1dF94XSA9IGltZ1t0b3Bfc2hpZnQ6dG9wX3NoaWZ0ICsgY3V0X3ksIGxlZnRfc2hpZnQ6bGVmdF9zaGlmdCArIGN1dF94XQogICAgaWYgaV9taXh1cCA9PSAxOgogICAgICAgIGJib3hlcyA9IGZpbHRlcl90cnV0aChiYm94ZXMsIGN1dF94IC0gcmlnaHRfc2hpZnQsIHRvcF9zaGlmdCwgdyAtIGN1dF94LCBjdXRfeSwgY3V0X3gsIDApCiAgICAgICAgb3V0X2ltZ1s6Y3V0X3ksIGN1dF94Ol0gPSBpbWdbdG9wX3NoaWZ0OnRvcF9zaGlmdCArIGN1dF95LCBjdXRfeCAtIHJpZ2h0X3NoaWZ0OncgLSByaWdodF9zaGlmdF0KICAgIGlmIGlfbWl4dXAgPT0gMjoKICAgICAgICBiYm94ZXMgPSBmaWx0ZXJfdHJ1dGgoYmJveGVzLCBsZWZ0X3NoaWZ0LCBjdXRfeSAtIGJvdF9zaGlmdCwgY3V0X3gsIGggLSBjdXRfeSwgMCwgY3V0X3kpCiAgICAgICAgb3V0X2ltZ1tjdXRfeTosIDpjdXRfeF0gPSBpbWdbY3V0X3kgLSBib3Rfc2hpZnQ6aCAtIGJvdF9zaGlmdCwgbGVmdF9zaGlmdDpsZWZ0X3NoaWZ0ICsgY3V0X3hdCiAgICBpZiBpX21peHVwID09IDM6CiAgICAgICAgYmJveGVzID0gZmlsdGVyX3RydXRoKGJib3hlcywgY3V0X3ggLSByaWdodF9zaGlmdCwgY3V0X3kgLSBib3Rfc2hpZnQsIHcgLSBjdXRfeCwgaCAtIGN1dF95LCBjdXRfeCwgY3V0X3kpCiAgICAgICAgb3V0X2ltZ1tjdXRfeTosIGN1dF94Ol0gPSBpbWdbY3V0X3kgLSBib3Rfc2hpZnQ6aCAtIGJvdF9zaGlmdCwgY3V0X3ggLSByaWdodF9zaGlmdDp3IC0gcmlnaHRfc2hpZnRdCgogICAgcmV0dXJuIG91dF9pbWcsIGJib3hlcwoKCmRlZiBkcmF3X2JveChpbWcsIGJib3hlcyk6CiAgICBmb3IgYiBpbiBiYm94ZXM6CiAgICAgICAgaW1nID0gY3YyLnJlY3RhbmdsZShpbWcsIChiWzBdLCBiWzFdKSwgKGJbMl0sIGJbM10pLCAoMCwgMjU1LCAwKSwgMikKICAgIHJldHVybiBpbWcKCgpjbGFzcyBZb2xvX2RhdGFzZXQoRGF0YXNldCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgbGFiZWxfcGF0aCwgY2ZnLCB0cmFpbj1UcnVlKToKICAgICAgICBzdXBlcihZb2xvX2RhdGFzZXQsIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBpZiBjZmcubWl4dXAgPT0gMjoKICAgICAgICAgICAgcHJpbnQoImN1dG1peD0xIC0gaXNuJ3Qgc3VwcG9ydGVkIGZvciBEZXRlY3RvciIpCiAgICAgICAgICAgIHJhaXNlCiAgICAgICAgZWxpZiBjZmcubWl4dXAgPT0gMiBhbmQgY2ZnLmxldHRlcl9ib3g6CiAgICAgICAgICAgIHByaW50KCJDb21iaW5hdGlvbjogbGV0dGVyX2JveD0xICYgbW9zYWljPTEgLSBpc24ndCBzdXBwb3J0ZWQsIHVzZSBvbmx5IDEgb2YgdGhlc2UgcGFyYW1ldGVycyIpCiAgICAgICAgICAgIHJhaXNlCgogICAgICAgIHNlbGYuY2ZnID0gY2ZnCiAgICAgICAgc2VsZi50cmFpbiA9IHRyYWluCgogICAgICAgIHRydXRoID0ge30KICAgICAgICAjdG9kbyBmaXgKICAgICAgICB0cnk6CiAgICAgICAgICAgIGYgPSBvcGVuKGxhYmVsX3BhdGgsICdyJywgZW5jb2Rpbmc9J3V0Zi04JykKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGYgPSBmaWxlZGlhbG9nLmFza29wZW5maWxlbmFtZShpbml0aWFsZGlyPWxhYmVsX3BhdGgpCiAgICAgICAgICAgIGYgPSBvcGVuKGYsICdyJywgZW5jb2Rpbmc9J3V0Zi04JykKCiAgICAgICAgZm9yIGxpbmUgaW4gZi5yZWFkbGluZXMoKToKICAgICAgICAgICAgZGF0YSA9IGxpbmUuc3BsaXQoIiAiKQogICAgICAgICAgICB0cnV0aFtkYXRhWzBdXSA9IFtdCiAgICAgICAgICAgIGZvciBpIGluIGRhdGFbMTpdOgogICAgICAgICAgICAgICAgdHJ1dGhbZGF0YVswXV0uYXBwZW5kKFtpbnQoZmxvYXQoaikpIGZvciBqIGluIGkuc3BsaXQoJywnKV0pCgogICAgICAgIHNlbGYudHJ1dGggPSB0cnV0aAogICAgICAgIHNlbGYuaW1ncyA9IGxpc3Qoc2VsZi50cnV0aC5rZXlzKCkpCgogICAgZGVmIF9fbGVuX18oc2VsZik6CiAgICAgICAgcmV0dXJuIGxlbihzZWxmLnRydXRoLmtleXMoKSkKCiAgICBkZWYgX19nZXRpdGVtX18oc2VsZiwgaW5kZXgpOgogICAgICAgIGlmIG5vdCBzZWxmLnRyYWluOgogICAgICAgICAgICByZXR1cm4gc2VsZi5fZ2V0X3ZhbF9pdGVtKGluZGV4KQogICAgICAgIGltZ19wYXRoID0gc2VsZi5pbWdzW2luZGV4XQogICAgICAgIGJib3hlcyA9IG5wLmFycmF5KHNlbGYudHJ1dGguZ2V0KGltZ19wYXRoKSwgZHR5cGU9bnAuZmxvYXQpCiAgICAgICAgaW1nX3BhdGggPSBvcy5wYXRoLmpvaW4oc2VsZi5jZmcuZGF0YXNldF9kaXIsIGltZ19wYXRoKQogICAgICAgIHVzZV9taXh1cCA9IHNlbGYuY2ZnLm1peHVwCiAgICAgICAgaWYgcmFuZG9tLnJhbmRpbnQoMCwgMSk6CiAgICAgICAgICAgIHVzZV9taXh1cCA9IDAKCiAgICAgICAgaWYgdXNlX21peHVwID09IDM6CiAgICAgICAgICAgIG1pbl9vZmZzZXQgPSAwLjIKICAgICAgICAgICAgY3V0X3ggPSByYW5kb20ucmFuZGludChpbnQoc2VsZi5jZmcudyAqIG1pbl9vZmZzZXQpLCBpbnQoc2VsZi5jZmcudyAqICgxIC0gbWluX29mZnNldCkpKQogICAgICAgICAgICBjdXRfeSA9IHJhbmRvbS5yYW5kaW50KGludChzZWxmLmNmZy5oICogbWluX29mZnNldCksIGludChzZWxmLmNmZy5oICogKDEgLSBtaW5fb2Zmc2V0KSkpCgogICAgICAgIHIxLCByMiwgcjMsIHI0LCByX3NjYWxlID0gMCwgMCwgMCwgMCwgMAogICAgICAgIGRodWUsIGRzYXQsIGRleHAsIGZsaXAsIGJsdXIgPSAwLCAwLCAwLCAwLCAwCiAgICAgICAgZ2F1c3NpYW5fbm9pc2UgPSAwCgogICAgICAgIG91dF9pbWcgPSBucC56ZXJvcyhbc2VsZi5jZmcuaCwgc2VsZi5jZmcudywgM10pCiAgICAgICAgb3V0X2Jib3hlcyA9IFtdCgogICAgICAgIGZvciBpIGluIHJhbmdlKHVzZV9taXh1cCArIDEpOgogICAgICAgICAgICBpZiBpICE9IDA6CiAgICAgICAgICAgICAgICBpbWdfcGF0aCA9IHJhbmRvbS5jaG9pY2UobGlzdChzZWxmLnRydXRoLmtleXMoKSkpCiAgICAgICAgICAgICAgICBiYm94ZXMgPSBucC5hcnJheShzZWxmLnRydXRoLmdldChpbWdfcGF0aCksIGR0eXBlPW5wLmZsb2F0KQogICAgICAgICAgICAgICAgaW1nX3BhdGggPSBvcy5wYXRoLmpvaW4oc2VsZi5jZmcuZGF0YXNldF9kaXIsIGltZ19wYXRoKQogICAgICAgICAgICBpbWcgPSBjdjIuaW1yZWFkKGltZ19wYXRoKQogICAgICAgICAgICBpbWcgPSBjdjIuY3Z0Q29sb3IoaW1nLCBjdjIuQ09MT1JfQkdSMlJHQikKICAgICAgICAgICAgaWYgaW1nIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBvaCwgb3csIG9jID0gaW1nLnNoYXBlCiAgICAgICAgICAgIGRoLCBkdywgZGMgPSBucC5hcnJheShucC5hcnJheShbb2gsIG93LCBvY10pICogc2VsZi5jZmcuaml0dGVyLCBkdHlwZT1ucC5pbnQpCgogICAgICAgICAgICBkaHVlID0gcmFuZF91bmlmb3JtX3N0cm9uZygtc2VsZi5jZmcuaHVlLCBzZWxmLmNmZy5odWUpCiAgICAgICAgICAgIGRzYXQgPSByYW5kX3NjYWxlKHNlbGYuY2ZnLnNhdHVyYXRpb24pCiAgICAgICAgICAgIGRleHAgPSByYW5kX3NjYWxlKHNlbGYuY2ZnLmV4cG9zdXJlKQoKICAgICAgICAgICAgcGxlZnQgPSByYW5kb20ucmFuZGludCgtZHcsIGR3KQogICAgICAgICAgICBwcmlnaHQgPSByYW5kb20ucmFuZGludCgtZHcsIGR3KQogICAgICAgICAgICBwdG9wID0gcmFuZG9tLnJhbmRpbnQoLWRoLCBkaCkKICAgICAgICAgICAgcGJvdCA9IHJhbmRvbS5yYW5kaW50KC1kaCwgZGgpCgogICAgICAgICAgICBmbGlwID0gcmFuZG9tLnJhbmRpbnQoMCwgMSkgaWYgc2VsZi5jZmcuZmxpcCBlbHNlIDAKCiAgICAgICAgICAgIGlmIChzZWxmLmNmZy5ibHVyKToKICAgICAgICAgICAgICAgIHRtcF9ibHVyID0gcmFuZG9tLnJhbmRpbnQoMCwgMikgICMgMCAtIGRpc2FibGUsIDEgLSBibHVyIGJhY2tncm91bmQsIDIgLSBibHVyIHRoZSB3aG9sZSBpbWFnZQogICAgICAgICAgICAgICAgaWYgdG1wX2JsdXIgPT0gMDoKICAgICAgICAgICAgICAgICAgICBibHVyID0gMAogICAgICAgICAgICAgICAgZWxpZiB0bXBfYmx1ciA9PSAxOgogICAgICAgICAgICAgICAgICAgIGJsdXIgPSAxCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGJsdXIgPSBzZWxmLmNmZy5ibHVyCgogICAgICAgICAgICBpZiBzZWxmLmNmZy5nYXVzc2lhbiBhbmQgcmFuZG9tLnJhbmRpbnQoMCwgMSk6CiAgICAgICAgICAgICAgICBnYXVzc2lhbl9ub2lzZSA9IHNlbGYuY2ZnLmdhdXNzaWFuCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBnYXVzc2lhbl9ub2lzZSA9IDAKCiAgICAgICAgICAgIGlmIHNlbGYuY2ZnLmxldHRlcl9ib3g6CiAgICAgICAgICAgICAgICBpbWdfYXIgPSBvdyAvIG9oCiAgICAgICAgICAgICAgICBuZXRfYXIgPSBzZWxmLmNmZy53IC8gc2VsZi5jZmcuaAogICAgICAgICAgICAgICAgcmVzdWx0X2FyID0gaW1nX2FyIC8gbmV0X2FyCiAgICAgICAgICAgICAgICAjIHByaW50KCIgb3cgPSAlZCwgb2ggPSAlZCwgdyA9ICVkLCBoID0gJWQsIGltZ19hciA9ICVmLCBuZXRfYXIgPSAlZiwgcmVzdWx0X2FyID0gJWYgXG4iLCBvdywgb2gsIHcsIGgsIGltZ19hciwgbmV0X2FyLCByZXN1bHRfYXIpOwogICAgICAgICAgICAgICAgaWYgcmVzdWx0X2FyID4gMTogICMgc2hlaWdodCAtIHNob3VsZCBiZSBpbmNyZWFzZWQKICAgICAgICAgICAgICAgICAgICBvaF90bXAgPSBvdyAvIG5ldF9hcgogICAgICAgICAgICAgICAgICAgIGRlbHRhX2ggPSAob2hfdG1wIC0gb2gpIC8gMgogICAgICAgICAgICAgICAgICAgIHB0b3AgPSBwdG9wIC0gZGVsdGFfaAogICAgICAgICAgICAgICAgICAgIHBib3QgPSBwYm90IC0gZGVsdGFfaAogICAgICAgICAgICAgICAgICAgICMgcHJpbnQoIiByZXN1bHRfYXIgPSAlZiwgb2hfdG1wID0gJWYsIGRlbHRhX2ggPSAlZCwgcHRvcCA9ICVmLCBwYm90ID0gJWYgXG4iLCByZXN1bHRfYXIsIG9oX3RtcCwgZGVsdGFfaCwgcHRvcCwgcGJvdCk7CiAgICAgICAgICAgICAgICBlbHNlOiAgIyBzd2lkdGggLSBzaG91bGQgYmUgaW5jcmVhc2VkCiAgICAgICAgICAgICAgICAgICAgb3dfdG1wID0gb2ggKiBuZXRfYXIKICAgICAgICAgICAgICAgICAgICBkZWx0YV93ID0gKG93X3RtcCAtIG93KSAvIDIKICAgICAgICAgICAgICAgICAgICBwbGVmdCA9IHBsZWZ0IC0gZGVsdGFfdwogICAgICAgICAgICAgICAgICAgIHByaWdodCA9IHByaWdodCAtIGRlbHRhX3cKICAgICAgICAgICAgICAgICAgICAjIHByaW50ZigiIHJlc3VsdF9hciA9ICVmLCBvd190bXAgPSAlZiwgZGVsdGFfdyA9ICVkLCBwbGVmdCA9ICVmLCBwcmlnaHQgPSAlZiBcbiIsIHJlc3VsdF9hciwgb3dfdG1wLCBkZWx0YV93LCBwbGVmdCwgcHJpZ2h0KTsKCiAgICAgICAgICAgIHN3aWR0aCA9IG93IC0gcGxlZnQgLSBwcmlnaHQKICAgICAgICAgICAgc2hlaWdodCA9IG9oIC0gcHRvcCAtIHBib3QKCiAgICAgICAgICAgIHRydXRoLCBtaW5fd19oID0gZmlsbF90cnV0aF9kZXRlY3Rpb24oYmJveGVzLCBzZWxmLmNmZy5ib3hlcywgc2VsZi5jZmcuY2xhc3NlcywgZmxpcCwgcGxlZnQsIHB0b3AsIHN3aWR0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVpZ2h0LCBzZWxmLmNmZy53LCBzZWxmLmNmZy5oKQogICAgICAgICAgICBpZiAobWluX3dfaCAvIDgpIDwgYmx1ciBhbmQgYmx1ciA+IDE6ICAjIGRpc2FibGUgYmx1ciBpZiBvbmUgb2YgdGhlIG9iamVjdHMgaXMgdG9vIHNtYWxsCiAgICAgICAgICAgICAgICBibHVyID0gbWluX3dfaCAvIDgKCiAgICAgICAgICAgIGFpID0gaW1hZ2VfZGF0YV9hdWdtZW50YXRpb24oaW1nLCBzZWxmLmNmZy53LCBzZWxmLmNmZy5oLCBwbGVmdCwgcHRvcCwgc3dpZHRoLCBzaGVpZ2h0LCBmbGlwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRodWUsIGRzYXQsIGRleHAsIGdhdXNzaWFuX25vaXNlLCBibHVyLCB0cnV0aCkKCiAgICAgICAgICAgIGlmIHVzZV9taXh1cCA9PSAwOgogICAgICAgICAgICAgICAgb3V0X2ltZyA9IGFpCiAgICAgICAgICAgICAgICBvdXRfYmJveGVzID0gdHJ1dGgKICAgICAgICAgICAgaWYgdXNlX21peHVwID09IDE6CiAgICAgICAgICAgICAgICBpZiBpID09IDA6CiAgICAgICAgICAgICAgICAgICAgb2xkX2ltZyA9IGFpLmNvcHkoKQogICAgICAgICAgICAgICAgICAgIG9sZF90cnV0aCA9IHRydXRoLmNvcHkoKQogICAgICAgICAgICAgICAgZWxpZiBpID09IDE6CiAgICAgICAgICAgICAgICAgICAgb3V0X2ltZyA9IGN2Mi5hZGRXZWlnaHRlZChhaSwgMC41LCBvbGRfaW1nLCAwLjUpCiAgICAgICAgICAgICAgICAgICAgb3V0X2Jib3hlcyA9IG5wLmNvbmNhdGVuYXRlKFtvbGRfdHJ1dGgsIHRydXRoXSwgYXhpcz0wKQogICAgICAgICAgICBlbGlmIHVzZV9taXh1cCA9PSAzOgogICAgICAgICAgICAgICAgaWYgZmxpcDoKICAgICAgICAgICAgICAgICAgICB0bXAgPSBwbGVmdAogICAgICAgICAgICAgICAgICAgIHBsZWZ0ID0gcHJpZ2h0CiAgICAgICAgICAgICAgICAgICAgcHJpZ2h0ID0gdG1wCgogICAgICAgICAgICAgICAgbGVmdF9zaGlmdCA9IGludChtaW4oY3V0X3gsIG1heCgwLCAoLWludChwbGVmdCkgKiBzZWxmLmNmZy53IC8gc3dpZHRoKSkpKQogICAgICAgICAgICAgICAgdG9wX3NoaWZ0ID0gaW50KG1pbihjdXRfeSwgbWF4KDAsICgtaW50KHB0b3ApICogc2VsZi5jZmcuaCAvIHNoZWlnaHQpKSkpCgogICAgICAgICAgICAgICAgcmlnaHRfc2hpZnQgPSBpbnQobWluKChzZWxmLmNmZy53IC0gY3V0X3gpLCBtYXgoMCwgKC1pbnQocHJpZ2h0KSAqIHNlbGYuY2ZnLncgLyBzd2lkdGgpKSkpCiAgICAgICAgICAgICAgICBib3Rfc2hpZnQgPSBpbnQobWluKHNlbGYuY2ZnLmggLSBjdXRfeSwgbWF4KDAsICgtaW50KHBib3QpICogc2VsZi5jZmcuaCAvIHNoZWlnaHQpKSkpCgogICAgICAgICAgICAgICAgb3V0X2ltZywgb3V0X2Jib3ggPSBibGVuZF90cnV0aF9tb3NhaWMob3V0X2ltZywgYWksIHRydXRoLmNvcHkoKSwgc2VsZi5jZmcudywgc2VsZi5jZmcuaCwgY3V0X3gsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXRfeSwgaSwgbGVmdF9zaGlmdCwgcmlnaHRfc2hpZnQsIHRvcF9zaGlmdCwgYm90X3NoaWZ0KQogICAgICAgICAgICAgICAgb3V0X2Jib3hlcy5hcHBlbmQob3V0X2Jib3gpCiAgICAgICAgICAgICAgICAjIHByaW50KGltZ19wYXRoKQogICAgICAgIGlmIHVzZV9taXh1cCA9PSAzOgogICAgICAgICAgICBvdXRfYmJveGVzID0gbnAuY29uY2F0ZW5hdGUob3V0X2Jib3hlcywgYXhpcz0wKQogICAgICAgIG91dF9iYm94ZXMxID0gbnAuemVyb3MoW3NlbGYuY2ZnLmJveGVzLCA1XSkKICAgICAgICBvdXRfYmJveGVzMVs6bWluKG91dF9iYm94ZXMuc2hhcGVbMF0sIHNlbGYuY2ZnLmJveGVzKV0gPSBvdXRfYmJveGVzWzptaW4ob3V0X2Jib3hlcy5zaGFwZVswXSwgc2VsZi5jZmcuYm94ZXMpXQogICAgICAgIHJldHVybiBvdXRfaW1nLCBvdXRfYmJveGVzMQoKICAgIGRlZiBfZ2V0X3ZhbF9pdGVtKHNlbGYsIGluZGV4KToKICAgICAgICAiIiIKICAgICAgICAiIiIKICAgICAgICBpbWdfcGF0aCA9IHNlbGYuaW1nc1tpbmRleF0KICAgICAgICBiYm94ZXNfd2l0aF9jbHNfaWQgPSBucC5hcnJheShzZWxmLnRydXRoLmdldChpbWdfcGF0aCksIGR0eXBlPW5wLmZsb2F0KQogICAgICAgIGltZyA9IGN2Mi5pbXJlYWQob3MucGF0aC5qb2luKHNlbGYuY2ZnLmRhdGFzZXRfZGlyLCBpbWdfcGF0aCkpCiAgICAgICAgIyBpbWdfaGVpZ2h0LCBpbWdfd2lkdGggPSBpbWcuc2hhcGVbOjJdCiAgICAgICAgaW1nID0gY3YyLmN2dENvbG9yKGltZywgY3YyLkNPTE9SX0JHUjJSR0IpCiAgICAgICAgIyBpbWcgPSBjdjIucmVzaXplKGltZywgKHNlbGYuY2ZnLncsIHNlbGYuY2ZnLmgpKQogICAgICAgICMgaW1nID0gdG9yY2guZnJvbV9udW1weShpbWcudHJhbnNwb3NlKDIsIDAsIDEpKS5mbG9hdCgpLmRpdigyNTUuMCkudW5zcXVlZXplKDApCiAgICAgICAgbnVtX29ianMgPSBsZW4oYmJveGVzX3dpdGhfY2xzX2lkKQogICAgICAgIHRhcmdldCA9IHt9CiAgICAgICAgIyBib3hlcyB0byBjb2NvIGZvcm1hdAogICAgICAgIGJveGVzID0gYmJveGVzX3dpdGhfY2xzX2lkWy4uLiw6NF0KICAgICAgICBib3hlc1suLi4sIDI6XSA9IGJveGVzWy4uLiwgMjpdIC0gYm94ZXNbLi4uLCA6Ml0gICMgYm94IHdpZHRoLCBib3ggaGVpZ2h0CiAgICAgICAgdGFyZ2V0Wydib3hlcyddID0gdG9yY2guYXNfdGVuc29yKGJveGVzLCBkdHlwZT10b3JjaC5mbG9hdDMyKQogICAgICAgIHRhcmdldFsnbGFiZWxzJ10gPSB0b3JjaC5hc190ZW5zb3IoYmJveGVzX3dpdGhfY2xzX2lkWy4uLiwtMV0uZmxhdHRlbigpLCBkdHlwZT10b3JjaC5pbnQ2NCkKICAgICAgICB0YXJnZXRbJ2ltYWdlX2lkJ10gPSB0b3JjaC50ZW5zb3IoW2dldF9pbWFnZV9pZChpbWdfcGF0aCldKQogICAgICAgIHRhcmdldFsnYXJlYSddID0gKHRhcmdldFsnYm94ZXMnXVs6LDNdKSoodGFyZ2V0Wydib3hlcyddWzosMl0pCiAgICAgICAgdGFyZ2V0Wydpc2Nyb3dkJ10gPSB0b3JjaC56ZXJvcygobnVtX29ianMsKSwgZHR5cGU9dG9yY2guaW50NjQpCiAgICAgICAgcmV0dXJuIGltZywgdGFyZ2V0CgoKZGVmIGdldF9pbWFnZV9pZChmaWxlbmFtZTpzdHIpIC0+IGludDoKICAgICIiIgogICAgQ29udmVydCBhIHN0cmluZyB0byBhIGludGVnZXIuCiAgICBNYWtlIHN1cmUgdGhhdCB0aGUgaW1hZ2VzIGFuZCB0aGUgYGltYWdlX2lkYHMgYXJlIGluIG9uZS1vbmUgY29ycmVzcG9uZGVuY2UuCiAgICBUaGVyZSBhcmUgYWxyZWFkeSBgaW1hZ2VfaWRgcyBpbiBhbm5vdGF0aW9ucyBvZiB0aGUgQ09DTyBkYXRhc2V0LAogICAgaW4gd2hpY2ggY2FzZSB0aGlzIGZ1bmN0aW9uIGlzIHVubmVjZXNzYXJ5LgogICAgRm9yIGNyZWF0aW5nIG9uZSdzIG93biBgZ2V0X2ltYWdlX2lkYCBmdW5jdGlvbiwgb25lIGNhbiByZWZlciB0bwogICAgaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9hdXRvbWwvYmxvYi9tYXN0ZXIvZWZmaWNpZW50ZGV0L2RhdGFzZXQvY3JlYXRlX3Bhc2NhbF90ZnJlY29yZC5weSNMODYKICAgIG9yIHJlZmVyIHRvIHRoZSBmb2xsb3dpbmcgY29kZSAod2hlcmUgdGhlIGZpbGVuYW1lcyBhcmUgbGlrZSAnbGV2ZWwxXzEyMy5qcGcnKQogICAgPj4+IGx2LCBubyA9IG9zLnBhdGguc3BsaXRleHQob3MucGF0aC5iYXNlbmFtZShmaWxlbmFtZSkpWzBdLnNwbGl0KCJfIikKICAgID4+PiBsdiA9IGx2LnJlcGxhY2UoImxldmVsIiwgIiIpCiAgICA+Pj4gbm8gPSBmIntpbnQobm8pOjA0ZH0iCiAgICA+Pj4gcmV0dXJuIGludChsditubykKICAgICIiIgogICAgcmV0dXJuIGludChyZS5zZWFyY2goIlswLTldKyIsIGZpbGVuYW1lKS5ncm91cCgwKSkKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgZnJvbSBjZmcgaW1wb3J0IENmZwogICAgaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAoKICAgIHJhbmRvbS5zZWVkKDIwMjApCiAgICBucC5yYW5kb20uc2VlZCgyMDIwKQogICAgQ2ZnLmRhdGFzZXRfZGlyID0gJy9tbnQvZS9EYXRhc2V0JwogICAgZGF0YXNldCA9IFlvbG9fZGF0YXNldChDZmcudHJhaW5fbGFiZWwsIENmZykKICAgIGZvciBpIGluIHJhbmdlKDEwMCk6CiAgICAgICAgb3V0X2ltZywgb3V0X2Jib3hlcyA9IGRhdGFzZXQuX19nZXRpdGVtX18oaSkKICAgICAgICBhID0gZHJhd19ib3gob3V0X2ltZy5jb3B5KCksIG91dF9iYm94ZXMuYXN0eXBlKG5wLmludDMyKSkKICAgICAgICBwbHQuaW1zaG93KGEuYXN0eXBlKG5wLmludDMyKSkKICAgICAgICBwbHQuc2hvdygpCg==')
    file.write(dataset_string)

with open(root + "YOLOv4" + "/models.py", "wb") as file:
    models_string = base64.b64decode(b'ZnJvbSBQSUwgaW1wb3J0IEltYWdlCmltcG9ydCB0b3JjaApmcm9tIHRvcmNoIGltcG9ydCBubgppbXBvcnQgdG9yY2gubm4uZnVuY3Rpb25hbCBhcyBGCiN0b2RvIGZpeAp0cnk6CiAgICBmcm9tIHRvb2wudG9yY2hfdXRpbHMgaW1wb3J0ICoKICAgIGZyb20gdG9vbC55b2xvX2xheWVyIGltcG9ydCBZb2xvTGF5ZXIKZXhjZXB0IEltcG9ydEVycm9yOgogICAgZnJvbSBZT0xPdjQudG9vbC50b3JjaF91dGlscyBpbXBvcnQgKgogICAgZnJvbSBZT0xPdjQudG9vbC55b2xvX2xheWVyIGltcG9ydCBZb2xvTGF5ZXIKCmltcG9ydCBnYwoKCmNsYXNzIE1pc2godG9yY2gubm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKCiAgICBkZWYgZm9yd2FyZChzZWxmLCB4KToKICAgICAgICB4ID0geCAqICh0b3JjaC50YW5oKHRvcmNoLm5uLmZ1bmN0aW9uYWwuc29mdHBsdXMoeCkpKQogICAgICAgIHJldHVybiB4CgoKY2xhc3MgVXBzYW1wbGUobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcihVcHNhbXBsZSwgc2VsZikuX19pbml0X18oKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgsIHRhcmdldF9zaXplLCBpbmZlcmVuY2U9RmFsc2UpOgogICAgICAgIGFzc2VydCAoeC5kYXRhLmRpbSgpID09IDQpCiAgICAgICAgIyBfLCBfLCB0SCwgdFcgPSB0YXJnZXRfc2l6ZQoKICAgICAgICBpZiBpbmZlcmVuY2U6CgogICAgICAgICAgICAjQiA9IHguZGF0YS5zaXplKDApCiAgICAgICAgICAgICNDID0geC5kYXRhLnNpemUoMSkKICAgICAgICAgICAgI0ggPSB4LmRhdGEuc2l6ZSgyKQogICAgICAgICAgICAjVyA9IHguZGF0YS5zaXplKDMpCgogICAgICAgICAgICByZXR1cm4geC52aWV3KHguc2l6ZSgwKSwgeC5zaXplKDEpLCB4LnNpemUoMiksIDEsIHguc2l6ZSgzKSwgMSkuXAogICAgICAgICAgICAgICAgICAgIGV4cGFuZCh4LnNpemUoMCksIHguc2l6ZSgxKSwgeC5zaXplKDIpLCB0YXJnZXRfc2l6ZVsyXSAvLyB4LnNpemUoMiksIHguc2l6ZSgzKSwgdGFyZ2V0X3NpemVbM10gLy8geC5zaXplKDMpKS5cCiAgICAgICAgICAgICAgICAgICAgY29udGlndW91cygpLnZpZXcoeC5zaXplKDApLCB4LnNpemUoMSksIHRhcmdldF9zaXplWzJdLCB0YXJnZXRfc2l6ZVszXSkKICAgICAgICBlbHNlOgogICAgICAgICAgICByZXR1cm4gRi5pbnRlcnBvbGF0ZSh4LCBzaXplPSh0YXJnZXRfc2l6ZVsyXSwgdGFyZ2V0X3NpemVbM10pLCBtb2RlPSduZWFyZXN0JykKCgpjbGFzcyBDb252X0JuX0FjdGl2YXRpb24obm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpbl9jaGFubmVscywgb3V0X2NoYW5uZWxzLCBrZXJuZWxfc2l6ZSwgc3RyaWRlLCBhY3RpdmF0aW9uLCBibj1UcnVlLCBiaWFzPUZhbHNlKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBwYWQgPSAoa2VybmVsX3NpemUgLSAxKSAvLyAyCgogICAgICAgIHNlbGYuY29udiA9IG5uLk1vZHVsZUxpc3QoKQogICAgICAgIGlmIGJpYXM6CiAgICAgICAgICAgIHNlbGYuY29udi5hcHBlbmQobm4uQ29udjJkKGluX2NoYW5uZWxzLCBvdXRfY2hhbm5lbHMsIGtlcm5lbF9zaXplLCBzdHJpZGUsIHBhZCkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5jb252LmFwcGVuZChubi5Db252MmQoaW5fY2hhbm5lbHMsIG91dF9jaGFubmVscywga2VybmVsX3NpemUsIHN0cmlkZSwgcGFkLCBiaWFzPUZhbHNlKSkKICAgICAgICBpZiBibjoKICAgICAgICAgICAgc2VsZi5jb252LmFwcGVuZChubi5CYXRjaE5vcm0yZChvdXRfY2hhbm5lbHMpKQogICAgICAgIGlmIGFjdGl2YXRpb24gPT0gIm1pc2giOgogICAgICAgICAgICBzZWxmLmNvbnYuYXBwZW5kKE1pc2goKSkKICAgICAgICBlbGlmIGFjdGl2YXRpb24gPT0gInJlbHUiOgogICAgICAgICAgICBzZWxmLmNvbnYuYXBwZW5kKG5uLlJlTFUoaW5wbGFjZT1UcnVlKSkKICAgICAgICBlbGlmIGFjdGl2YXRpb24gPT0gImxlYWt5IjoKICAgICAgICAgICAgc2VsZi5jb252LmFwcGVuZChubi5MZWFreVJlTFUoMC4xLCBpbnBsYWNlPVRydWUpKQogICAgICAgIGVsaWYgYWN0aXZhdGlvbiA9PSAibGluZWFyIjoKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCJhY3RpdmF0ZSBlcnJvciAhISEge30ge30ge30iLmZvcm1hdChzeXMuX2dldGZyYW1lKCkuZl9jb2RlLmNvX2ZpbGVuYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzLl9nZXRmcmFtZSgpLmZfY29kZS5jb19uYW1lLCBzeXMuX2dldGZyYW1lKCkuZl9saW5lbm8pKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIGZvciBsIGluIHNlbGYuY29udjoKICAgICAgICAgICAgeCA9IGwoeCkKICAgICAgICByZXR1cm4geAoKCmNsYXNzIFJlc0Jsb2NrKG5uLk1vZHVsZSk6CiAgICAiIiIKICAgIFNlcXVlbnRpYWwgcmVzaWR1YWwgYmxvY2tzIGVhY2ggb2Ygd2hpY2ggY29uc2lzdHMgb2YgXAogICAgdHdvIGNvbnZvbHV0aW9uIGxheWVycy4KICAgIEFyZ3M6CiAgICAgICAgY2ggKGludCk6IG51bWJlciBvZiBpbnB1dCBhbmQgb3V0cHV0IGNoYW5uZWxzLgogICAgICAgIG5ibG9ja3MgKGludCk6IG51bWJlciBvZiByZXNpZHVhbCBibG9ja3MuCiAgICAgICAgc2hvcnRjdXQgKGJvb2wpOiBpZiBUcnVlLCByZXNpZHVhbCB0ZW5zb3IgYWRkaXRpb24gaXMgZW5hYmxlZC4KICAgICIiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjaCwgbmJsb2Nrcz0xLCBzaG9ydGN1dD1UcnVlKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnNob3J0Y3V0ID0gc2hvcnRjdXQKICAgICAgICBzZWxmLm1vZHVsZV9saXN0ID0gbm4uTW9kdWxlTGlzdCgpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UobmJsb2Nrcyk6CiAgICAgICAgICAgIHJlc2Jsb2NrX29uZSA9IG5uLk1vZHVsZUxpc3QoKQogICAgICAgICAgICByZXNibG9ja19vbmUuYXBwZW5kKENvbnZfQm5fQWN0aXZhdGlvbihjaCwgY2gsIDEsIDEsICdtaXNoJykpCiAgICAgICAgICAgIHJlc2Jsb2NrX29uZS5hcHBlbmQoQ29udl9Cbl9BY3RpdmF0aW9uKGNoLCBjaCwgMywgMSwgJ21pc2gnKSkKICAgICAgICAgICAgc2VsZi5tb2R1bGVfbGlzdC5hcHBlbmQocmVzYmxvY2tfb25lKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIGZvciBtb2R1bGUgaW4gc2VsZi5tb2R1bGVfbGlzdDoKICAgICAgICAgICAgaCA9IHgKICAgICAgICAgICAgZm9yIHJlcyBpbiBtb2R1bGU6CiAgICAgICAgICAgICAgICBoID0gcmVzKGgpCiAgICAgICAgICAgIHggPSB4ICsgaCBpZiBzZWxmLnNob3J0Y3V0IGVsc2UgaAogICAgICAgIHJldHVybiB4CgoKY2xhc3MgRG93blNhbXBsZTEobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmNvbnYxID0gQ29udl9Cbl9BY3RpdmF0aW9uKDMsIDMyLCAzLCAxLCAnbWlzaCcpCgogICAgICAgIHNlbGYuY29udjIgPSBDb252X0JuX0FjdGl2YXRpb24oMzIsIDY0LCAzLCAyLCAnbWlzaCcpCiAgICAgICAgc2VsZi5jb252MyA9IENvbnZfQm5fQWN0aXZhdGlvbig2NCwgNjQsIDEsIDEsICdtaXNoJykKICAgICAgICAjIFtyb3V0ZV0KICAgICAgICAjIGxheWVycyA9IC0yCiAgICAgICAgc2VsZi5jb252NCA9IENvbnZfQm5fQWN0aXZhdGlvbig2NCwgNjQsIDEsIDEsICdtaXNoJykKCiAgICAgICAgc2VsZi5jb252NSA9IENvbnZfQm5fQWN0aXZhdGlvbig2NCwgMzIsIDEsIDEsICdtaXNoJykKICAgICAgICBzZWxmLmNvbnY2ID0gQ29udl9Cbl9BY3RpdmF0aW9uKDMyLCA2NCwgMywgMSwgJ21pc2gnKQogICAgICAgICMgW3Nob3J0Y3V0XQogICAgICAgICMgZnJvbT0tMwogICAgICAgICMgYWN0aXZhdGlvbiA9IGxpbmVhcgoKICAgICAgICBzZWxmLmNvbnY3ID0gQ29udl9Cbl9BY3RpdmF0aW9uKDY0LCA2NCwgMSwgMSwgJ21pc2gnKQogICAgICAgICMgW3JvdXRlXQogICAgICAgICMgbGF5ZXJzID0gLTEsIC03CiAgICAgICAgc2VsZi5jb252OCA9IENvbnZfQm5fQWN0aXZhdGlvbigxMjgsIDY0LCAxLCAxLCAnbWlzaCcpCgogICAgZGVmIGZvcndhcmQoc2VsZiwgaW5wdXQpOgogICAgICAgIHgxID0gc2VsZi5jb252MShpbnB1dCkKICAgICAgICB4MiA9IHNlbGYuY29udjIoeDEpCiAgICAgICAgeDMgPSBzZWxmLmNvbnYzKHgyKQogICAgICAgICMgcm91dGUgLTIKICAgICAgICB4NCA9IHNlbGYuY29udjQoeDIpCiAgICAgICAgeDUgPSBzZWxmLmNvbnY1KHg0KQogICAgICAgIHg2ID0gc2VsZi5jb252Nih4NSkKICAgICAgICAjIHNob3J0Y3V0IC0zCiAgICAgICAgeDYgPSB4NiArIHg0CgogICAgICAgIHg3ID0gc2VsZi5jb252Nyh4NikKICAgICAgICAjIFtyb3V0ZV0KICAgICAgICAjIGxheWVycyA9IC0xLCAtNwogICAgICAgIHg3ID0gdG9yY2guY2F0KFt4NywgeDNdLCBkaW09MSkKICAgICAgICB4OCA9IHNlbGYuY29udjgoeDcpCiAgICAgICAgcmV0dXJuIHg4CgoKY2xhc3MgRG93blNhbXBsZTIobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmNvbnYxID0gQ29udl9Cbl9BY3RpdmF0aW9uKDY0LCAxMjgsIDMsIDIsICdtaXNoJykKICAgICAgICBzZWxmLmNvbnYyID0gQ29udl9Cbl9BY3RpdmF0aW9uKDEyOCwgNjQsIDEsIDEsICdtaXNoJykKICAgICAgICAjIHIgLTIKICAgICAgICBzZWxmLmNvbnYzID0gQ29udl9Cbl9BY3RpdmF0aW9uKDEyOCwgNjQsIDEsIDEsICdtaXNoJykKCiAgICAgICAgc2VsZi5yZXNibG9jayA9IFJlc0Jsb2NrKGNoPTY0LCBuYmxvY2tzPTIpCgogICAgICAgICMgcyAtMwogICAgICAgIHNlbGYuY29udjQgPSBDb252X0JuX0FjdGl2YXRpb24oNjQsIDY0LCAxLCAxLCAnbWlzaCcpCiAgICAgICAgIyByIC0xIC0xMAogICAgICAgIHNlbGYuY29udjUgPSBDb252X0JuX0FjdGl2YXRpb24oMTI4LCAxMjgsIDEsIDEsICdtaXNoJykKCiAgICBkZWYgZm9yd2FyZChzZWxmLCBpbnB1dCk6CiAgICAgICAgeDEgPSBzZWxmLmNvbnYxKGlucHV0KQogICAgICAgIHgyID0gc2VsZi5jb252Mih4MSkKICAgICAgICB4MyA9IHNlbGYuY29udjMoeDEpCgogICAgICAgIHIgPSBzZWxmLnJlc2Jsb2NrKHgzKQogICAgICAgIHg0ID0gc2VsZi5jb252NChyKQoKICAgICAgICB4NCA9IHRvcmNoLmNhdChbeDQsIHgyXSwgZGltPTEpCiAgICAgICAgeDUgPSBzZWxmLmNvbnY1KHg0KQogICAgICAgIHJldHVybiB4NQoKCmNsYXNzIERvd25TYW1wbGUzKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5jb252MSA9IENvbnZfQm5fQWN0aXZhdGlvbigxMjgsIDI1NiwgMywgMiwgJ21pc2gnKQogICAgICAgIHNlbGYuY29udjIgPSBDb252X0JuX0FjdGl2YXRpb24oMjU2LCAxMjgsIDEsIDEsICdtaXNoJykKICAgICAgICBzZWxmLmNvbnYzID0gQ29udl9Cbl9BY3RpdmF0aW9uKDI1NiwgMTI4LCAxLCAxLCAnbWlzaCcpCgogICAgICAgIHNlbGYucmVzYmxvY2sgPSBSZXNCbG9jayhjaD0xMjgsIG5ibG9ja3M9OCkKICAgICAgICBzZWxmLmNvbnY0ID0gQ29udl9Cbl9BY3RpdmF0aW9uKDEyOCwgMTI4LCAxLCAxLCAnbWlzaCcpCiAgICAgICAgc2VsZi5jb252NSA9IENvbnZfQm5fQWN0aXZhdGlvbigyNTYsIDI1NiwgMSwgMSwgJ21pc2gnKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIGlucHV0KToKICAgICAgICB4MSA9IHNlbGYuY29udjEoaW5wdXQpCiAgICAgICAgeDIgPSBzZWxmLmNvbnYyKHgxKQogICAgICAgIHgzID0gc2VsZi5jb252Myh4MSkKCiAgICAgICAgciA9IHNlbGYucmVzYmxvY2soeDMpCiAgICAgICAgeDQgPSBzZWxmLmNvbnY0KHIpCgogICAgICAgIHg0ID0gdG9yY2guY2F0KFt4NCwgeDJdLCBkaW09MSkKICAgICAgICB4NSA9IHNlbGYuY29udjUoeDQpCiAgICAgICAgcmV0dXJuIHg1CgoKY2xhc3MgRG93blNhbXBsZTQobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmNvbnYxID0gQ29udl9Cbl9BY3RpdmF0aW9uKDI1NiwgNTEyLCAzLCAyLCAnbWlzaCcpCiAgICAgICAgc2VsZi5jb252MiA9IENvbnZfQm5fQWN0aXZhdGlvbig1MTIsIDI1NiwgMSwgMSwgJ21pc2gnKQogICAgICAgIHNlbGYuY29udjMgPSBDb252X0JuX0FjdGl2YXRpb24oNTEyLCAyNTYsIDEsIDEsICdtaXNoJykKCiAgICAgICAgc2VsZi5yZXNibG9jayA9IFJlc0Jsb2NrKGNoPTI1NiwgbmJsb2Nrcz04KQogICAgICAgIHNlbGYuY29udjQgPSBDb252X0JuX0FjdGl2YXRpb24oMjU2LCAyNTYsIDEsIDEsICdtaXNoJykKICAgICAgICBzZWxmLmNvbnY1ID0gQ29udl9Cbl9BY3RpdmF0aW9uKDUxMiwgNTEyLCAxLCAxLCAnbWlzaCcpCgogICAgZGVmIGZvcndhcmQoc2VsZiwgaW5wdXQpOgogICAgICAgIHgxID0gc2VsZi5jb252MShpbnB1dCkKICAgICAgICB4MiA9IHNlbGYuY29udjIoeDEpCiAgICAgICAgeDMgPSBzZWxmLmNvbnYzKHgxKQoKICAgICAgICByID0gc2VsZi5yZXNibG9jayh4MykKICAgICAgICB4NCA9IHNlbGYuY29udjQocikKCiAgICAgICAgeDQgPSB0b3JjaC5jYXQoW3g0LCB4Ml0sIGRpbT0xKQogICAgICAgIHg1ID0gc2VsZi5jb252NSh4NCkKICAgICAgICByZXR1cm4geDUKCgpjbGFzcyBEb3duU2FtcGxlNShubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuY29udjEgPSBDb252X0JuX0FjdGl2YXRpb24oNTEyLCAxMDI0LCAzLCAyLCAnbWlzaCcpCiAgICAgICAgc2VsZi5jb252MiA9IENvbnZfQm5fQWN0aXZhdGlvbigxMDI0LCA1MTIsIDEsIDEsICdtaXNoJykKICAgICAgICBzZWxmLmNvbnYzID0gQ29udl9Cbl9BY3RpdmF0aW9uKDEwMjQsIDUxMiwgMSwgMSwgJ21pc2gnKQoKICAgICAgICBzZWxmLnJlc2Jsb2NrID0gUmVzQmxvY2soY2g9NTEyLCBuYmxvY2tzPTQpCiAgICAgICAgc2VsZi5jb252NCA9IENvbnZfQm5fQWN0aXZhdGlvbig1MTIsIDUxMiwgMSwgMSwgJ21pc2gnKQogICAgICAgIHNlbGYuY29udjUgPSBDb252X0JuX0FjdGl2YXRpb24oMTAyNCwgMTAyNCwgMSwgMSwgJ21pc2gnKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIGlucHV0KToKICAgICAgICB4MSA9IHNlbGYuY29udjEoaW5wdXQpCiAgICAgICAgeDIgPSBzZWxmLmNvbnYyKHgxKQogICAgICAgIHgzID0gc2VsZi5jb252Myh4MSkKCiAgICAgICAgciA9IHNlbGYucmVzYmxvY2soeDMpCiAgICAgICAgeDQgPSBzZWxmLmNvbnY0KHIpCgogICAgICAgIHg0ID0gdG9yY2guY2F0KFt4NCwgeDJdLCBkaW09MSkKICAgICAgICB4NSA9IHNlbGYuY29udjUoeDQpCiAgICAgICAgcmV0dXJuIHg1CgoKY2xhc3MgTmVjayhubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGluZmVyZW5jZT1GYWxzZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5pbmZlcmVuY2UgPSBpbmZlcmVuY2UKCiAgICAgICAgc2VsZi5jb252MSA9IENvbnZfQm5fQWN0aXZhdGlvbigxMDI0LCA1MTIsIDEsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MiA9IENvbnZfQm5fQWN0aXZhdGlvbig1MTIsIDEwMjQsIDMsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MyA9IENvbnZfQm5fQWN0aXZhdGlvbigxMDI0LCA1MTIsIDEsIDEsICdsZWFreScpCiAgICAgICAgIyBTUFAKICAgICAgICBzZWxmLm1heHBvb2wxID0gbm4uTWF4UG9vbDJkKGtlcm5lbF9zaXplPTUsIHN0cmlkZT0xLCBwYWRkaW5nPTUgLy8gMikKICAgICAgICBzZWxmLm1heHBvb2wyID0gbm4uTWF4UG9vbDJkKGtlcm5lbF9zaXplPTksIHN0cmlkZT0xLCBwYWRkaW5nPTkgLy8gMikKICAgICAgICBzZWxmLm1heHBvb2wzID0gbm4uTWF4UG9vbDJkKGtlcm5lbF9zaXplPTEzLCBzdHJpZGU9MSwgcGFkZGluZz0xMyAvLyAyKQoKICAgICAgICAjIFIgLTEgLTMgLTUgLTYKICAgICAgICAjIFNQUAogICAgICAgIHNlbGYuY29udjQgPSBDb252X0JuX0FjdGl2YXRpb24oMjA0OCwgNTEyLCAxLCAxLCAnbGVha3knKQogICAgICAgIHNlbGYuY29udjUgPSBDb252X0JuX0FjdGl2YXRpb24oNTEyLCAxMDI0LCAzLCAxLCAnbGVha3knKQogICAgICAgIHNlbGYuY29udjYgPSBDb252X0JuX0FjdGl2YXRpb24oMTAyNCwgNTEyLCAxLCAxLCAnbGVha3knKQogICAgICAgIHNlbGYuY29udjcgPSBDb252X0JuX0FjdGl2YXRpb24oNTEyLCAyNTYsIDEsIDEsICdsZWFreScpCiAgICAgICAgIyBVUAogICAgICAgIHNlbGYudXBzYW1wbGUxID0gVXBzYW1wbGUoKQogICAgICAgICMgUiA4NQogICAgICAgIHNlbGYuY29udjggPSBDb252X0JuX0FjdGl2YXRpb24oNTEyLCAyNTYsIDEsIDEsICdsZWFreScpCiAgICAgICAgIyBSIC0xIC0zCiAgICAgICAgc2VsZi5jb252OSA9IENvbnZfQm5fQWN0aXZhdGlvbig1MTIsIDI1NiwgMSwgMSwgJ2xlYWt5JykKICAgICAgICBzZWxmLmNvbnYxMCA9IENvbnZfQm5fQWN0aXZhdGlvbigyNTYsIDUxMiwgMywgMSwgJ2xlYWt5JykKICAgICAgICBzZWxmLmNvbnYxMSA9IENvbnZfQm5fQWN0aXZhdGlvbig1MTIsIDI1NiwgMSwgMSwgJ2xlYWt5JykKICAgICAgICBzZWxmLmNvbnYxMiA9IENvbnZfQm5fQWN0aXZhdGlvbigyNTYsIDUxMiwgMywgMSwgJ2xlYWt5JykKICAgICAgICBzZWxmLmNvbnYxMyA9IENvbnZfQm5fQWN0aXZhdGlvbig1MTIsIDI1NiwgMSwgMSwgJ2xlYWt5JykKICAgICAgICBzZWxmLmNvbnYxNCA9IENvbnZfQm5fQWN0aXZhdGlvbigyNTYsIDEyOCwgMSwgMSwgJ2xlYWt5JykKICAgICAgICAjIFVQCiAgICAgICAgc2VsZi51cHNhbXBsZTIgPSBVcHNhbXBsZSgpCiAgICAgICAgIyBSIDU0CiAgICAgICAgc2VsZi5jb252MTUgPSBDb252X0JuX0FjdGl2YXRpb24oMjU2LCAxMjgsIDEsIDEsICdsZWFreScpCiAgICAgICAgIyBSIC0xIC0zCiAgICAgICAgc2VsZi5jb252MTYgPSBDb252X0JuX0FjdGl2YXRpb24oMjU2LCAxMjgsIDEsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MTcgPSBDb252X0JuX0FjdGl2YXRpb24oMTI4LCAyNTYsIDMsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MTggPSBDb252X0JuX0FjdGl2YXRpb24oMjU2LCAxMjgsIDEsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MTkgPSBDb252X0JuX0FjdGl2YXRpb24oMTI4LCAyNTYsIDMsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MjAgPSBDb252X0JuX0FjdGl2YXRpb24oMjU2LCAxMjgsIDEsIDEsICdsZWFreScpCgogICAgZGVmIGZvcndhcmQoc2VsZiwgaW5wdXQsIGRvd25zYW1wbGU0LCBkb3duc2FtcGxlMywgaW5mZXJlbmNlPUZhbHNlKToKICAgICAgICB4MSA9IHNlbGYuY29udjEoaW5wdXQpCiAgICAgICAgeDIgPSBzZWxmLmNvbnYyKHgxKQogICAgICAgIHgzID0gc2VsZi5jb252Myh4MikKICAgICAgICAjIFNQUAogICAgICAgIG0xID0gc2VsZi5tYXhwb29sMSh4MykKICAgICAgICBtMiA9IHNlbGYubWF4cG9vbDIoeDMpCiAgICAgICAgbTMgPSBzZWxmLm1heHBvb2wzKHgzKQogICAgICAgIHNwcCA9IHRvcmNoLmNhdChbbTMsIG0yLCBtMSwgeDNdLCBkaW09MSkKICAgICAgICAjIFNQUCBlbmQKICAgICAgICB4NCA9IHNlbGYuY29udjQoc3BwKQogICAgICAgIHg1ID0gc2VsZi5jb252NSh4NCkKICAgICAgICB4NiA9IHNlbGYuY29udjYoeDUpCiAgICAgICAgeDcgPSBzZWxmLmNvbnY3KHg2KQogICAgICAgICMgVVAKICAgICAgICB1cCA9IHNlbGYudXBzYW1wbGUxKHg3LCBkb3duc2FtcGxlNC5zaXplKCksIHNlbGYuaW5mZXJlbmNlKQogICAgICAgICMgUiA4NQogICAgICAgIHg4ID0gc2VsZi5jb252OChkb3duc2FtcGxlNCkKICAgICAgICAjIFIgLTEgLTMKICAgICAgICB4OCA9IHRvcmNoLmNhdChbeDgsIHVwXSwgZGltPTEpCgogICAgICAgIHg5ID0gc2VsZi5jb252OSh4OCkKICAgICAgICB4MTAgPSBzZWxmLmNvbnYxMCh4OSkKICAgICAgICB4MTEgPSBzZWxmLmNvbnYxMSh4MTApCiAgICAgICAgeDEyID0gc2VsZi5jb252MTIoeDExKQogICAgICAgIHgxMyA9IHNlbGYuY29udjEzKHgxMikKICAgICAgICB4MTQgPSBzZWxmLmNvbnYxNCh4MTMpCgogICAgICAgICMgVVAKICAgICAgICB1cCA9IHNlbGYudXBzYW1wbGUyKHgxNCwgZG93bnNhbXBsZTMuc2l6ZSgpLCBzZWxmLmluZmVyZW5jZSkKICAgICAgICAjIFIgNTQKICAgICAgICB4MTUgPSBzZWxmLmNvbnYxNShkb3duc2FtcGxlMykKICAgICAgICAjIFIgLTEgLTMKICAgICAgICB4MTUgPSB0b3JjaC5jYXQoW3gxNSwgdXBdLCBkaW09MSkKCiAgICAgICAgeDE2ID0gc2VsZi5jb252MTYoeDE1KQogICAgICAgIHgxNyA9IHNlbGYuY29udjE3KHgxNikKICAgICAgICB4MTggPSBzZWxmLmNvbnYxOCh4MTcpCiAgICAgICAgeDE5ID0gc2VsZi5jb252MTkoeDE4KQogICAgICAgIHgyMCA9IHNlbGYuY29udjIwKHgxOSkKICAgICAgICByZXR1cm4geDIwLCB4MTMsIHg2CgoKY2xhc3MgWW9sb3Y0SGVhZChubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG91dHB1dF9jaCwgbl9jbGFzc2VzLCBpbmZlcmVuY2U9RmFsc2UpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oKQogICAgICAgIHNlbGYuaW5mZXJlbmNlID0gaW5mZXJlbmNlCgogICAgICAgIHNlbGYuY29udjEgPSBDb252X0JuX0FjdGl2YXRpb24oMTI4LCAyNTYsIDMsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MiA9IENvbnZfQm5fQWN0aXZhdGlvbigyNTYsIG91dHB1dF9jaCwgMSwgMSwgJ2xpbmVhcicsIGJuPUZhbHNlLCBiaWFzPVRydWUpCgogICAgICAgIHNlbGYueW9sbzEgPSBZb2xvTGF5ZXIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yX21hc2s9WzAsIDEsIDJdLCBudW1fY2xhc3Nlcz1uX2NsYXNzZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9ycz1bMTIsIDE2LCAxOSwgMzYsIDQwLCAyOCwgMzYsIDc1LCA3NiwgNTUsIDcyLCAxNDYsIDE0MiwgMTEwLCAxOTIsIDI0MywgNDU5LCA0MDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bV9hbmNob3JzPTksIHN0cmlkZT04KQoKICAgICAgICAjIFIgLTQKICAgICAgICBzZWxmLmNvbnYzID0gQ29udl9Cbl9BY3RpdmF0aW9uKDEyOCwgMjU2LCAzLCAyLCAnbGVha3knKQoKICAgICAgICAjIFIgLTEgLTE2CiAgICAgICAgc2VsZi5jb252NCA9IENvbnZfQm5fQWN0aXZhdGlvbig1MTIsIDI1NiwgMSwgMSwgJ2xlYWt5JykKICAgICAgICBzZWxmLmNvbnY1ID0gQ29udl9Cbl9BY3RpdmF0aW9uKDI1NiwgNTEyLCAzLCAxLCAnbGVha3knKQogICAgICAgIHNlbGYuY29udjYgPSBDb252X0JuX0FjdGl2YXRpb24oNTEyLCAyNTYsIDEsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252NyA9IENvbnZfQm5fQWN0aXZhdGlvbigyNTYsIDUxMiwgMywgMSwgJ2xlYWt5JykKICAgICAgICBzZWxmLmNvbnY4ID0gQ29udl9Cbl9BY3RpdmF0aW9uKDUxMiwgMjU2LCAxLCAxLCAnbGVha3knKQogICAgICAgIHNlbGYuY29udjkgPSBDb252X0JuX0FjdGl2YXRpb24oMjU2LCA1MTIsIDMsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MTAgPSBDb252X0JuX0FjdGl2YXRpb24oNTEyLCBvdXRwdXRfY2gsIDEsIDEsICdsaW5lYXInLCBibj1GYWxzZSwgYmlhcz1UcnVlKQogICAgICAgIAogICAgICAgIHNlbGYueW9sbzIgPSBZb2xvTGF5ZXIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yX21hc2s9WzMsIDQsIDVdLCBudW1fY2xhc3Nlcz1uX2NsYXNzZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9ycz1bMTIsIDE2LCAxOSwgMzYsIDQwLCAyOCwgMzYsIDc1LCA3NiwgNTUsIDcyLCAxNDYsIDE0MiwgMTEwLCAxOTIsIDI0MywgNDU5LCA0MDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bV9hbmNob3JzPTksIHN0cmlkZT0xNikKCiAgICAgICAgIyBSIC00CiAgICAgICAgc2VsZi5jb252MTEgPSBDb252X0JuX0FjdGl2YXRpb24oMjU2LCA1MTIsIDMsIDIsICdsZWFreScpCgogICAgICAgICMgUiAtMSAtMzcKICAgICAgICBzZWxmLmNvbnYxMiA9IENvbnZfQm5fQWN0aXZhdGlvbigxMDI0LCA1MTIsIDEsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MTMgPSBDb252X0JuX0FjdGl2YXRpb24oNTEyLCAxMDI0LCAzLCAxLCAnbGVha3knKQogICAgICAgIHNlbGYuY29udjE0ID0gQ29udl9Cbl9BY3RpdmF0aW9uKDEwMjQsIDUxMiwgMSwgMSwgJ2xlYWt5JykKICAgICAgICBzZWxmLmNvbnYxNSA9IENvbnZfQm5fQWN0aXZhdGlvbig1MTIsIDEwMjQsIDMsIDEsICdsZWFreScpCiAgICAgICAgc2VsZi5jb252MTYgPSBDb252X0JuX0FjdGl2YXRpb24oMTAyNCwgNTEyLCAxLCAxLCAnbGVha3knKQogICAgICAgIHNlbGYuY29udjE3ID0gQ29udl9Cbl9BY3RpdmF0aW9uKDUxMiwgMTAyNCwgMywgMSwgJ2xlYWt5JykKICAgICAgICBzZWxmLmNvbnYxOCA9IENvbnZfQm5fQWN0aXZhdGlvbigxMDI0LCBvdXRwdXRfY2gsIDEsIDEsICdsaW5lYXInLCBibj1GYWxzZSwgYmlhcz1UcnVlKQogICAgICAgIAogICAgICAgIHNlbGYueW9sbzMgPSBZb2xvTGF5ZXIoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9yX21hc2s9WzYsIDcsIDhdLCBudW1fY2xhc3Nlcz1uX2NsYXNzZXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5jaG9ycz1bMTIsIDE2LCAxOSwgMzYsIDQwLCAyOCwgMzYsIDc1LCA3NiwgNTUsIDcyLCAxNDYsIDE0MiwgMTEwLCAxOTIsIDI0MywgNDU5LCA0MDFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG51bV9hbmNob3JzPTksIHN0cmlkZT0zMikKCiAgICBkZWYgZm9yd2FyZChzZWxmLCBpbnB1dDEsIGlucHV0MiwgaW5wdXQzKToKICAgICAgICB4MSA9IHNlbGYuY29udjEoaW5wdXQxKQogICAgICAgIHgyID0gc2VsZi5jb252Mih4MSkKCiAgICAgICAgeDMgPSBzZWxmLmNvbnYzKGlucHV0MSkKICAgICAgICAjIFIgLTEgLTE2CiAgICAgICAgeDMgPSB0b3JjaC5jYXQoW3gzLCBpbnB1dDJdLCBkaW09MSkKICAgICAgICB4NCA9IHNlbGYuY29udjQoeDMpCiAgICAgICAgeDUgPSBzZWxmLmNvbnY1KHg0KQogICAgICAgIHg2ID0gc2VsZi5jb252Nih4NSkKICAgICAgICB4NyA9IHNlbGYuY29udjcoeDYpCiAgICAgICAgeDggPSBzZWxmLmNvbnY4KHg3KQogICAgICAgIHg5ID0gc2VsZi5jb252OSh4OCkKICAgICAgICB4MTAgPSBzZWxmLmNvbnYxMCh4OSkKCiAgICAgICAgIyBSIC00CiAgICAgICAgeDExID0gc2VsZi5jb252MTEoeDgpCiAgICAgICAgIyBSIC0xIC0zNwogICAgICAgIHgxMSA9IHRvcmNoLmNhdChbeDExLCBpbnB1dDNdLCBkaW09MSkKCiAgICAgICAgeDEyID0gc2VsZi5jb252MTIoeDExKQogICAgICAgIHgxMyA9IHNlbGYuY29udjEzKHgxMikKICAgICAgICB4MTQgPSBzZWxmLmNvbnYxNCh4MTMpCiAgICAgICAgeDE1ID0gc2VsZi5jb252MTUoeDE0KQogICAgICAgIHgxNiA9IHNlbGYuY29udjE2KHgxNSkKICAgICAgICB4MTcgPSBzZWxmLmNvbnYxNyh4MTYpCiAgICAgICAgeDE4ID0gc2VsZi5jb252MTgoeDE3KQogICAgICAgIAogICAgICAgIGlmIHNlbGYuaW5mZXJlbmNlOgogICAgICAgICAgICB5MSA9IHNlbGYueW9sbzEoeDIpCiAgICAgICAgICAgIHkyID0gc2VsZi55b2xvMih4MTApCiAgICAgICAgICAgIHkzID0gc2VsZi55b2xvMyh4MTgpCgogICAgICAgICAgICByZXR1cm4gZ2V0X3JlZ2lvbl9ib3hlcyhbeTEsIHkyLCB5M10pCiAgICAgICAgCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIFt4MiwgeDEwLCB4MThdCgoKY2xhc3MgWW9sb3Y0KG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgeW9sb3Y0Y29udjEzN3dlaWdodD1Ob25lLCBuX2NsYXNzZXM9ODAsIGluZmVyZW5jZT1GYWxzZSk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgb3V0cHV0X2NoID0gKDQgKyAxICsgbl9jbGFzc2VzKSAqIDMKICAgICAgICAjIGJhY2tib25lCiAgICAgICAgc2VsZi5kb3duMSA9IERvd25TYW1wbGUxKCkKICAgICAgICBzZWxmLmRvd24yID0gRG93blNhbXBsZTIoKQogICAgICAgIHNlbGYuZG93bjMgPSBEb3duU2FtcGxlMygpCiAgICAgICAgc2VsZi5kb3duNCA9IERvd25TYW1wbGU0KCkKICAgICAgICBzZWxmLmRvd241ID0gRG93blNhbXBsZTUoKQogICAgICAgICMgbmVjayAjdG9kbyBmaXgKICAgICAgICBzZWxmLm5lZWsgPSBOZWNrKGluZmVyZW5jZSkKICAgICAgICAjIHlvbG92NGNvbnYxMzcKICAgICAgICBpZiB5b2xvdjRjb252MTM3d2VpZ2h0OgogICAgICAgICAgICBfbW9kZWwgPSBubi5TZXF1ZW50aWFsKHNlbGYuZG93bjEsIHNlbGYuZG93bjIsIHNlbGYuZG93bjMsIHNlbGYuZG93bjQsIHNlbGYuZG93bjUsIHNlbGYubmVlaykjdG9kbyBmaXgKICAgICAgICAgICAgcHJldHJhaW5lZF9kaWN0ID0gdG9yY2gubG9hZCh5b2xvdjRjb252MTM3d2VpZ2h0KQogICAgICAgICAgICBtb2RlbF9kaWN0ID0gX21vZGVsLnN0YXRlX2RpY3QoKQogICAgICAgICAgICAjIDEuIGZpbHRlciBvdXQgdW5uZWNlc3Nhcnkga2V5cwogICAgICAgICAgICBwcmV0cmFpbmVkX2RpY3QgPSB7azE6IHYgZm9yIChrLCB2KSwgazEgaW4gemlwKHByZXRyYWluZWRfZGljdC5pdGVtcygpLCBtb2RlbF9kaWN0KX0KICAgICAgICAgICAgIyAyLiBvdmVyd3JpdGUgZW50cmllcyBpbiB0aGUgZXhpc3Rpbmcgc3RhdGUgZGljdAogICAgICAgICAgICBtb2RlbF9kaWN0LnVwZGF0ZShwcmV0cmFpbmVkX2RpY3QpCiAgICAgICAgICAgIF9tb2RlbC5sb2FkX3N0YXRlX2RpY3QobW9kZWxfZGljdCkKICAgICAgICAjIGhlYWQKICAgICAgICBzZWxmLmhlYWQgPSBZb2xvdjRIZWFkKG91dHB1dF9jaCwgbl9jbGFzc2VzLCBpbmZlcmVuY2UpCgoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIGlucHV0KToKICAgICAgICBkMSA9IHNlbGYuZG93bjEoaW5wdXQpCiAgICAgICAgZDIgPSBzZWxmLmRvd24yKGQxKQogICAgICAgIGQzID0gc2VsZi5kb3duMyhkMikKICAgICAgICBkNCA9IHNlbGYuZG93bjQoZDMpCiAgICAgICAgZDUgPSBzZWxmLmRvd241KGQ0KQogICAgICAgIHgyMCwgeDEzLCB4NiA9IHNlbGYubmVlayhkNSwgZDQsIGQzKSN0b2RvIGZpeAogICAgICAgIG91dHB1dCA9IHNlbGYuaGVhZCh4MjAsIHgxMywgeDYpCiAgICAgICAgcmV0dXJuIG91dHB1dAoKCmRlZiBtYWluKG5fY2xhc3Nlcywgd2VpZ2h0ZmlsZSwgaW1nZmlsZSwgaGVpZ2h0LCB3aWR0aCwgbmFtZXNmaWxlPU5vbmUpOgogICAgdHJ5OgogICAgICAgIGZyb20gdG9vbC51dGlscyBpbXBvcnQgbG9hZF9jbGFzc19uYW1lcywgcGxvdF9ib3hlc19jdjIKICAgICAgICBmcm9tIHRvb2wudG9yY2hfdXRpbHMgaW1wb3J0IGRvX2RldGVjdAogICAgZXhjZXB0IEltcG9ydEVycm9yOgogICAgICAgIGZyb20gWU9MT3Y0LnRvb2wudXRpbHMgaW1wb3J0IGxvYWRfY2xhc3NfbmFtZXMsIHBsb3RfYm94ZXNfY3YyCiAgICAgICAgZnJvbSBZT0xPdjQudG9vbC50b3JjaF91dGlscyBpbXBvcnQgZG9fZGV0ZWN0CgogICAgaW1wb3J0IGN2MgoKICAgIG1vZGVsID0gWW9sb3Y0KHlvbG92NGNvbnYxMzd3ZWlnaHQ9Tm9uZSwgbl9jbGFzc2VzPW5fY2xhc3NlcywgaW5mZXJlbmNlPVRydWUpCgogICAgdXNlX2N1ZGEgPSB0b3JjaC5jdWRhLmlzX2F2YWlsYWJsZSgpCgogICAgaWYgdXNlX2N1ZGE6CiAgICAgICAgbW9kZWwuY3VkYSgpCgogICAgcHJldHJhaW5lZF9kaWN0ID0gdG9yY2gubG9hZCh3ZWlnaHRmaWxlLCBtYXBfbG9jYXRpb249dG9yY2guZGV2aWNlKCdjdWRhJykpCiAgICBtb2RlbC5sb2FkX3N0YXRlX2RpY3QocHJldHJhaW5lZF9kaWN0KQoKICAgIGlmIGlzaW5zdGFuY2UoaW1nZmlsZSwgbnAubmRhcnJheSk6CiAgICAgICAgaW1nID0gaW1nZmlsZQogICAgZWxzZToKICAgICAgICBpbWcgPSBjdjIuaW1yZWFkKGltZ2ZpbGUpCgogICAgIyBJbmZlcmVuY2UgaW5wdXQgc2l6ZSBpcyA0MTYqNDE2IGRvZXMgbm90IG1lYW4gdHJhaW5pbmcgc2l6ZSBpcyB0aGUgc2FtZQogICAgIyBUcmFpbmluZyBzaXplIGNvdWxkIGJlIDYwOCo2MDggb3IgZXZlbiBvdGhlciBzaXplcwogICAgIyBPcHRpb25hbCBpbmZlcmVuY2Ugc2l6ZXM6CiAgICAjICAgSGlnaHQgaW4gezMyMCwgNDE2LCA1MTIsIDYwOCwgLi4uIDMyMCArIDk2ICogbn0KICAgICMgICBXaWR0aCBpbiB7MzIwLCA0MTYsIDUxMiwgNjA4LCAuLi4gMzIwICsgOTYgKiBtfQogICAgc2l6ZWQgPSBjdjIucmVzaXplKGltZywgKHdpZHRoLCBoZWlnaHQpKQogICAgc2l6ZWQgPSBjdjIuY3Z0Q29sb3Ioc2l6ZWQsIGN2Mi5DT0xPUl9CR1IyUkdCKQoKICAgIGZvciBpIGluIHJhbmdlKDIpOiAgIyBUaGlzICdmb3InIGxvb3AgaXMgZm9yIHNwZWVkIGNoZWNrCiAgICAgICAgIyBCZWNhdXNlIHRoZSBmaXJzdCBpdGVyYXRpb24gaXMgdXN1YWxseSBsb25nZXIKICAgICAgICBib3hlcyA9IGRvX2RldGVjdChtb2RlbCwgc2l6ZWQsIDAuNCwgMC42LCB1c2VfY3VkYSkKCiAgICBpZiBuYW1lc2ZpbGUgaXMgbm90IE5vbmU6CiAgICAgICAgY2xhc3NfbmFtZXMgPSBsb2FkX2NsYXNzX25hbWVzKG5hbWVzZmlsZSkKICAgICAgICBwbG90X2JveGVzX2N2MihpbWcsIGJveGVzWzBdLCAncHJlZGljdGlvbnMuanBnJywgY2xhc3NfbmFtZXMpCiAgICByZXR1cm4gYm94ZXMKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpbXBvcnQgc3lzCiAgICBpZiBsZW4oc3lzLmFyZ3YpID09IDc6CiAgICAgICAgbl9jbGFzc2VzID0gaW50KHN5cy5hcmd2WzFdKQogICAgICAgIHdlaWdodGZpbGUgPSBzeXMuYXJndlsyXQogICAgICAgIGltZ2ZpbGUgPSBzeXMuYXJndlszXQogICAgICAgIGhlaWdodCA9IGludChzeXMuYXJndls0XSkKICAgICAgICB3aWR0aCA9IGludChzeXMuYXJndls1XSkKICAgICAgICBuYW1lc2ZpbGUgPSBzeXMuYXJndls2XQogICAgZWxzZToKICAgICAgICBwcmludCgnVXNhZ2U6ICcpCiAgICAgICAgcHJpbnQoJ3B5dGhvbiBtb2RlbHMucHkgbnVtX2NsYXNzZXMgd2VpZ2h0ZmlsZSBpbWdmaWxlIGhlaWdodCB3aWR0aCBuYW1lZmlsZScpCiAgICBtYWluKG5fY2xhc3Nlcywgd2VpZ2h0ZmlsZSwgaW1nZmlsZSwgaGVpZ2h0LCB3aWR0aCwgbmFtZXNmaWxlKQo=')
    file.write(models_string)

with open(root + "YOLOv4" + "/tool/torch_utils.py", "wb") as file:
    torch_utils_string = base64.b64decode(b'aW1wb3J0IHN5cwppbXBvcnQgb3MKaW1wb3J0IHRpbWUKaW1wb3J0IG1hdGgKaW1wb3J0IHRvcmNoCmltcG9ydCBudW1weSBhcyBucApmcm9tIHRvcmNoLmF1dG9ncmFkIGltcG9ydCBWYXJpYWJsZQoKaW1wb3J0IGl0ZXJ0b29scwppbXBvcnQgc3RydWN0ICAjIGdldF9pbWFnZV9zaXplCmltcG9ydCBpbWdoZHIgICMgZ2V0X2ltYWdlX3NpemUKI3RvZG8gZml4CnRyeToKICAgIGZyb20gdG9vbCBpbXBvcnQgdXRpbHMKZXhjZXB0IEltcG9ydEVycm9yOgogICAgZnJvbSBZT0xPdjQudG9vbCBpbXBvcnQgdXRpbHMKCgpkZWYgYmJveF9pb3VzKGJveGVzMSwgYm94ZXMyLCB4MXkxeDJ5Mj1UcnVlKToKICAgIGlmIHgxeTF4MnkyOgogICAgICAgIG14ID0gdG9yY2gubWluKGJveGVzMVswXSwgYm94ZXMyWzBdKQogICAgICAgIE14ID0gdG9yY2gubWF4KGJveGVzMVsyXSwgYm94ZXMyWzJdKQogICAgICAgIG15ID0gdG9yY2gubWluKGJveGVzMVsxXSwgYm94ZXMyWzFdKQogICAgICAgIE15ID0gdG9yY2gubWF4KGJveGVzMVszXSwgYm94ZXMyWzNdKQogICAgICAgIHcxID0gYm94ZXMxWzJdIC0gYm94ZXMxWzBdCiAgICAgICAgaDEgPSBib3hlczFbM10gLSBib3hlczFbMV0KICAgICAgICB3MiA9IGJveGVzMlsyXSAtIGJveGVzMlswXQogICAgICAgIGgyID0gYm94ZXMyWzNdIC0gYm94ZXMyWzFdCiAgICBlbHNlOgogICAgICAgIG14ID0gdG9yY2gubWluKGJveGVzMVswXSAtIGJveGVzMVsyXSAvIDIuMCwgYm94ZXMyWzBdIC0gYm94ZXMyWzJdIC8gMi4wKQogICAgICAgIE14ID0gdG9yY2gubWF4KGJveGVzMVswXSArIGJveGVzMVsyXSAvIDIuMCwgYm94ZXMyWzBdICsgYm94ZXMyWzJdIC8gMi4wKQogICAgICAgIG15ID0gdG9yY2gubWluKGJveGVzMVsxXSAtIGJveGVzMVszXSAvIDIuMCwgYm94ZXMyWzFdIC0gYm94ZXMyWzNdIC8gMi4wKQogICAgICAgIE15ID0gdG9yY2gubWF4KGJveGVzMVsxXSArIGJveGVzMVszXSAvIDIuMCwgYm94ZXMyWzFdICsgYm94ZXMyWzNdIC8gMi4wKQogICAgICAgIHcxID0gYm94ZXMxWzJdCiAgICAgICAgaDEgPSBib3hlczFbM10KICAgICAgICB3MiA9IGJveGVzMlsyXQogICAgICAgIGgyID0gYm94ZXMyWzNdCiAgICB1dyA9IE14IC0gbXgKICAgIHVoID0gTXkgLSBteQogICAgY3cgPSB3MSArIHcyIC0gdXcKICAgIGNoID0gaDEgKyBoMiAtIHVoCiAgICBtYXNrID0gKChjdyA8PSAwKSArIChjaCA8PSAwKSA+IDApCiAgICBhcmVhMSA9IHcxICogaDEKICAgIGFyZWEyID0gdzIgKiBoMgogICAgY2FyZWEgPSBjdyAqIGNoCiAgICBjYXJlYVttYXNrXSA9IDAKICAgIHVhcmVhID0gYXJlYTEgKyBhcmVhMiAtIGNhcmVhCiAgICByZXR1cm4gY2FyZWEgLyB1YXJlYQoKCmRlZiBnZXRfcmVnaW9uX2JveGVzKGJveGVzX2FuZF9jb25mcyk6CgogICAgIyBwcmludCgnR2V0dGluZyBib3hlcyBmcm9tIGJveGVzIGFuZCBjb25mcyAuLi4nKQoKICAgIGJveGVzX2xpc3QgPSBbXQogICAgY29uZnNfbGlzdCA9IFtdCgogICAgZm9yIGl0ZW0gaW4gYm94ZXNfYW5kX2NvbmZzOgogICAgICAgIGJveGVzX2xpc3QuYXBwZW5kKGl0ZW1bMF0pCiAgICAgICAgY29uZnNfbGlzdC5hcHBlbmQoaXRlbVsxXSkKCiAgICAjIGJveGVzOiBbYmF0Y2gsIG51bTEgKyBudW0yICsgbnVtMywgMSwgNF0KICAgICMgY29uZnM6IFtiYXRjaCwgbnVtMSArIG51bTIgKyBudW0zLCBudW1fY2xhc3Nlc10KICAgIGJveGVzID0gdG9yY2guY2F0KGJveGVzX2xpc3QsIGRpbT0xKQogICAgY29uZnMgPSB0b3JjaC5jYXQoY29uZnNfbGlzdCwgZGltPTEpCiAgICAgICAgCiAgICByZXR1cm4gW2JveGVzLCBjb25mc10KCgpkZWYgY29udmVydDJjcHUoZ3B1X21hdHJpeCk6CiAgICByZXR1cm4gdG9yY2guRmxvYXRUZW5zb3IoZ3B1X21hdHJpeC5zaXplKCkpLmNvcHlfKGdwdV9tYXRyaXgpCgoKZGVmIGNvbnZlcnQyY3B1X2xvbmcoZ3B1X21hdHJpeCk6CiAgICByZXR1cm4gdG9yY2guTG9uZ1RlbnNvcihncHVfbWF0cml4LnNpemUoKSkuY29weV8oZ3B1X21hdHJpeCkKCgoKZGVmIGRvX2RldGVjdChtb2RlbCwgaW1nLCBjb25mX3RocmVzaCwgbm1zX3RocmVzaCwgdXNlX2N1ZGE9MSk6CiAgICBtb2RlbC5ldmFsKCkKICAgIHdpdGggdG9yY2gubm9fZ3JhZCgpOgogICAgICAgIHQwID0gdGltZS50aW1lKCkKCiAgICAgICAgaWYgdHlwZShpbWcpID09IG5wLm5kYXJyYXkgYW5kIGxlbihpbWcuc2hhcGUpID09IDM6ICAjIGN2MiBpbWFnZQogICAgICAgICAgICBpbWcgPSB0b3JjaC5mcm9tX251bXB5KGltZy50cmFuc3Bvc2UoMiwgMCwgMSkpLmZsb2F0KCkuZGl2KDI1NS4wKS51bnNxdWVlemUoMCkKICAgICAgICBlbGlmIHR5cGUoaW1nKSA9PSBucC5uZGFycmF5IGFuZCBsZW4oaW1nLnNoYXBlKSA9PSA0OgogICAgICAgICAgICBpbWcgPSB0b3JjaC5mcm9tX251bXB5KGltZy50cmFuc3Bvc2UoMCwgMywgMSwgMikpLmZsb2F0KCkuZGl2KDI1NS4wKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCJ1bmtub3cgaW1hZ2UgdHlwZSIpCiAgICAgICAgICAgIGV4aXQoLTEpCgogICAgICAgIGlmIHVzZV9jdWRhOgogICAgICAgICAgICBpbWcgPSBpbWcuY3VkYSgpCiAgICAgICAgaW1nID0gdG9yY2guYXV0b2dyYWQuVmFyaWFibGUoaW1nKQoKICAgICAgICB0MSA9IHRpbWUudGltZSgpCgogICAgICAgIG91dHB1dCA9IG1vZGVsKGltZykKCiAgICAgICAgdDIgPSB0aW1lLnRpbWUoKQoKICAgICAgICBwcmludCgnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKQogICAgICAgIHByaW50KCcgICAgICAgICAgIFByZXByb2Nlc3MgOiAlZicgJSAodDEgLSB0MCkpCiAgICAgICAgcHJpbnQoJyAgICAgIE1vZGVsIEluZmVyZW5jZSA6ICVmJyAlICh0MiAtIHQxKSkKICAgICAgICBwcmludCgnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKQoKICAgICAgICByZXR1cm4gdXRpbHMucG9zdF9wcm9jZXNzaW5nKGltZywgY29uZl90aHJlc2gsIG5tc190aHJlc2gsIG91dHB1dCkKCg==')
    file.write(torch_utils_string)

with open(root + "YOLOv4" + "/tool/darknet2pytorch.py", "wb") as file:
    darknet2pytorch_string = base64.b64decode(b'aW1wb3J0IHRvcmNoLm5uIGFzIG5uCmltcG9ydCB0b3JjaC5ubi5mdW5jdGlvbmFsIGFzIEYKaW1wb3J0IG51bXB5IGFzIG5wCiN0b2RvIGZpeAppbXBvcnQgdG9yY2gKdHJ5OgogICAgZnJvbSB0b29sLnJlZ2lvbl9sb3NzIGltcG9ydCBSZWdpb25Mb3NzCiAgICBmcm9tIHRvb2wueW9sb19sYXllciBpbXBvcnQgWW9sb0xheWVyCiAgICBmcm9tIHRvb2wuY29uZmlnIGltcG9ydCAqCiAgICBmcm9tIHRvb2wudG9yY2hfdXRpbHMgaW1wb3J0ICoKZXhjZXB0IEltcG9ydEVycm9yOgogICAgZnJvbSBZT0xPdjQudG9vbC5yZWdpb25fbG9zcyBpbXBvcnQgUmVnaW9uTG9zcwogICAgZnJvbSBZT0xPdjQudG9vbC55b2xvX2xheWVyIGltcG9ydCBZb2xvTGF5ZXIKICAgIGZyb20gWU9MT3Y0LnRvb2wuY29uZmlnIGltcG9ydCAqCiAgICBmcm9tIFlPTE92NC50b29sLnRvcmNoX3V0aWxzIGltcG9ydCAqCgpjbGFzcyBNaXNoKHRvcmNoLm5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCgogICAgZGVmIGZvcndhcmQoc2VsZiwgeCk6CiAgICAgICAgeCA9IHggKiAodG9yY2gudGFuaCh0b3JjaC5ubi5mdW5jdGlvbmFsLnNvZnRwbHVzKHgpKSkKICAgICAgICByZXR1cm4geAoKCmNsYXNzIE1heFBvb2xEYXJrKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgc2l6ZT0yLCBzdHJpZGU9MSk6CiAgICAgICAgc3VwZXIoTWF4UG9vbERhcmssIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnNpemUgPSBzaXplCiAgICAgICAgc2VsZi5zdHJpZGUgPSBzdHJpZGUKCiAgICBkZWYgZm9yd2FyZChzZWxmLCB4KToKICAgICAgICAnJycKICAgICAgICBkYXJrbmV0IG91dHB1dF9zaXplID0gKGlucHV0X3NpemUgKyBwIC0gaykgLyBzICsxCiAgICAgICAgcCA6IHBhZGRpbmcgPSBrIC0gMQogICAgICAgIGsgOiBzaXplCiAgICAgICAgcyA6IHN0cmlkZQogICAgICAgIHRvcmNoIG91dHB1dF9zaXplID0gKGlucHV0X3NpemUgKyAyKnAgLWspIC8gcyArMQogICAgICAgIHAgOiBwYWRkaW5nID0gay8vMgogICAgICAgICcnJwogICAgICAgIHAgPSBzZWxmLnNpemUgLy8gMgogICAgICAgIGlmICgoeC5zaGFwZVsyXSAtIDEpIC8vIHNlbGYuc3RyaWRlKSAhPSAoKHguc2hhcGVbMl0gKyAyICogcCAtIHNlbGYuc2l6ZSkgLy8gc2VsZi5zdHJpZGUpOgogICAgICAgICAgICBwYWRkaW5nMSA9IChzZWxmLnNpemUgLSAxKSAvLyAyCiAgICAgICAgICAgIHBhZGRpbmcyID0gcGFkZGluZzEgKyAxCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcGFkZGluZzEgPSAoc2VsZi5zaXplIC0gMSkgLy8gMgogICAgICAgICAgICBwYWRkaW5nMiA9IHBhZGRpbmcxCiAgICAgICAgaWYgKCh4LnNoYXBlWzNdIC0gMSkgLy8gc2VsZi5zdHJpZGUpICE9ICgoeC5zaGFwZVszXSArIDIgKiBwIC0gc2VsZi5zaXplKSAvLyBzZWxmLnN0cmlkZSk6CiAgICAgICAgICAgIHBhZGRpbmczID0gKHNlbGYuc2l6ZSAtIDEpIC8vIDIKICAgICAgICAgICAgcGFkZGluZzQgPSBwYWRkaW5nMyArIDEKICAgICAgICBlbHNlOgogICAgICAgICAgICBwYWRkaW5nMyA9IChzZWxmLnNpemUgLSAxKSAvLyAyCiAgICAgICAgICAgIHBhZGRpbmc0ID0gcGFkZGluZzMKICAgICAgICB4ID0gRi5tYXhfcG9vbDJkKEYucGFkKHgsIChwYWRkaW5nMywgcGFkZGluZzQsIHBhZGRpbmcxLCBwYWRkaW5nMiksIG1vZGU9J3JlcGxpY2F0ZScpLAogICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zaXplLCBzdHJpZGU9c2VsZi5zdHJpZGUpCiAgICAgICAgcmV0dXJuIHgKCgpjbGFzcyBVcHNhbXBsZV9leHBhbmQobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzdHJpZGU9Mik6CiAgICAgICAgc3VwZXIoVXBzYW1wbGVfZXhwYW5kLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5zdHJpZGUgPSBzdHJpZGUKCiAgICBkZWYgZm9yd2FyZChzZWxmLCB4KToKICAgICAgICBhc3NlcnQgKHguZGF0YS5kaW0oKSA9PSA0KQogICAgICAgIAogICAgICAgIHggPSB4LnZpZXcoeC5zaXplKDApLCB4LnNpemUoMSksIHguc2l6ZSgyKSwgMSwgeC5zaXplKDMpLCAxKS5cCiAgICAgICAgICAgIGV4cGFuZCh4LnNpemUoMCksIHguc2l6ZSgxKSwgeC5zaXplKDIpLCBzZWxmLnN0cmlkZSwgeC5zaXplKDMpLCBzZWxmLnN0cmlkZSkuY29udGlndW91cygpLlwKICAgICAgICAgICAgdmlldyh4LnNpemUoMCksIHguc2l6ZSgxKSwgeC5zaXplKDIpICogc2VsZi5zdHJpZGUsIHguc2l6ZSgzKSAqIHNlbGYuc3RyaWRlKQoKICAgICAgICByZXR1cm4geAoKCmNsYXNzIFVwc2FtcGxlX2ludGVycG9sYXRlKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgc3RyaWRlKToKICAgICAgICBzdXBlcihVcHNhbXBsZV9pbnRlcnBvbGF0ZSwgc2VsZikuX19pbml0X18oKQogICAgICAgIHNlbGYuc3RyaWRlID0gc3RyaWRlCgogICAgZGVmIGZvcndhcmQoc2VsZiwgeCk6CiAgICAgICAgYXNzZXJ0ICh4LmRhdGEuZGltKCkgPT0gNCkKCiAgICAgICAgb3V0ID0gRi5pbnRlcnBvbGF0ZSh4LCBzaXplPSh4LnNpemUoMikgKiBzZWxmLnN0cmlkZSwgeC5zaXplKDMpICogc2VsZi5zdHJpZGUpLCBtb2RlPSduZWFyZXN0JykKICAgICAgICByZXR1cm4gb3V0CgoKY2xhc3MgUmVvcmcobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzdHJpZGU9Mik6CiAgICAgICAgc3VwZXIoUmVvcmcsIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLnN0cmlkZSA9IHN0cmlkZQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIHN0cmlkZSA9IHNlbGYuc3RyaWRlCiAgICAgICAgYXNzZXJ0ICh4LmRhdGEuZGltKCkgPT0gNCkKICAgICAgICBCID0geC5kYXRhLnNpemUoMCkKICAgICAgICBDID0geC5kYXRhLnNpemUoMSkKICAgICAgICBIID0geC5kYXRhLnNpemUoMikKICAgICAgICBXID0geC5kYXRhLnNpemUoMykKICAgICAgICBhc3NlcnQgKEggJSBzdHJpZGUgPT0gMCkKICAgICAgICBhc3NlcnQgKFcgJSBzdHJpZGUgPT0gMCkKICAgICAgICB3cyA9IHN0cmlkZQogICAgICAgIGhzID0gc3RyaWRlCiAgICAgICAgeCA9IHgudmlldyhCLCBDLCBIIC8gaHMsIGhzLCBXIC8gd3MsIHdzKS50cmFuc3Bvc2UoMywgNCkuY29udGlndW91cygpCiAgICAgICAgeCA9IHgudmlldyhCLCBDLCBIIC8gaHMgKiBXIC8gd3MsIGhzICogd3MpLnRyYW5zcG9zZSgyLCAzKS5jb250aWd1b3VzKCkKICAgICAgICB4ID0geC52aWV3KEIsIEMsIGhzICogd3MsIEggLyBocywgVyAvIHdzKS50cmFuc3Bvc2UoMSwgMikuY29udGlndW91cygpCiAgICAgICAgeCA9IHgudmlldyhCLCBocyAqIHdzICogQywgSCAvIGhzLCBXIC8gd3MpCiAgICAgICAgcmV0dXJuIHgKCgpjbGFzcyBHbG9iYWxBdmdQb29sMmQobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcihHbG9iYWxBdmdQb29sMmQsIHNlbGYpLl9faW5pdF9fKCkKCiAgICBkZWYgZm9yd2FyZChzZWxmLCB4KToKICAgICAgICBOID0geC5kYXRhLnNpemUoMCkKICAgICAgICBDID0geC5kYXRhLnNpemUoMSkKICAgICAgICBIID0geC5kYXRhLnNpemUoMikKICAgICAgICBXID0geC5kYXRhLnNpemUoMykKICAgICAgICB4ID0gRi5hdmdfcG9vbDJkKHgsIChILCBXKSkKICAgICAgICB4ID0geC52aWV3KE4sIEMpCiAgICAgICAgcmV0dXJuIHgKCgojIGZvciByb3V0ZSwgc2hvcnRjdXQgYW5kIHNhbQpjbGFzcyBFbXB0eU1vZHVsZShubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKEVtcHR5TW9kdWxlLCBzZWxmKS5fX2luaXRfXygpCgogICAgZGVmIGZvcndhcmQoc2VsZiwgeCk6CiAgICAgICAgcmV0dXJuIHgKCgojIHN1cHBvcnQgcm91dGUgc2hvcnRjdXQgYW5kIHJlb3JnCmNsYXNzIERhcmtuZXQobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBjZmdmaWxlLCBpbmZlcmVuY2U9RmFsc2UpOgogICAgICAgIHN1cGVyKERhcmtuZXQsIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmluZmVyZW5jZSA9IGluZmVyZW5jZQogICAgICAgIHNlbGYudHJhaW5pbmcgPSBub3Qgc2VsZi5pbmZlcmVuY2UKCiAgICAgICAgc2VsZi5ibG9ja3MgPSBwYXJzZV9jZmcoY2ZnZmlsZSkKICAgICAgICBzZWxmLndpZHRoID0gaW50KHNlbGYuYmxvY2tzWzBdWyd3aWR0aCddKQogICAgICAgIHNlbGYuaGVpZ2h0ID0gaW50KHNlbGYuYmxvY2tzWzBdWydoZWlnaHQnXSkKCiAgICAgICAgc2VsZi5tb2RlbHMgPSBzZWxmLmNyZWF0ZV9uZXR3b3JrKHNlbGYuYmxvY2tzKSAgIyBtZXJnZSBjb252LCBibixsZWFreQogICAgICAgIHNlbGYubG9zcyA9IHNlbGYubW9kZWxzW2xlbihzZWxmLm1vZGVscykgLSAxXQoKICAgICAgICBpZiBzZWxmLmJsb2Nrc1sobGVuKHNlbGYuYmxvY2tzKSAtIDEpXVsndHlwZSddID09ICdyZWdpb24nOgogICAgICAgICAgICBzZWxmLmFuY2hvcnMgPSBzZWxmLmxvc3MuYW5jaG9ycwogICAgICAgICAgICBzZWxmLm51bV9hbmNob3JzID0gc2VsZi5sb3NzLm51bV9hbmNob3JzCiAgICAgICAgICAgIHNlbGYuYW5jaG9yX3N0ZXAgPSBzZWxmLmxvc3MuYW5jaG9yX3N0ZXAKICAgICAgICAgICAgc2VsZi5udW1fY2xhc3NlcyA9IHNlbGYubG9zcy5udW1fY2xhc3NlcwoKICAgICAgICBzZWxmLmhlYWRlciA9IHRvcmNoLkludFRlbnNvcihbMCwgMCwgMCwgMF0pCiAgICAgICAgc2VsZi5zZWVuID0gMAoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIGluZCA9IC0yCiAgICAgICAgc2VsZi5sb3NzID0gTm9uZQogICAgICAgIG91dHB1dHMgPSBkaWN0KCkKICAgICAgICBvdXRfYm94ZXMgPSBbXQogICAgICAgIGZvciBibG9jayBpbiBzZWxmLmJsb2NrczoKICAgICAgICAgICAgaW5kID0gaW5kICsgMQogICAgICAgICAgICAjIGlmIGluZCA+IDA6CiAgICAgICAgICAgICMgICAgcmV0dXJuIHgKCiAgICAgICAgICAgIGlmIGJsb2NrWyd0eXBlJ10gPT0gJ25ldCc6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gaW4gWydjb252b2x1dGlvbmFsJywgJ21heHBvb2wnLCAncmVvcmcnLCAndXBzYW1wbGUnLCAnYXZncG9vbCcsICdzb2Z0bWF4JywgJ2Nvbm5lY3RlZCddOgogICAgICAgICAgICAgICAgeCA9IHNlbGYubW9kZWxzW2luZF0oeCkKICAgICAgICAgICAgICAgIG91dHB1dHNbaW5kXSA9IHgKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdyb3V0ZSc6CiAgICAgICAgICAgICAgICBsYXllcnMgPSBibG9ja1snbGF5ZXJzJ10uc3BsaXQoJywnKQogICAgICAgICAgICAgICAgbGF5ZXJzID0gW2ludChpKSBpZiBpbnQoaSkgPiAwIGVsc2UgaW50KGkpICsgaW5kIGZvciBpIGluIGxheWVyc10KICAgICAgICAgICAgICAgIGlmIGxlbihsYXllcnMpID09IDE6CiAgICAgICAgICAgICAgICAgICAgaWYgJ2dyb3Vwcycgbm90IGluIGJsb2NrLmtleXMoKSBvciBpbnQoYmxvY2tbJ2dyb3VwcyddKSA9PSAxOgogICAgICAgICAgICAgICAgICAgICAgICB4ID0gb3V0cHV0c1tsYXllcnNbMF1dCiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dHNbaW5kXSA9IHgKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBncm91cHMgPSBpbnQoYmxvY2tbJ2dyb3VwcyddKQogICAgICAgICAgICAgICAgICAgICAgICBncm91cF9pZCA9IGludChibG9ja1snZ3JvdXBfaWQnXSkKICAgICAgICAgICAgICAgICAgICAgICAgXywgYiwgXywgXyA9IG91dHB1dHNbbGF5ZXJzWzBdXS5zaGFwZQogICAgICAgICAgICAgICAgICAgICAgICB4ID0gb3V0cHV0c1tsYXllcnNbMF1dWzosIGIgLy8gZ3JvdXBzICogZ3JvdXBfaWQ6YiAvLyBncm91cHMgKiAoZ3JvdXBfaWQgKyAxKV0KICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0c1tpbmRdID0geAogICAgICAgICAgICAgICAgZWxpZiBsZW4obGF5ZXJzKSA9PSAyOgogICAgICAgICAgICAgICAgICAgIHgxID0gb3V0cHV0c1tsYXllcnNbMF1dCiAgICAgICAgICAgICAgICAgICAgeDIgPSBvdXRwdXRzW2xheWVyc1sxXV0KICAgICAgICAgICAgICAgICAgICB4ID0gdG9yY2guY2F0KCh4MSwgeDIpLCAxKQogICAgICAgICAgICAgICAgICAgIG91dHB1dHNbaW5kXSA9IHgKICAgICAgICAgICAgICAgIGVsaWYgbGVuKGxheWVycykgPT0gNDoKICAgICAgICAgICAgICAgICAgICB4MSA9IG91dHB1dHNbbGF5ZXJzWzBdXQogICAgICAgICAgICAgICAgICAgIHgyID0gb3V0cHV0c1tsYXllcnNbMV1dCiAgICAgICAgICAgICAgICAgICAgeDMgPSBvdXRwdXRzW2xheWVyc1syXV0KICAgICAgICAgICAgICAgICAgICB4NCA9IG91dHB1dHNbbGF5ZXJzWzNdXQogICAgICAgICAgICAgICAgICAgIHggPSB0b3JjaC5jYXQoKHgxLCB4MiwgeDMsIHg0KSwgMSkKICAgICAgICAgICAgICAgICAgICBvdXRwdXRzW2luZF0gPSB4CiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KCJyb3VudGUgbnVtYmVyID4gMiAsaXMge30iLmZvcm1hdChsZW4obGF5ZXJzKSkpCgogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ3Nob3J0Y3V0JzoKICAgICAgICAgICAgICAgIGZyb21fbGF5ZXIgPSBpbnQoYmxvY2tbJ2Zyb20nXSkKICAgICAgICAgICAgICAgIGFjdGl2YXRpb24gPSBibG9ja1snYWN0aXZhdGlvbiddCiAgICAgICAgICAgICAgICBmcm9tX2xheWVyID0gZnJvbV9sYXllciBpZiBmcm9tX2xheWVyID4gMCBlbHNlIGZyb21fbGF5ZXIgKyBpbmQKICAgICAgICAgICAgICAgIHgxID0gb3V0cHV0c1tmcm9tX2xheWVyXQogICAgICAgICAgICAgICAgeDIgPSBvdXRwdXRzW2luZCAtIDFdCiAgICAgICAgICAgICAgICB4ID0geDEgKyB4MgogICAgICAgICAgICAgICAgaWYgYWN0aXZhdGlvbiA9PSAnbGVha3knOgogICAgICAgICAgICAgICAgICAgIHggPSBGLmxlYWt5X3JlbHUoeCwgMC4xLCBpbnBsYWNlPVRydWUpCiAgICAgICAgICAgICAgICBlbGlmIGFjdGl2YXRpb24gPT0gJ3JlbHUnOgogICAgICAgICAgICAgICAgICAgIHggPSBGLnJlbHUoeCwgaW5wbGFjZT1UcnVlKQogICAgICAgICAgICAgICAgb3V0cHV0c1tpbmRdID0geAogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ3NhbSc6CiAgICAgICAgICAgICAgICBmcm9tX2xheWVyID0gaW50KGJsb2NrWydmcm9tJ10pCiAgICAgICAgICAgICAgICBmcm9tX2xheWVyID0gZnJvbV9sYXllciBpZiBmcm9tX2xheWVyID4gMCBlbHNlIGZyb21fbGF5ZXIgKyBpbmQKICAgICAgICAgICAgICAgIHgxID0gb3V0cHV0c1tmcm9tX2xheWVyXQogICAgICAgICAgICAgICAgeDIgPSBvdXRwdXRzW2luZCAtIDFdCiAgICAgICAgICAgICAgICB4ID0geDEgKiB4MgogICAgICAgICAgICAgICAgb3V0cHV0c1tpbmRdID0geAogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ3JlZ2lvbic6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgaWYgc2VsZi5sb3NzOgogICAgICAgICAgICAgICAgICAgIHNlbGYubG9zcyA9IHNlbGYubG9zcyArIHNlbGYubW9kZWxzW2luZF0oeCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5sb3NzID0gc2VsZi5tb2RlbHNbaW5kXSh4KQogICAgICAgICAgICAgICAgb3V0cHV0c1tpbmRdID0gTm9uZQogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ3lvbG8nOgogICAgICAgICAgICAgICAgIyBpZiBzZWxmLnRyYWluaW5nOgogICAgICAgICAgICAgICAgIyAgICAgcGFzcwogICAgICAgICAgICAgICAgIyBlbHNlOgogICAgICAgICAgICAgICAgIyAgICAgYm94ZXMgPSBzZWxmLm1vZGVsc1tpbmRdKHgpCiAgICAgICAgICAgICAgICAjICAgICBvdXRfYm94ZXMuYXBwZW5kKGJveGVzKQogICAgICAgICAgICAgICAgYm94ZXMgPSBzZWxmLm1vZGVsc1tpbmRdKHgpCiAgICAgICAgICAgICAgICBvdXRfYm94ZXMuYXBwZW5kKGJveGVzKQogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ2Nvc3QnOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KCd1bmtub3duIHR5cGUgJXMnICUgKGJsb2NrWyd0eXBlJ10pKQoKICAgICAgICBpZiBzZWxmLnRyYWluaW5nOgogICAgICAgICAgICByZXR1cm4gb3V0X2JveGVzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGdldF9yZWdpb25fYm94ZXMob3V0X2JveGVzKQoKICAgIGRlZiBwcmludF9uZXR3b3JrKHNlbGYpOgogICAgICAgIHByaW50X2NmZyhzZWxmLmJsb2NrcykKCiAgICBkZWYgY3JlYXRlX25ldHdvcmsoc2VsZiwgYmxvY2tzKToKICAgICAgICBtb2RlbHMgPSBubi5Nb2R1bGVMaXN0KCkKCiAgICAgICAgcHJldl9maWx0ZXJzID0gMwogICAgICAgIG91dF9maWx0ZXJzID0gW10KICAgICAgICBwcmV2X3N0cmlkZSA9IDEKICAgICAgICBvdXRfc3RyaWRlcyA9IFtdCiAgICAgICAgY29udl9pZCA9IDAKICAgICAgICBmb3IgYmxvY2sgaW4gYmxvY2tzOgogICAgICAgICAgICBpZiBibG9ja1sndHlwZSddID09ICduZXQnOgogICAgICAgICAgICAgICAgcHJldl9maWx0ZXJzID0gaW50KGJsb2NrWydjaGFubmVscyddKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdjb252b2x1dGlvbmFsJzoKICAgICAgICAgICAgICAgIGNvbnZfaWQgPSBjb252X2lkICsgMQogICAgICAgICAgICAgICAgYmF0Y2hfbm9ybWFsaXplID0gaW50KGJsb2NrWydiYXRjaF9ub3JtYWxpemUnXSkKICAgICAgICAgICAgICAgIGZpbHRlcnMgPSBpbnQoYmxvY2tbJ2ZpbHRlcnMnXSkKICAgICAgICAgICAgICAgIGtlcm5lbF9zaXplID0gaW50KGJsb2NrWydzaXplJ10pCiAgICAgICAgICAgICAgICBzdHJpZGUgPSBpbnQoYmxvY2tbJ3N0cmlkZSddKQogICAgICAgICAgICAgICAgaXNfcGFkID0gaW50KGJsb2NrWydwYWQnXSkKICAgICAgICAgICAgICAgIHBhZCA9IChrZXJuZWxfc2l6ZSAtIDEpIC8vIDIgaWYgaXNfcGFkIGVsc2UgMAogICAgICAgICAgICAgICAgYWN0aXZhdGlvbiA9IGJsb2NrWydhY3RpdmF0aW9uJ10KICAgICAgICAgICAgICAgIG1vZGVsID0gbm4uU2VxdWVudGlhbCgpCiAgICAgICAgICAgICAgICBpZiBiYXRjaF9ub3JtYWxpemU6CiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYWRkX21vZHVsZSgnY29udnswfScuZm9ybWF0KGNvbnZfaWQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm4uQ29udjJkKHByZXZfZmlsdGVycywgZmlsdGVycywga2VybmVsX3NpemUsIHN0cmlkZSwgcGFkLCBiaWFzPUZhbHNlKSkKICAgICAgICAgICAgICAgICAgICBtb2RlbC5hZGRfbW9kdWxlKCdibnswfScuZm9ybWF0KGNvbnZfaWQpLCBubi5CYXRjaE5vcm0yZChmaWx0ZXJzKSkKICAgICAgICAgICAgICAgICAgICAjIG1vZGVsLmFkZF9tb2R1bGUoJ2JuezB9Jy5mb3JtYXQoY29udl9pZCksIEJOMmQoZmlsdGVycykpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIG1vZGVsLmFkZF9tb2R1bGUoJ2NvbnZ7MH0nLmZvcm1hdChjb252X2lkKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5uLkNvbnYyZChwcmV2X2ZpbHRlcnMsIGZpbHRlcnMsIGtlcm5lbF9zaXplLCBzdHJpZGUsIHBhZCkpCiAgICAgICAgICAgICAgICBpZiBhY3RpdmF0aW9uID09ICdsZWFreSc6CiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYWRkX21vZHVsZSgnbGVha3l7MH0nLmZvcm1hdChjb252X2lkKSwgbm4uTGVha3lSZUxVKDAuMSwgaW5wbGFjZT1UcnVlKSkKICAgICAgICAgICAgICAgIGVsaWYgYWN0aXZhdGlvbiA9PSAncmVsdSc6CiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYWRkX21vZHVsZSgncmVsdXswfScuZm9ybWF0KGNvbnZfaWQpLCBubi5SZUxVKGlucGxhY2U9VHJ1ZSkpCiAgICAgICAgICAgICAgICBlbGlmIGFjdGl2YXRpb24gPT0gJ21pc2gnOgogICAgICAgICAgICAgICAgICAgIG1vZGVsLmFkZF9tb2R1bGUoJ21pc2h7MH0nLmZvcm1hdChjb252X2lkKSwgTWlzaCgpKQogICAgICAgICAgICAgICAgZWxpZiBhY3RpdmF0aW9uID09ICdsaW5lYXInOgogICAgICAgICAgICAgICAgICAgIG1vZGVsLmFkZF9tb2R1bGUoJ2xpbmVhcnswfScuZm9ybWF0KGNvbnZfaWQpLCBubi5JZGVudGl0eSgpKQogICAgICAgICAgICAgICAgZWxpZiBhY3RpdmF0aW9uID09ICdsb2dpc3RpYyc6CiAgICAgICAgICAgICAgICAgICAgbW9kZWwuYWRkX21vZHVsZSgnc2lnbW9pZHswfScuZm9ybWF0KGNvbnZfaWQpLCBubi5TaWdtb2lkKCkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KCJObyBjb252b2x1dGlvbmFsIGFjdGl2YXRpb24gbmFtZWQge30iLmZvcm1hdChhY3RpdmF0aW9uKSkKCiAgICAgICAgICAgICAgICBwcmV2X2ZpbHRlcnMgPSBmaWx0ZXJzCiAgICAgICAgICAgICAgICBvdXRfZmlsdGVycy5hcHBlbmQocHJldl9maWx0ZXJzKQogICAgICAgICAgICAgICAgcHJldl9zdHJpZGUgPSBzdHJpZGUgKiBwcmV2X3N0cmlkZQogICAgICAgICAgICAgICAgb3V0X3N0cmlkZXMuYXBwZW5kKHByZXZfc3RyaWRlKQogICAgICAgICAgICAgICAgbW9kZWxzLmFwcGVuZChtb2RlbCkKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdtYXhwb29sJzoKICAgICAgICAgICAgICAgIHBvb2xfc2l6ZSA9IGludChibG9ja1snc2l6ZSddKQogICAgICAgICAgICAgICAgc3RyaWRlID0gaW50KGJsb2NrWydzdHJpZGUnXSkKICAgICAgICAgICAgICAgIGlmIHN0cmlkZSA9PSAxIGFuZCBwb29sX3NpemUgJSAyOgogICAgICAgICAgICAgICAgICAgICMgWW91IGNhbiB1c2UgTWF4cG9vbGRhcmsgaW5zdGVhZCwgaGVyZSBpcyBjb252ZW5pZW50IHRvIGNvbnZlcnQgb25ueC4KICAgICAgICAgICAgICAgICAgICAjIEV4YW1wbGU6IFttYXhwb29sXSBzaXplPTMgc3RyaWRlPTEKICAgICAgICAgICAgICAgICAgICBtb2RlbCA9IG5uLk1heFBvb2wyZChrZXJuZWxfc2l6ZT1wb29sX3NpemUsIHN0cmlkZT1zdHJpZGUsIHBhZGRpbmc9cG9vbF9zaXplIC8vIDIpCiAgICAgICAgICAgICAgICBlbGlmIHN0cmlkZSA9PSBwb29sX3NpemU6CiAgICAgICAgICAgICAgICAgICAgIyBZb3UgY2FuIHVzZSBNYXhwb29sZGFyayBpbnN0ZWFkLCBoZXJlIGlzIGNvbnZlbmllbnQgdG8gY29udmVydCBvbm54LgogICAgICAgICAgICAgICAgICAgICMgRXhhbXBsZTogW21heHBvb2xdIHNpemU9MiBzdHJpZGU9MgogICAgICAgICAgICAgICAgICAgIG1vZGVsID0gbm4uTWF4UG9vbDJkKGtlcm5lbF9zaXplPXBvb2xfc2l6ZSwgc3RyaWRlPXN0cmlkZSwgcGFkZGluZz0wKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtb2RlbCA9IE1heFBvb2xEYXJrKHBvb2xfc2l6ZSwgc3RyaWRlKQogICAgICAgICAgICAgICAgb3V0X2ZpbHRlcnMuYXBwZW5kKHByZXZfZmlsdGVycykKICAgICAgICAgICAgICAgIHByZXZfc3RyaWRlID0gc3RyaWRlICogcHJldl9zdHJpZGUKICAgICAgICAgICAgICAgIG91dF9zdHJpZGVzLmFwcGVuZChwcmV2X3N0cmlkZSkKICAgICAgICAgICAgICAgIG1vZGVscy5hcHBlbmQobW9kZWwpCiAgICAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAnYXZncG9vbCc6CiAgICAgICAgICAgICAgICBtb2RlbCA9IEdsb2JhbEF2Z1Bvb2wyZCgpCiAgICAgICAgICAgICAgICBvdXRfZmlsdGVycy5hcHBlbmQocHJldl9maWx0ZXJzKQogICAgICAgICAgICAgICAgbW9kZWxzLmFwcGVuZChtb2RlbCkKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdzb2Z0bWF4JzoKICAgICAgICAgICAgICAgIG1vZGVsID0gbm4uU29mdG1heCgpCiAgICAgICAgICAgICAgICBvdXRfc3RyaWRlcy5hcHBlbmQocHJldl9zdHJpZGUpCiAgICAgICAgICAgICAgICBvdXRfZmlsdGVycy5hcHBlbmQocHJldl9maWx0ZXJzKQogICAgICAgICAgICAgICAgbW9kZWxzLmFwcGVuZChtb2RlbCkKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdjb3N0JzoKICAgICAgICAgICAgICAgIGlmIGJsb2NrWydfdHlwZSddID09ICdzc2UnOgogICAgICAgICAgICAgICAgICAgIG1vZGVsID0gbm4uTVNFTG9zcyhyZWR1Y3Rpb249J21lYW4nKQogICAgICAgICAgICAgICAgZWxpZiBibG9ja1snX3R5cGUnXSA9PSAnTDEnOgogICAgICAgICAgICAgICAgICAgIG1vZGVsID0gbm4uTDFMb3NzKHJlZHVjdGlvbj0nbWVhbicpCiAgICAgICAgICAgICAgICBlbGlmIGJsb2NrWydfdHlwZSddID09ICdzbW9vdGgnOgogICAgICAgICAgICAgICAgICAgIG1vZGVsID0gbm4uU21vb3RoTDFMb3NzKHJlZHVjdGlvbj0nbWVhbicpCiAgICAgICAgICAgICAgICBvdXRfZmlsdGVycy5hcHBlbmQoMSkKICAgICAgICAgICAgICAgIG91dF9zdHJpZGVzLmFwcGVuZChwcmV2X3N0cmlkZSkKICAgICAgICAgICAgICAgIG1vZGVscy5hcHBlbmQobW9kZWwpCiAgICAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAncmVvcmcnOgogICAgICAgICAgICAgICAgc3RyaWRlID0gaW50KGJsb2NrWydzdHJpZGUnXSkKICAgICAgICAgICAgICAgIHByZXZfZmlsdGVycyA9IHN0cmlkZSAqIHN0cmlkZSAqIHByZXZfZmlsdGVycwogICAgICAgICAgICAgICAgb3V0X2ZpbHRlcnMuYXBwZW5kKHByZXZfZmlsdGVycykKICAgICAgICAgICAgICAgIHByZXZfc3RyaWRlID0gcHJldl9zdHJpZGUgKiBzdHJpZGUKICAgICAgICAgICAgICAgIG91dF9zdHJpZGVzLmFwcGVuZChwcmV2X3N0cmlkZSkKICAgICAgICAgICAgICAgIG1vZGVscy5hcHBlbmQoUmVvcmcoc3RyaWRlKSkKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICd1cHNhbXBsZSc6CiAgICAgICAgICAgICAgICBzdHJpZGUgPSBpbnQoYmxvY2tbJ3N0cmlkZSddKQogICAgICAgICAgICAgICAgb3V0X2ZpbHRlcnMuYXBwZW5kKHByZXZfZmlsdGVycykKICAgICAgICAgICAgICAgIHByZXZfc3RyaWRlID0gcHJldl9zdHJpZGUgLy8gc3RyaWRlCiAgICAgICAgICAgICAgICBvdXRfc3RyaWRlcy5hcHBlbmQocHJldl9zdHJpZGUpCgogICAgICAgICAgICAgICAgbW9kZWxzLmFwcGVuZChVcHNhbXBsZV9leHBhbmQoc3RyaWRlKSkKICAgICAgICAgICAgICAgICMgbW9kZWxzLmFwcGVuZChVcHNhbXBsZV9pbnRlcnBvbGF0ZShzdHJpZGUpKQoKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdyb3V0ZSc6CiAgICAgICAgICAgICAgICBsYXllcnMgPSBibG9ja1snbGF5ZXJzJ10uc3BsaXQoJywnKQogICAgICAgICAgICAgICAgaW5kID0gbGVuKG1vZGVscykKICAgICAgICAgICAgICAgIGxheWVycyA9IFtpbnQoaSkgaWYgaW50KGkpID4gMCBlbHNlIGludChpKSArIGluZCBmb3IgaSBpbiBsYXllcnNdCiAgICAgICAgICAgICAgICBpZiBsZW4obGF5ZXJzKSA9PSAxOgogICAgICAgICAgICAgICAgICAgIGlmICdncm91cHMnIG5vdCBpbiBibG9jay5rZXlzKCkgb3IgaW50KGJsb2NrWydncm91cHMnXSkgPT0gMToKICAgICAgICAgICAgICAgICAgICAgICAgcHJldl9maWx0ZXJzID0gb3V0X2ZpbHRlcnNbbGF5ZXJzWzBdXQogICAgICAgICAgICAgICAgICAgICAgICBwcmV2X3N0cmlkZSA9IG91dF9zdHJpZGVzW2xheWVyc1swXV0KICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmV2X2ZpbHRlcnMgPSBvdXRfZmlsdGVyc1tsYXllcnNbMF1dIC8vIGludChibG9ja1snZ3JvdXBzJ10pCiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZfc3RyaWRlID0gb3V0X3N0cmlkZXNbbGF5ZXJzWzBdXSAvLyBpbnQoYmxvY2tbJ2dyb3VwcyddKQogICAgICAgICAgICAgICAgZWxpZiBsZW4obGF5ZXJzKSA9PSAyOgogICAgICAgICAgICAgICAgICAgIGFzc2VydCAobGF5ZXJzWzBdID09IGluZCAtIDEgb3IgbGF5ZXJzWzFdID09IGluZCAtIDEpCiAgICAgICAgICAgICAgICAgICAgcHJldl9maWx0ZXJzID0gb3V0X2ZpbHRlcnNbbGF5ZXJzWzBdXSArIG91dF9maWx0ZXJzW2xheWVyc1sxXV0KICAgICAgICAgICAgICAgICAgICBwcmV2X3N0cmlkZSA9IG91dF9zdHJpZGVzW2xheWVyc1swXV0KICAgICAgICAgICAgICAgIGVsaWYgbGVuKGxheWVycykgPT0gNDoKICAgICAgICAgICAgICAgICAgICBhc3NlcnQgKGxheWVyc1swXSA9PSBpbmQgLSAxKQogICAgICAgICAgICAgICAgICAgIHByZXZfZmlsdGVycyA9IG91dF9maWx0ZXJzW2xheWVyc1swXV0gKyBvdXRfZmlsdGVyc1tsYXllcnNbMV1dICsgb3V0X2ZpbHRlcnNbbGF5ZXJzWzJdXSArIFwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRfZmlsdGVyc1tsYXllcnNbM11dCiAgICAgICAgICAgICAgICAgICAgcHJldl9zdHJpZGUgPSBvdXRfc3RyaWRlc1tsYXllcnNbMF1dCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50KCJyb3V0ZSBlcnJvciEhISIpCgogICAgICAgICAgICAgICAgb3V0X2ZpbHRlcnMuYXBwZW5kKHByZXZfZmlsdGVycykKICAgICAgICAgICAgICAgIG91dF9zdHJpZGVzLmFwcGVuZChwcmV2X3N0cmlkZSkKICAgICAgICAgICAgICAgIG1vZGVscy5hcHBlbmQoRW1wdHlNb2R1bGUoKSkKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdzaG9ydGN1dCc6CiAgICAgICAgICAgICAgICBpbmQgPSBsZW4obW9kZWxzKQogICAgICAgICAgICAgICAgcHJldl9maWx0ZXJzID0gb3V0X2ZpbHRlcnNbaW5kIC0gMV0KICAgICAgICAgICAgICAgIG91dF9maWx0ZXJzLmFwcGVuZChwcmV2X2ZpbHRlcnMpCiAgICAgICAgICAgICAgICBwcmV2X3N0cmlkZSA9IG91dF9zdHJpZGVzW2luZCAtIDFdCiAgICAgICAgICAgICAgICBvdXRfc3RyaWRlcy5hcHBlbmQocHJldl9zdHJpZGUpCiAgICAgICAgICAgICAgICBtb2RlbHMuYXBwZW5kKEVtcHR5TW9kdWxlKCkpCiAgICAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAnc2FtJzoKICAgICAgICAgICAgICAgIGluZCA9IGxlbihtb2RlbHMpCiAgICAgICAgICAgICAgICBwcmV2X2ZpbHRlcnMgPSBvdXRfZmlsdGVyc1tpbmQgLSAxXQogICAgICAgICAgICAgICAgb3V0X2ZpbHRlcnMuYXBwZW5kKHByZXZfZmlsdGVycykKICAgICAgICAgICAgICAgIHByZXZfc3RyaWRlID0gb3V0X3N0cmlkZXNbaW5kIC0gMV0KICAgICAgICAgICAgICAgIG91dF9zdHJpZGVzLmFwcGVuZChwcmV2X3N0cmlkZSkKICAgICAgICAgICAgICAgIG1vZGVscy5hcHBlbmQoRW1wdHlNb2R1bGUoKSkKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdjb25uZWN0ZWQnOgogICAgICAgICAgICAgICAgZmlsdGVycyA9IGludChibG9ja1snb3V0cHV0J10pCiAgICAgICAgICAgICAgICBpZiBibG9ja1snYWN0aXZhdGlvbiddID09ICdsaW5lYXInOgogICAgICAgICAgICAgICAgICAgIG1vZGVsID0gbm4uTGluZWFyKHByZXZfZmlsdGVycywgZmlsdGVycykKICAgICAgICAgICAgICAgIGVsaWYgYmxvY2tbJ2FjdGl2YXRpb24nXSA9PSAnbGVha3knOgogICAgICAgICAgICAgICAgICAgIG1vZGVsID0gbm4uU2VxdWVudGlhbCgKICAgICAgICAgICAgICAgICAgICAgICAgbm4uTGluZWFyKHByZXZfZmlsdGVycywgZmlsdGVycyksCiAgICAgICAgICAgICAgICAgICAgICAgIG5uLkxlYWt5UmVMVSgwLjEsIGlucGxhY2U9VHJ1ZSkpCiAgICAgICAgICAgICAgICBlbGlmIGJsb2NrWydhY3RpdmF0aW9uJ10gPT0gJ3JlbHUnOgogICAgICAgICAgICAgICAgICAgIG1vZGVsID0gbm4uU2VxdWVudGlhbCgKICAgICAgICAgICAgICAgICAgICAgICAgbm4uTGluZWFyKHByZXZfZmlsdGVycywgZmlsdGVycyksCiAgICAgICAgICAgICAgICAgICAgICAgIG5uLlJlTFUoaW5wbGFjZT1UcnVlKSkKICAgICAgICAgICAgICAgIHByZXZfZmlsdGVycyA9IGZpbHRlcnMKICAgICAgICAgICAgICAgIG91dF9maWx0ZXJzLmFwcGVuZChwcmV2X2ZpbHRlcnMpCiAgICAgICAgICAgICAgICBvdXRfc3RyaWRlcy5hcHBlbmQocHJldl9zdHJpZGUpCiAgICAgICAgICAgICAgICBtb2RlbHMuYXBwZW5kKG1vZGVsKQogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ3JlZ2lvbic6CiAgICAgICAgICAgICAgICBsb3NzID0gUmVnaW9uTG9zcygpCiAgICAgICAgICAgICAgICBhbmNob3JzID0gYmxvY2tbJ2FuY2hvcnMnXS5zcGxpdCgnLCcpCiAgICAgICAgICAgICAgICBsb3NzLmFuY2hvcnMgPSBbZmxvYXQoaSkgZm9yIGkgaW4gYW5jaG9yc10KICAgICAgICAgICAgICAgIGxvc3MubnVtX2NsYXNzZXMgPSBpbnQoYmxvY2tbJ2NsYXNzZXMnXSkKICAgICAgICAgICAgICAgIGxvc3MubnVtX2FuY2hvcnMgPSBpbnQoYmxvY2tbJ251bSddKQogICAgICAgICAgICAgICAgbG9zcy5hbmNob3Jfc3RlcCA9IGxlbihsb3NzLmFuY2hvcnMpIC8vIGxvc3MubnVtX2FuY2hvcnMKICAgICAgICAgICAgICAgIGxvc3Mub2JqZWN0X3NjYWxlID0gZmxvYXQoYmxvY2tbJ29iamVjdF9zY2FsZSddKQogICAgICAgICAgICAgICAgbG9zcy5ub29iamVjdF9zY2FsZSA9IGZsb2F0KGJsb2NrWydub29iamVjdF9zY2FsZSddKQogICAgICAgICAgICAgICAgbG9zcy5jbGFzc19zY2FsZSA9IGZsb2F0KGJsb2NrWydjbGFzc19zY2FsZSddKQogICAgICAgICAgICAgICAgbG9zcy5jb29yZF9zY2FsZSA9IGZsb2F0KGJsb2NrWydjb29yZF9zY2FsZSddKQogICAgICAgICAgICAgICAgb3V0X2ZpbHRlcnMuYXBwZW5kKHByZXZfZmlsdGVycykKICAgICAgICAgICAgICAgIG91dF9zdHJpZGVzLmFwcGVuZChwcmV2X3N0cmlkZSkKICAgICAgICAgICAgICAgIG1vZGVscy5hcHBlbmQobG9zcykKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICd5b2xvJzoKICAgICAgICAgICAgICAgIHlvbG9fbGF5ZXIgPSBZb2xvTGF5ZXIoKQogICAgICAgICAgICAgICAgYW5jaG9ycyA9IGJsb2NrWydhbmNob3JzJ10uc3BsaXQoJywnKQogICAgICAgICAgICAgICAgYW5jaG9yX21hc2sgPSBibG9ja1snbWFzayddLnNwbGl0KCcsJykKICAgICAgICAgICAgICAgIHlvbG9fbGF5ZXIuYW5jaG9yX21hc2sgPSBbaW50KGkpIGZvciBpIGluIGFuY2hvcl9tYXNrXQogICAgICAgICAgICAgICAgeW9sb19sYXllci5hbmNob3JzID0gW2Zsb2F0KGkpIGZvciBpIGluIGFuY2hvcnNdCiAgICAgICAgICAgICAgICB5b2xvX2xheWVyLm51bV9jbGFzc2VzID0gaW50KGJsb2NrWydjbGFzc2VzJ10pCiAgICAgICAgICAgICAgICBzZWxmLm51bV9jbGFzc2VzID0geW9sb19sYXllci5udW1fY2xhc3NlcwogICAgICAgICAgICAgICAgeW9sb19sYXllci5udW1fYW5jaG9ycyA9IGludChibG9ja1snbnVtJ10pCiAgICAgICAgICAgICAgICB5b2xvX2xheWVyLmFuY2hvcl9zdGVwID0gbGVuKHlvbG9fbGF5ZXIuYW5jaG9ycykgLy8geW9sb19sYXllci5udW1fYW5jaG9ycwogICAgICAgICAgICAgICAgeW9sb19sYXllci5zdHJpZGUgPSBwcmV2X3N0cmlkZQogICAgICAgICAgICAgICAgeW9sb19sYXllci5zY2FsZV94X3kgPSBmbG9hdChibG9ja1snc2NhbGVfeF95J10pCiAgICAgICAgICAgICAgICAjIHlvbG9fbGF5ZXIub2JqZWN0X3NjYWxlID0gZmxvYXQoYmxvY2tbJ29iamVjdF9zY2FsZSddKQogICAgICAgICAgICAgICAgIyB5b2xvX2xheWVyLm5vb2JqZWN0X3NjYWxlID0gZmxvYXQoYmxvY2tbJ25vb2JqZWN0X3NjYWxlJ10pCiAgICAgICAgICAgICAgICAjIHlvbG9fbGF5ZXIuY2xhc3Nfc2NhbGUgPSBmbG9hdChibG9ja1snY2xhc3Nfc2NhbGUnXSkKICAgICAgICAgICAgICAgICMgeW9sb19sYXllci5jb29yZF9zY2FsZSA9IGZsb2F0KGJsb2NrWydjb29yZF9zY2FsZSddKQogICAgICAgICAgICAgICAgb3V0X2ZpbHRlcnMuYXBwZW5kKHByZXZfZmlsdGVycykKICAgICAgICAgICAgICAgIG91dF9zdHJpZGVzLmFwcGVuZChwcmV2X3N0cmlkZSkKICAgICAgICAgICAgICAgIG1vZGVscy5hcHBlbmQoeW9sb19sYXllcikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KCd1bmtub3duIHR5cGUgJXMnICUgKGJsb2NrWyd0eXBlJ10pKQoKICAgICAgICByZXR1cm4gbW9kZWxzCgogICAgZGVmIGxvYWRfd2VpZ2h0cyhzZWxmLCB3ZWlnaHRmaWxlKToKICAgICAgICBmcCA9IG9wZW4od2VpZ2h0ZmlsZSwgJ3JiJykKICAgICAgICBoZWFkZXIgPSBucC5mcm9tZmlsZShmcCwgY291bnQ9NSwgZHR5cGU9bnAuaW50MzIpCiAgICAgICAgc2VsZi5oZWFkZXIgPSB0b3JjaC5mcm9tX251bXB5KGhlYWRlcikKICAgICAgICBzZWxmLnNlZW4gPSBzZWxmLmhlYWRlclszXQogICAgICAgIGJ1ZiA9IG5wLmZyb21maWxlKGZwLCBkdHlwZT1ucC5mbG9hdDMyKQogICAgICAgIGZwLmNsb3NlKCkKCiAgICAgICAgc3RhcnQgPSAwCiAgICAgICAgaW5kID0gLTIKICAgICAgICBmb3IgYmxvY2sgaW4gc2VsZi5ibG9ja3M6CiAgICAgICAgICAgIGlmIHN0YXJ0ID49IGJ1Zi5zaXplOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgaW5kID0gaW5kICsgMQogICAgICAgICAgICBpZiBibG9ja1sndHlwZSddID09ICduZXQnOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdjb252b2x1dGlvbmFsJzoKICAgICAgICAgICAgICAgIG1vZGVsID0gc2VsZi5tb2RlbHNbaW5kXQogICAgICAgICAgICAgICAgYmF0Y2hfbm9ybWFsaXplID0gaW50KGJsb2NrWydiYXRjaF9ub3JtYWxpemUnXSkKICAgICAgICAgICAgICAgIGlmIGJhdGNoX25vcm1hbGl6ZToKICAgICAgICAgICAgICAgICAgICBzdGFydCA9IGxvYWRfY29udl9ibihidWYsIHN0YXJ0LCBtb2RlbFswXSwgbW9kZWxbMV0pCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHN0YXJ0ID0gbG9hZF9jb252KGJ1Ziwgc3RhcnQsIG1vZGVsWzBdKQogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ2Nvbm5lY3RlZCc6CiAgICAgICAgICAgICAgICBtb2RlbCA9IHNlbGYubW9kZWxzW2luZF0KICAgICAgICAgICAgICAgIGlmIGJsb2NrWydhY3RpdmF0aW9uJ10gIT0gJ2xpbmVhcic6CiAgICAgICAgICAgICAgICAgICAgc3RhcnQgPSBsb2FkX2ZjKGJ1Ziwgc3RhcnQsIG1vZGVsWzBdKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzdGFydCA9IGxvYWRfZmMoYnVmLCBzdGFydCwgbW9kZWwpCiAgICAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAnbWF4cG9vbCc6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAncmVvcmcnOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ3Vwc2FtcGxlJzoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdyb3V0ZSc6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAnc2hvcnRjdXQnOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ3NhbSc6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAncmVnaW9uJzoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICd5b2xvJzoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdhdmdwb29sJzoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdzb2Z0bWF4JzoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdjb3N0JzoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KCd1bmtub3duIHR5cGUgJXMnICUgKGJsb2NrWyd0eXBlJ10pKQoKICAgICMgZGVmIHNhdmVfd2VpZ2h0cyhzZWxmLCBvdXRmaWxlLCBjdXRvZmY9MCk6CiAgICAjICAgICBpZiBjdXRvZmYgPD0gMDoKICAgICMgICAgICAgICBjdXRvZmYgPSBsZW4oc2VsZi5ibG9ja3MpIC0gMQogICAgIwogICAgIyAgICAgZnAgPSBvcGVuKG91dGZpbGUsICd3YicpCiAgICAjICAgICBzZWxmLmhlYWRlclszXSA9IHNlbGYuc2VlbgogICAgIyAgICAgaGVhZGVyID0gc2VsZi5oZWFkZXIKICAgICMgICAgIGhlYWRlci5udW1weSgpLnRvZmlsZShmcCkKICAgICMKICAgICMgICAgIGluZCA9IC0xCiAgICAjICAgICBmb3IgYmxvY2tJZCBpbiByYW5nZSgxLCBjdXRvZmYgKyAxKToKICAgICMgICAgICAgICBpbmQgPSBpbmQgKyAxCiAgICAjICAgICAgICAgYmxvY2sgPSBzZWxmLmJsb2Nrc1tibG9ja0lkXQogICAgIyAgICAgICAgIGlmIGJsb2NrWyd0eXBlJ10gPT0gJ2NvbnZvbHV0aW9uYWwnOgogICAgIyAgICAgICAgICAgICBtb2RlbCA9IHNlbGYubW9kZWxzW2luZF0KICAgICMgICAgICAgICAgICAgYmF0Y2hfbm9ybWFsaXplID0gaW50KGJsb2NrWydiYXRjaF9ub3JtYWxpemUnXSkKICAgICMgICAgICAgICAgICAgaWYgYmF0Y2hfbm9ybWFsaXplOgogICAgIyAgICAgICAgICAgICAgICAgc2F2ZV9jb252X2JuKGZwLCBtb2RlbFswXSwgbW9kZWxbMV0pCiAgICAjICAgICAgICAgICAgIGVsc2U6CiAgICAjICAgICAgICAgICAgICAgICBzYXZlX2NvbnYoZnAsIG1vZGVsWzBdKQogICAgIyAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAnY29ubmVjdGVkJzoKICAgICMgICAgICAgICAgICAgbW9kZWwgPSBzZWxmLm1vZGVsc1tpbmRdCiAgICAjICAgICAgICAgICAgIGlmIGJsb2NrWydhY3RpdmF0aW9uJ10gIT0gJ2xpbmVhcic6CiAgICAjICAgICAgICAgICAgICAgICBzYXZlX2ZjKGZjLCBtb2RlbCkKICAgICMgICAgICAgICAgICAgZWxzZToKICAgICMgICAgICAgICAgICAgICAgIHNhdmVfZmMoZmMsIG1vZGVsWzBdKQogICAgIyAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAnbWF4cG9vbCc6CiAgICAjICAgICAgICAgICAgIHBhc3MKICAgICMgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ3Jlb3JnJzoKICAgICMgICAgICAgICAgICAgcGFzcwogICAgIyAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAndXBzYW1wbGUnOgogICAgIyAgICAgICAgICAgICBwYXNzCiAgICAjICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdyb3V0ZSc6CiAgICAjICAgICAgICAgICAgIHBhc3MKICAgICMgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ3Nob3J0Y3V0JzoKICAgICMgICAgICAgICAgICAgcGFzcwogICAgIyAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAnc2FtJzoKICAgICMgICAgICAgICAgICAgcGFzcwogICAgIyAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAncmVnaW9uJzoKICAgICMgICAgICAgICAgICAgcGFzcwogICAgIyAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAneW9sbyc6CiAgICAjICAgICAgICAgICAgIHBhc3MKICAgICMgICAgICAgICBlbGlmIGJsb2NrWyd0eXBlJ10gPT0gJ2F2Z3Bvb2wnOgogICAgIyAgICAgICAgICAgICBwYXNzCiAgICAjICAgICAgICAgZWxpZiBibG9ja1sndHlwZSddID09ICdzb2Z0bWF4JzoKICAgICMgICAgICAgICAgICAgcGFzcwogICAgIyAgICAgICAgIGVsaWYgYmxvY2tbJ3R5cGUnXSA9PSAnY29zdCc6CiAgICAjICAgICAgICAgICAgIHBhc3MKICAgICMgICAgICAgICBlbHNlOgogICAgIyAgICAgICAgICAgICBwcmludCgndW5rbm93biB0eXBlICVzJyAlIChibG9ja1sndHlwZSddKSkKICAgICMgICAgIGZwLmNsb3NlKCkK')
    file.write(darknet2pytorch_string)

with open(root + "YOLOv4" + "/tool/yolo_layer.py", "wb") as file:
    darknet2pytorch_string = base64.b64decode(b'aW1wb3J0IHRvcmNoLm5uIGFzIG5uCmltcG9ydCB0b3JjaC5ubi5mdW5jdGlvbmFsIGFzIEYKCiN0b2RvIGZpeAp0cnk6CiAgICBmcm9tIHRvb2wudG9yY2hfdXRpbHMgaW1wb3J0ICoKZXhjZXB0IEltcG9ydEVycm9yOgogICAgZnJvbSBZT0xPdjQudG9vbC50b3JjaF91dGlscyBpbXBvcnQgKgoKZGVmIHlvbG9fZm9yd2FyZChvdXRwdXQsIGNvbmZfdGhyZXNoLCBudW1fY2xhc3NlcywgYW5jaG9ycywgbnVtX2FuY2hvcnMsIHNjYWxlX3hfeSwgb25seV9vYmplY3RuZXNzPTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb249RmFsc2UpOgogICAgIyBPdXRwdXQgd291bGQgYmUgaW52YWxpZCBpZiBpdCBkb2VzIG5vdCBzYXRpc2Z5IHRoaXMgYXNzZXJ0CiAgICAjIGFzc2VydCAob3V0cHV0LnNpemUoMSkgPT0gKDUgKyBudW1fY2xhc3NlcykgKiBudW1fYW5jaG9ycykKCiAgICAjIHByaW50KG91dHB1dC5zaXplKCkpCgogICAgIyBTbGljZSB0aGUgc2Vjb25kIGRpbWVuc2lvbiAoY2hhbm5lbCkgb2Ygb3V0cHV0IGludG86CiAgICAjIFsgMiwgMiwgMSwgbnVtX2NsYXNzZXMsIDIsIDIsIDEsIG51bV9jbGFzc2VzLCAyLCAyLCAxLCBudW1fY2xhc3NlcyBdCiAgICAjIEFuZCB0aGVuIGludG8KICAgICMgYnh5ID0gWyA2IF0gYndoID0gWyA2IF0gZGV0X2NvbmYgPSBbIDMgXSBjbHNfY29uZiA9IFsgbnVtX2NsYXNzZXMgKiAzIF0KICAgIGJhdGNoID0gb3V0cHV0LnNpemUoMCkKICAgIEggPSBvdXRwdXQuc2l6ZSgyKQogICAgVyA9IG91dHB1dC5zaXplKDMpCgogICAgYnh5X2xpc3QgPSBbXQogICAgYndoX2xpc3QgPSBbXQogICAgZGV0X2NvbmZzX2xpc3QgPSBbXQogICAgY2xzX2NvbmZzX2xpc3QgPSBbXQoKICAgIGZvciBpIGluIHJhbmdlKG51bV9hbmNob3JzKToKICAgICAgICBiZWdpbiA9IGkgKiAoNSArIG51bV9jbGFzc2VzKQogICAgICAgIGVuZCA9IChpICsgMSkgKiAoNSArIG51bV9jbGFzc2VzKQogICAgICAgIAogICAgICAgIGJ4eV9saXN0LmFwcGVuZChvdXRwdXRbOiwgYmVnaW4gOiBiZWdpbiArIDJdKQogICAgICAgIGJ3aF9saXN0LmFwcGVuZChvdXRwdXRbOiwgYmVnaW4gKyAyIDogYmVnaW4gKyA0XSkKICAgICAgICBkZXRfY29uZnNfbGlzdC5hcHBlbmQob3V0cHV0WzosIGJlZ2luICsgNCA6IGJlZ2luICsgNV0pCiAgICAgICAgY2xzX2NvbmZzX2xpc3QuYXBwZW5kKG91dHB1dFs6LCBiZWdpbiArIDUgOiBlbmRdKQoKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiAyLCBILCBXXQogICAgYnh5ID0gdG9yY2guY2F0KGJ4eV9saXN0LCBkaW09MSkKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiAyLCBILCBXXQogICAgYndoID0gdG9yY2guY2F0KGJ3aF9saXN0LCBkaW09MSkKCiAgICAjIFNoYXBlOiBbYmF0Y2gsIG51bV9hbmNob3JzLCBILCBXXQogICAgZGV0X2NvbmZzID0gdG9yY2guY2F0KGRldF9jb25mc19saXN0LCBkaW09MSkKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBIICogV10KICAgIGRldF9jb25mcyA9IGRldF9jb25mcy52aWV3KGJhdGNoLCBudW1fYW5jaG9ycyAqIEggKiBXKQoKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBudW1fY2xhc3NlcywgSCwgV10KICAgIGNsc19jb25mcyA9IHRvcmNoLmNhdChjbHNfY29uZnNfbGlzdCwgZGltPTEpCiAgICAjIFNoYXBlOiBbYmF0Y2gsIG51bV9hbmNob3JzLCBudW1fY2xhc3NlcywgSCAqIFddCiAgICBjbHNfY29uZnMgPSBjbHNfY29uZnMudmlldyhiYXRjaCwgbnVtX2FuY2hvcnMsIG51bV9jbGFzc2VzLCBIICogVykKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMsIG51bV9jbGFzc2VzLCBIICogV10gLS0+IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBIICogVywgbnVtX2NsYXNzZXNdIAogICAgY2xzX2NvbmZzID0gY2xzX2NvbmZzLnBlcm11dGUoMCwgMSwgMywgMikucmVzaGFwZShiYXRjaCwgbnVtX2FuY2hvcnMgKiBIICogVywgbnVtX2NsYXNzZXMpCgogICAgIyBBcHBseSBzaWdtb2lkKCksIGV4cCgpIGFuZCBzb2Z0bWF4KCkgdG8gc2xpY2VzCiAgICAjCiAgICBieHkgPSB0b3JjaC5zaWdtb2lkKGJ4eSkgKiBzY2FsZV94X3kgLSAwLjUgKiAoc2NhbGVfeF95IC0gMSkKICAgIGJ3aCA9IHRvcmNoLmV4cChid2gpCiAgICBkZXRfY29uZnMgPSB0b3JjaC5zaWdtb2lkKGRldF9jb25mcykKICAgIGNsc19jb25mcyA9IHRvcmNoLnNpZ21vaWQoY2xzX2NvbmZzKQoKICAgICMgUHJlcGFyZSBDLXgsIEMteSwgUC13LCBQLWggKE5vbmUgb2YgdGhlbSBhcmUgdG9yY2ggcmVsYXRlZCkKICAgIGdyaWRfeCA9IG5wLmV4cGFuZF9kaW1zKG5wLmV4cGFuZF9kaW1zKG5wLmV4cGFuZF9kaW1zKG5wLmxpbnNwYWNlKDAsIFcgLSAxLCBXKSwgYXhpcz0wKS5yZXBlYXQoSCwgMCksIGF4aXM9MCksIGF4aXM9MCkKICAgIGdyaWRfeSA9IG5wLmV4cGFuZF9kaW1zKG5wLmV4cGFuZF9kaW1zKG5wLmV4cGFuZF9kaW1zKG5wLmxpbnNwYWNlKDAsIEggLSAxLCBIKSwgYXhpcz0xKS5yZXBlYXQoVywgMSksIGF4aXM9MCksIGF4aXM9MCkKICAgICMgZ3JpZF94ID0gdG9yY2gubGluc3BhY2UoMCwgVyAtIDEsIFcpLnJlc2hhcGUoMSwgMSwgMSwgVykucmVwZWF0KDEsIDEsIEgsIDEpCiAgICAjIGdyaWRfeSA9IHRvcmNoLmxpbnNwYWNlKDAsIEggLSAxLCBIKS5yZXNoYXBlKDEsIDEsIEgsIDEpLnJlcGVhdCgxLCAxLCAxLCBXKQoKICAgIGFuY2hvcl93ID0gW10KICAgIGFuY2hvcl9oID0gW10KICAgIGZvciBpIGluIHJhbmdlKG51bV9hbmNob3JzKToKICAgICAgICBhbmNob3Jfdy5hcHBlbmQoYW5jaG9yc1tpICogMl0pCiAgICAgICAgYW5jaG9yX2guYXBwZW5kKGFuY2hvcnNbaSAqIDIgKyAxXSkKCiAgICBkZXZpY2UgPSBOb25lCiAgICBjdWRhX2NoZWNrID0gb3V0cHV0LmlzX2N1ZGEKICAgIGlmIGN1ZGFfY2hlY2s6CiAgICAgICAgZGV2aWNlID0gb3V0cHV0LmdldF9kZXZpY2UoKQoKICAgIGJ4X2xpc3QgPSBbXQogICAgYnlfbGlzdCA9IFtdCiAgICBid19saXN0ID0gW10KICAgIGJoX2xpc3QgPSBbXQoKICAgICMgQXBwbHkgQy14LCBDLXksIFAtdywgUC1oCiAgICBmb3IgaSBpbiByYW5nZShudW1fYW5jaG9ycyk6CiAgICAgICAgaWkgPSBpICogMgogICAgICAgICMgU2hhcGU6IFtiYXRjaCwgMSwgSCwgV10KICAgICAgICBieCA9IGJ4eVs6LCBpaSA6IGlpICsgMV0gKyB0b3JjaC50ZW5zb3IoZ3JpZF94LCBkZXZpY2U9ZGV2aWNlLCBkdHlwZT10b3JjaC5mbG9hdDMyKSAjIGdyaWRfeC50byhkZXZpY2U9ZGV2aWNlLCBkdHlwZT10b3JjaC5mbG9hdDMyKQogICAgICAgICMgU2hhcGU6IFtiYXRjaCwgMSwgSCwgV10KICAgICAgICBieSA9IGJ4eVs6LCBpaSArIDEgOiBpaSArIDJdICsgdG9yY2gudGVuc29yKGdyaWRfeSwgZGV2aWNlPWRldmljZSwgZHR5cGU9dG9yY2guZmxvYXQzMikgIyBncmlkX3kudG8oZGV2aWNlPWRldmljZSwgZHR5cGU9dG9yY2guZmxvYXQzMikKICAgICAgICAjIFNoYXBlOiBbYmF0Y2gsIDEsIEgsIFddCiAgICAgICAgYncgPSBid2hbOiwgaWkgOiBpaSArIDFdICogYW5jaG9yX3dbaV0KICAgICAgICAjIFNoYXBlOiBbYmF0Y2gsIDEsIEgsIFddCiAgICAgICAgYmggPSBid2hbOiwgaWkgKyAxIDogaWkgKyAyXSAqIGFuY2hvcl9oW2ldCgogICAgICAgIGJ4X2xpc3QuYXBwZW5kKGJ4KQogICAgICAgIGJ5X2xpc3QuYXBwZW5kKGJ5KQogICAgICAgIGJ3X2xpc3QuYXBwZW5kKGJ3KQogICAgICAgIGJoX2xpc3QuYXBwZW5kKGJoKQoKCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAjICAgRmlndXJlIG91dCBiYm94ZXMgZnJvbSBzbGljZXMgICAgICMKICAgICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgIAogICAgIyBTaGFwZTogW2JhdGNoLCBudW1fYW5jaG9ycywgSCwgV10KICAgIGJ4ID0gdG9yY2guY2F0KGJ4X2xpc3QsIGRpbT0xKQogICAgIyBTaGFwZTogW2JhdGNoLCBudW1fYW5jaG9ycywgSCwgV10KICAgIGJ5ID0gdG9yY2guY2F0KGJ5X2xpc3QsIGRpbT0xKQogICAgIyBTaGFwZTogW2JhdGNoLCBudW1fYW5jaG9ycywgSCwgV10KICAgIGJ3ID0gdG9yY2guY2F0KGJ3X2xpc3QsIGRpbT0xKQogICAgIyBTaGFwZTogW2JhdGNoLCBudW1fYW5jaG9ycywgSCwgV10KICAgIGJoID0gdG9yY2guY2F0KGJoX2xpc3QsIGRpbT0xKQoKICAgICMgU2hhcGU6IFtiYXRjaCwgMiAqIG51bV9hbmNob3JzLCBILCBXXQogICAgYnhfYncgPSB0b3JjaC5jYXQoKGJ4LCBidyksIGRpbT0xKQogICAgIyBTaGFwZTogW2JhdGNoLCAyICogbnVtX2FuY2hvcnMsIEgsIFddCiAgICBieV9iaCA9IHRvcmNoLmNhdCgoYnksIGJoKSwgZGltPTEpCgogICAgIyBub3JtYWxpemUgY29vcmRpbmF0ZXMgdG8gWzAsIDFdCiAgICBieF9idyAvPSBXCiAgICBieV9iaCAvPSBICgogICAgIyBTaGFwZTogW2JhdGNoLCBudW1fYW5jaG9ycyAqIEggKiBXLCAxXQogICAgYnggPSBieF9id1s6LCA6bnVtX2FuY2hvcnNdLnZpZXcoYmF0Y2gsIG51bV9hbmNob3JzICogSCAqIFcsIDEpCiAgICBieSA9IGJ5X2JoWzosIDpudW1fYW5jaG9yc10udmlldyhiYXRjaCwgbnVtX2FuY2hvcnMgKiBIICogVywgMSkKICAgIGJ3ID0gYnhfYndbOiwgbnVtX2FuY2hvcnM6XS52aWV3KGJhdGNoLCBudW1fYW5jaG9ycyAqIEggKiBXLCAxKQogICAgYmggPSBieV9iaFs6LCBudW1fYW5jaG9yczpdLnZpZXcoYmF0Y2gsIG51bV9hbmNob3JzICogSCAqIFcsIDEpCgogICAgYngxID0gYnggLSBidyAqIDAuNQogICAgYnkxID0gYnkgLSBiaCAqIDAuNQogICAgYngyID0gYngxICsgYncKICAgIGJ5MiA9IGJ5MSArIGJoCgogICAgIyBTaGFwZTogW2JhdGNoLCBudW1fYW5jaG9ycyAqIGggKiB3LCA0XSAtPiBbYmF0Y2gsIG51bV9hbmNob3JzICogaCAqIHcsIDEsIDRdCiAgICBib3hlcyA9IHRvcmNoLmNhdCgoYngxLCBieTEsIGJ4MiwgYnkyKSwgZGltPTIpLnZpZXcoYmF0Y2gsIG51bV9hbmNob3JzICogSCAqIFcsIDEsIDQpCiAgICAjIGJveGVzID0gYm94ZXMucmVwZWF0KDEsIDEsIG51bV9jbGFzc2VzLCAxKQoKICAgICMgYm94ZXM6ICAgICBbYmF0Y2gsIG51bV9hbmNob3JzICogSCAqIFcsIDEsIDRdCiAgICAjIGNsc19jb25mczogW2JhdGNoLCBudW1fYW5jaG9ycyAqIEggKiBXLCBudW1fY2xhc3Nlc10KICAgICMgZGV0X2NvbmZzOiBbYmF0Y2gsIG51bV9hbmNob3JzICogSCAqIFddCgogICAgZGV0X2NvbmZzID0gZGV0X2NvbmZzLnZpZXcoYmF0Y2gsIG51bV9hbmNob3JzICogSCAqIFcsIDEpCiAgICBjb25mcyA9IGNsc19jb25mcyAqIGRldF9jb25mcwoKICAgICMgYm94ZXM6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBIICogVywgMSwgNF0KICAgICMgY29uZnM6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBIICogVywgbnVtX2NsYXNzZXNdCgogICAgcmV0dXJuICBib3hlcywgY29uZnMKCgpkZWYgeW9sb19mb3J3YXJkX2R5bmFtaWMob3V0cHV0LCBjb25mX3RocmVzaCwgbnVtX2NsYXNzZXMsIGFuY2hvcnMsIG51bV9hbmNob3JzLCBzY2FsZV94X3ksIG9ubHlfb2JqZWN0bmVzcz0xLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uPUZhbHNlKToKICAgICMgT3V0cHV0IHdvdWxkIGJlIGludmFsaWQgaWYgaXQgZG9lcyBub3Qgc2F0aXNmeSB0aGlzIGFzc2VydAogICAgIyBhc3NlcnQgKG91dHB1dC5zaXplKDEpID09ICg1ICsgbnVtX2NsYXNzZXMpICogbnVtX2FuY2hvcnMpCgogICAgIyBwcmludChvdXRwdXQuc2l6ZSgpKQoKICAgICMgU2xpY2UgdGhlIHNlY29uZCBkaW1lbnNpb24gKGNoYW5uZWwpIG9mIG91dHB1dCBpbnRvOgogICAgIyBbIDIsIDIsIDEsIG51bV9jbGFzc2VzLCAyLCAyLCAxLCBudW1fY2xhc3NlcywgMiwgMiwgMSwgbnVtX2NsYXNzZXMgXQogICAgIyBBbmQgdGhlbiBpbnRvCiAgICAjIGJ4eSA9IFsgNiBdIGJ3aCA9IFsgNiBdIGRldF9jb25mID0gWyAzIF0gY2xzX2NvbmYgPSBbIG51bV9jbGFzc2VzICogMyBdCiAgICAjIGJhdGNoID0gb3V0cHV0LnNpemUoMCkKICAgICMgSCA9IG91dHB1dC5zaXplKDIpCiAgICAjIFcgPSBvdXRwdXQuc2l6ZSgzKQoKICAgIGJ4eV9saXN0ID0gW10KICAgIGJ3aF9saXN0ID0gW10KICAgIGRldF9jb25mc19saXN0ID0gW10KICAgIGNsc19jb25mc19saXN0ID0gW10KCiAgICBmb3IgaSBpbiByYW5nZShudW1fYW5jaG9ycyk6CiAgICAgICAgYmVnaW4gPSBpICogKDUgKyBudW1fY2xhc3NlcykKICAgICAgICBlbmQgPSAoaSArIDEpICogKDUgKyBudW1fY2xhc3NlcykKICAgICAgICAKICAgICAgICBieHlfbGlzdC5hcHBlbmQob3V0cHV0WzosIGJlZ2luIDogYmVnaW4gKyAyXSkKICAgICAgICBid2hfbGlzdC5hcHBlbmQob3V0cHV0WzosIGJlZ2luICsgMiA6IGJlZ2luICsgNF0pCiAgICAgICAgZGV0X2NvbmZzX2xpc3QuYXBwZW5kKG91dHB1dFs6LCBiZWdpbiArIDQgOiBiZWdpbiArIDVdKQogICAgICAgIGNsc19jb25mc19saXN0LmFwcGVuZChvdXRwdXRbOiwgYmVnaW4gKyA1IDogZW5kXSkKCiAgICAjIFNoYXBlOiBbYmF0Y2gsIG51bV9hbmNob3JzICogMiwgSCwgV10KICAgIGJ4eSA9IHRvcmNoLmNhdChieHlfbGlzdCwgZGltPTEpCiAgICAjIFNoYXBlOiBbYmF0Y2gsIG51bV9hbmNob3JzICogMiwgSCwgV10KICAgIGJ3aCA9IHRvcmNoLmNhdChid2hfbGlzdCwgZGltPTEpCgogICAgIyBTaGFwZTogW2JhdGNoLCBudW1fYW5jaG9ycywgSCwgV10KICAgIGRldF9jb25mcyA9IHRvcmNoLmNhdChkZXRfY29uZnNfbGlzdCwgZGltPTEpCiAgICAjIFNoYXBlOiBbYmF0Y2gsIG51bV9hbmNob3JzICogSCAqIFddCiAgICBkZXRfY29uZnMgPSBkZXRfY29uZnMudmlldyhvdXRwdXQuc2l6ZSgwKSwgbnVtX2FuY2hvcnMgKiBvdXRwdXQuc2l6ZSgyKSAqIG91dHB1dC5zaXplKDMpKQoKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBudW1fY2xhc3NlcywgSCwgV10KICAgIGNsc19jb25mcyA9IHRvcmNoLmNhdChjbHNfY29uZnNfbGlzdCwgZGltPTEpCiAgICAjIFNoYXBlOiBbYmF0Y2gsIG51bV9hbmNob3JzLCBudW1fY2xhc3NlcywgSCAqIFddCiAgICBjbHNfY29uZnMgPSBjbHNfY29uZnMudmlldyhvdXRwdXQuc2l6ZSgwKSwgbnVtX2FuY2hvcnMsIG51bV9jbGFzc2VzLCBvdXRwdXQuc2l6ZSgyKSAqIG91dHB1dC5zaXplKDMpKQogICAgIyBTaGFwZTogW2JhdGNoLCBudW1fYW5jaG9ycywgbnVtX2NsYXNzZXMsIEggKiBXXSAtLT4gW2JhdGNoLCBudW1fYW5jaG9ycyAqIEggKiBXLCBudW1fY2xhc3Nlc10gCiAgICBjbHNfY29uZnMgPSBjbHNfY29uZnMucGVybXV0ZSgwLCAxLCAzLCAyKS5yZXNoYXBlKG91dHB1dC5zaXplKDApLCBudW1fYW5jaG9ycyAqIG91dHB1dC5zaXplKDIpICogb3V0cHV0LnNpemUoMyksIG51bV9jbGFzc2VzKQoKICAgICMgQXBwbHkgc2lnbW9pZCgpLCBleHAoKSBhbmQgc29mdG1heCgpIHRvIHNsaWNlcwogICAgIwogICAgYnh5ID0gdG9yY2guc2lnbW9pZChieHkpICogc2NhbGVfeF95IC0gMC41ICogKHNjYWxlX3hfeSAtIDEpCiAgICBid2ggPSB0b3JjaC5leHAoYndoKQogICAgZGV0X2NvbmZzID0gdG9yY2guc2lnbW9pZChkZXRfY29uZnMpCiAgICBjbHNfY29uZnMgPSB0b3JjaC5zaWdtb2lkKGNsc19jb25mcykKCiAgICAjIFByZXBhcmUgQy14LCBDLXksIFAtdywgUC1oIChOb25lIG9mIHRoZW0gYXJlIHRvcmNoIHJlbGF0ZWQpCiAgICBncmlkX3ggPSBucC5leHBhbmRfZGltcyhucC5leHBhbmRfZGltcyhucC5leHBhbmRfZGltcyhucC5saW5zcGFjZSgwLCBvdXRwdXQuc2l6ZSgzKSAtIDEsIG91dHB1dC5zaXplKDMpKSwgYXhpcz0wKS5yZXBlYXQob3V0cHV0LnNpemUoMiksIDApLCBheGlzPTApLCBheGlzPTApCiAgICBncmlkX3kgPSBucC5leHBhbmRfZGltcyhucC5leHBhbmRfZGltcyhucC5leHBhbmRfZGltcyhucC5saW5zcGFjZSgwLCBvdXRwdXQuc2l6ZSgyKSAtIDEsIG91dHB1dC5zaXplKDIpKSwgYXhpcz0xKS5yZXBlYXQob3V0cHV0LnNpemUoMyksIDEpLCBheGlzPTApLCBheGlzPTApCiAgICAjIGdyaWRfeCA9IHRvcmNoLmxpbnNwYWNlKDAsIFcgLSAxLCBXKS5yZXNoYXBlKDEsIDEsIDEsIFcpLnJlcGVhdCgxLCAxLCBILCAxKQogICAgIyBncmlkX3kgPSB0b3JjaC5saW5zcGFjZSgwLCBIIC0gMSwgSCkucmVzaGFwZSgxLCAxLCBILCAxKS5yZXBlYXQoMSwgMSwgMSwgVykKCiAgICBhbmNob3JfdyA9IFtdCiAgICBhbmNob3JfaCA9IFtdCiAgICBmb3IgaSBpbiByYW5nZShudW1fYW5jaG9ycyk6CiAgICAgICAgYW5jaG9yX3cuYXBwZW5kKGFuY2hvcnNbaSAqIDJdKQogICAgICAgIGFuY2hvcl9oLmFwcGVuZChhbmNob3JzW2kgKiAyICsgMV0pCgogICAgZGV2aWNlID0gTm9uZQogICAgY3VkYV9jaGVjayA9IG91dHB1dC5pc19jdWRhCiAgICBpZiBjdWRhX2NoZWNrOgogICAgICAgIGRldmljZSA9IG91dHB1dC5nZXRfZGV2aWNlKCkKCiAgICBieF9saXN0ID0gW10KICAgIGJ5X2xpc3QgPSBbXQogICAgYndfbGlzdCA9IFtdCiAgICBiaF9saXN0ID0gW10KCiAgICAjIEFwcGx5IEMteCwgQy15LCBQLXcsIFAtaAogICAgZm9yIGkgaW4gcmFuZ2UobnVtX2FuY2hvcnMpOgogICAgICAgIGlpID0gaSAqIDIKICAgICAgICAjIFNoYXBlOiBbYmF0Y2gsIDEsIEgsIFddCiAgICAgICAgYnggPSBieHlbOiwgaWkgOiBpaSArIDFdICsgdG9yY2gudGVuc29yKGdyaWRfeCwgZGV2aWNlPWRldmljZSwgZHR5cGU9dG9yY2guZmxvYXQzMikgIyBncmlkX3gudG8oZGV2aWNlPWRldmljZSwgZHR5cGU9dG9yY2guZmxvYXQzMikKICAgICAgICAjIFNoYXBlOiBbYmF0Y2gsIDEsIEgsIFddCiAgICAgICAgYnkgPSBieHlbOiwgaWkgKyAxIDogaWkgKyAyXSArIHRvcmNoLnRlbnNvcihncmlkX3ksIGRldmljZT1kZXZpY2UsIGR0eXBlPXRvcmNoLmZsb2F0MzIpICMgZ3JpZF95LnRvKGRldmljZT1kZXZpY2UsIGR0eXBlPXRvcmNoLmZsb2F0MzIpCiAgICAgICAgIyBTaGFwZTogW2JhdGNoLCAxLCBILCBXXQogICAgICAgIGJ3ID0gYndoWzosIGlpIDogaWkgKyAxXSAqIGFuY2hvcl93W2ldCiAgICAgICAgIyBTaGFwZTogW2JhdGNoLCAxLCBILCBXXQogICAgICAgIGJoID0gYndoWzosIGlpICsgMSA6IGlpICsgMl0gKiBhbmNob3JfaFtpXQoKICAgICAgICBieF9saXN0LmFwcGVuZChieCkKICAgICAgICBieV9saXN0LmFwcGVuZChieSkKICAgICAgICBid19saXN0LmFwcGVuZChidykKICAgICAgICBiaF9saXN0LmFwcGVuZChiaCkKCgogICAgIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgIyAgIEZpZ3VyZSBvdXQgYmJveGVzIGZyb20gc2xpY2VzICAgICAjCiAgICAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMsIEgsIFddCiAgICBieCA9IHRvcmNoLmNhdChieF9saXN0LCBkaW09MSkKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMsIEgsIFddCiAgICBieSA9IHRvcmNoLmNhdChieV9saXN0LCBkaW09MSkKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMsIEgsIFddCiAgICBidyA9IHRvcmNoLmNhdChid19saXN0LCBkaW09MSkKICAgICMgU2hhcGU6IFtiYXRjaCwgbnVtX2FuY2hvcnMsIEgsIFddCiAgICBiaCA9IHRvcmNoLmNhdChiaF9saXN0LCBkaW09MSkKCiAgICAjIFNoYXBlOiBbYmF0Y2gsIDIgKiBudW1fYW5jaG9ycywgSCwgV10KICAgIGJ4X2J3ID0gdG9yY2guY2F0KChieCwgYncpLCBkaW09MSkKICAgICMgU2hhcGU6IFtiYXRjaCwgMiAqIG51bV9hbmNob3JzLCBILCBXXQogICAgYnlfYmggPSB0b3JjaC5jYXQoKGJ5LCBiaCksIGRpbT0xKQoKICAgICMgbm9ybWFsaXplIGNvb3JkaW5hdGVzIHRvIFswLCAxXQogICAgYnhfYncgLz0gb3V0cHV0LnNpemUoMykKICAgIGJ5X2JoIC89IG91dHB1dC5zaXplKDIpCgogICAgIyBTaGFwZTogW2JhdGNoLCBudW1fYW5jaG9ycyAqIEggKiBXLCAxXQogICAgYnggPSBieF9id1s6LCA6bnVtX2FuY2hvcnNdLnZpZXcob3V0cHV0LnNpemUoMCksIG51bV9hbmNob3JzICogb3V0cHV0LnNpemUoMikgKiBvdXRwdXQuc2l6ZSgzKSwgMSkKICAgIGJ5ID0gYnlfYmhbOiwgOm51bV9hbmNob3JzXS52aWV3KG91dHB1dC5zaXplKDApLCBudW1fYW5jaG9ycyAqIG91dHB1dC5zaXplKDIpICogb3V0cHV0LnNpemUoMyksIDEpCiAgICBidyA9IGJ4X2J3WzosIG51bV9hbmNob3JzOl0udmlldyhvdXRwdXQuc2l6ZSgwKSwgbnVtX2FuY2hvcnMgKiBvdXRwdXQuc2l6ZSgyKSAqIG91dHB1dC5zaXplKDMpLCAxKQogICAgYmggPSBieV9iaFs6LCBudW1fYW5jaG9yczpdLnZpZXcob3V0cHV0LnNpemUoMCksIG51bV9hbmNob3JzICogb3V0cHV0LnNpemUoMikgKiBvdXRwdXQuc2l6ZSgzKSwgMSkKCiAgICBieDEgPSBieCAtIGJ3ICogMC41CiAgICBieTEgPSBieSAtIGJoICogMC41CiAgICBieDIgPSBieDEgKyBidwogICAgYnkyID0gYnkxICsgYmgKCiAgICAjIFNoYXBlOiBbYmF0Y2gsIG51bV9hbmNob3JzICogaCAqIHcsIDRdIC0+IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBoICogdywgMSwgNF0KICAgIGJveGVzID0gdG9yY2guY2F0KChieDEsIGJ5MSwgYngyLCBieTIpLCBkaW09MikudmlldyhvdXRwdXQuc2l6ZSgwKSwgbnVtX2FuY2hvcnMgKiBvdXRwdXQuc2l6ZSgyKSAqIG91dHB1dC5zaXplKDMpLCAxLCA0KQogICAgIyBib3hlcyA9IGJveGVzLnJlcGVhdCgxLCAxLCBudW1fY2xhc3NlcywgMSkKCiAgICAjIGJveGVzOiAgICAgW2JhdGNoLCBudW1fYW5jaG9ycyAqIEggKiBXLCAxLCA0XQogICAgIyBjbHNfY29uZnM6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBIICogVywgbnVtX2NsYXNzZXNdCiAgICAjIGRldF9jb25mczogW2JhdGNoLCBudW1fYW5jaG9ycyAqIEggKiBXXQoKICAgIGRldF9jb25mcyA9IGRldF9jb25mcy52aWV3KG91dHB1dC5zaXplKDApLCBudW1fYW5jaG9ycyAqIG91dHB1dC5zaXplKDIpICogb3V0cHV0LnNpemUoMyksIDEpCiAgICBjb25mcyA9IGNsc19jb25mcyAqIGRldF9jb25mcwoKICAgICMgYm94ZXM6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBIICogVywgMSwgNF0KICAgICMgY29uZnM6IFtiYXRjaCwgbnVtX2FuY2hvcnMgKiBIICogVywgbnVtX2NsYXNzZXNdCgogICAgcmV0dXJuICBib3hlcywgY29uZnMKCmNsYXNzIFlvbG9MYXllcihubi5Nb2R1bGUpOgogICAgJycnIFlvbG8gbGF5ZXIKICAgIG1vZGVsX291dDogd2hpbGUgaW5mZXJlbmNlLGlzIHBvc3QtcHJvY2Vzc2luZyBpbnNpZGUgb3Igb3V0c2lkZSB0aGUgbW9kZWwKICAgICAgICB0cnVlOm91dHNpZGUKICAgICcnJwogICAgZGVmIF9faW5pdF9fKHNlbGYsIGFuY2hvcl9tYXNrPVtdLCBudW1fY2xhc3Nlcz0wLCBhbmNob3JzPVtdLCBudW1fYW5jaG9ycz0xLCBzdHJpZGU9MzIsIG1vZGVsX291dD1GYWxzZSk6CiAgICAgICAgc3VwZXIoWW9sb0xheWVyLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5hbmNob3JfbWFzayA9IGFuY2hvcl9tYXNrCiAgICAgICAgc2VsZi5udW1fY2xhc3NlcyA9IG51bV9jbGFzc2VzCiAgICAgICAgc2VsZi5hbmNob3JzID0gYW5jaG9ycwogICAgICAgIHNlbGYubnVtX2FuY2hvcnMgPSBudW1fYW5jaG9ycwogICAgICAgIHNlbGYuYW5jaG9yX3N0ZXAgPSBsZW4oYW5jaG9ycykgLy8gbnVtX2FuY2hvcnMKICAgICAgICBzZWxmLmNvb3JkX3NjYWxlID0gMQogICAgICAgIHNlbGYubm9vYmplY3Rfc2NhbGUgPSAxCiAgICAgICAgc2VsZi5vYmplY3Rfc2NhbGUgPSA1CiAgICAgICAgc2VsZi5jbGFzc19zY2FsZSA9IDEKICAgICAgICBzZWxmLnRocmVzaCA9IDAuNgogICAgICAgIHNlbGYuc3RyaWRlID0gc3RyaWRlCiAgICAgICAgc2VsZi5zZWVuID0gMAogICAgICAgIHNlbGYuc2NhbGVfeF95ID0gMQoKICAgICAgICBzZWxmLm1vZGVsX291dCA9IG1vZGVsX291dAoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIG91dHB1dCwgdGFyZ2V0PU5vbmUpOgogICAgICAgIGlmIHNlbGYudHJhaW5pbmc6CiAgICAgICAgICAgIHJldHVybiBvdXRwdXQKICAgICAgICBtYXNrZWRfYW5jaG9ycyA9IFtdCiAgICAgICAgZm9yIG0gaW4gc2VsZi5hbmNob3JfbWFzazoKICAgICAgICAgICAgbWFza2VkX2FuY2hvcnMgKz0gc2VsZi5hbmNob3JzW20gKiBzZWxmLmFuY2hvcl9zdGVwOihtICsgMSkgKiBzZWxmLmFuY2hvcl9zdGVwXQogICAgICAgIG1hc2tlZF9hbmNob3JzID0gW2FuY2hvciAvIHNlbGYuc3RyaWRlIGZvciBhbmNob3IgaW4gbWFza2VkX2FuY2hvcnNdCgogICAgICAgIHJldHVybiB5b2xvX2ZvcndhcmRfZHluYW1pYyhvdXRwdXQsIHNlbGYudGhyZXNoLCBzZWxmLm51bV9jbGFzc2VzLCBtYXNrZWRfYW5jaG9ycywgbGVuKHNlbGYuYW5jaG9yX21hc2spLHNjYWxlX3hfeT1zZWxmLnNjYWxlX3hfeSkK')
    file.write(darknet2pytorch_string)